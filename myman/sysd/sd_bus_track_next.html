<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>sd_bus_track_add_name</title><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><style>
    a.headerlink {
      color: #c60f0f;
      font-size: 0.8em;
      padding: 0 4px 0 4px;
      text-decoration: none;
      visibility: hidden;
    }

    a.headerlink:hover {
      background-color: #c60f0f;
      color: white;
    }

    h1:hover > a.headerlink, h2:hover > a.headerlink, h3:hover > a.headerlink, dt:hover > a.headerlink {
      visibility: visible;
    }
  </style><a href="index.html">Index </a>·
  <a href="systemd.directives.html">Directives </a><span style="float:right">systemd 249</span><hr><div class="refentry"><a name="sd_bus_track_add_name"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>sd_bus_track_add_name, sd_bus_track_add_sender, sd_bus_track_remove_name, sd_bus_track_remove_sender, sd_bus_track_count, sd_bus_track_count_sender, sd_bus_track_count_name, sd_bus_track_contains, sd_bus_track_first, sd_bus_track_next — Add, remove and retrieve bus peers tracked in a bus peer tracking object</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="funcsynopsis"><pre class="funcsynopsisinfo">#include &lt;systemd/sd-bus.h&gt;</pre><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">sd_bus_track_add_name</b>(</code></td><td>sd_bus_track* <var class="pdparam">t</var>, </td></tr><tr><td> </td><td>const char* <var class="pdparam">name</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer"> </div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">sd_bus_track_add_sender</b>(</code></td><td>sd_bus_track* <var class="pdparam">t</var>, </td></tr><tr><td> </td><td>sd_bus_message* <var class="pdparam">message</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer"> </div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">sd_bus_track_remove_name</b>(</code></td><td>sd_bus_track* <var class="pdparam">t</var>, </td></tr><tr><td> </td><td>const char* <var class="pdparam">name</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer"> </div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">sd_bus_track_remove_sender</b>(</code></td><td>sd_bus_track* <var class="pdparam">t</var>, </td></tr><tr><td> </td><td>sd_bus_message* <var class="pdparam">message</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer"> </div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">unsigned <b class="fsfunc">sd_bus_track_count</b>(</code></td><td>sd_bus_track* <var class="pdparam">t</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer"> </div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">sd_bus_track_count_name</b>(</code></td><td>sd_bus_track* <var class="pdparam">t</var>, </td></tr><tr><td> </td><td>const char* <var class="pdparam">name</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer"> </div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">sd_bus_track_count_sender</b>(</code></td><td>sd_bus_track* <var class="pdparam">t</var>, </td></tr><tr><td> </td><td>sd_bus_message* <var class="pdparam">message</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer"> </div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">int <b class="fsfunc">sd_bus_track_contains</b>(</code></td><td>sd_bus_track* <var class="pdparam">t</var>, </td></tr><tr><td> </td><td>const char* <var class="pdparam">name</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer"> </div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">const char* <b class="fsfunc">sd_bus_track_first</b>(</code></td><td>sd_bus_track* <var class="pdparam">t</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer"> </div><table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;"><tr><td><code class="funcdef">const char* <b class="fsfunc">sd_bus_track_next</b>(</code></td><td>sd_bus_track* <var class="pdparam">t</var><code>)</code>;</td></tr></table><div class="funcprototype-spacer"> </div></div></div><div class="refsect1"><a name="id-1.5"></a><h2 id="Description">Description<a class="headerlink" title="Permalink to this headline" href="sd_bus_track_next.html#Description">¶</a></h2><p><code class="function">sd_bus_track_add_name()</code> adds a peer to track to a bus peer tracking object. The first
    argument should refer to a bus peer tracking object created with
    <a href="sd_bus_track_new.html#"><span class="citerefentry"><span class="refentrytitle">sd_bus_track_new</span>(3)</span></a>, the second
    name should refer to a D-Bus peer name to track, either in unique or well-known service format. If the name is not
    tracked yet it will be added to the list of names to track. If it already is being tracked and non-recursive mode
    is enabled, no operation is executed by this call. If recursive mode is enabled a per-name counter is increased by
    one each time this call is invoked, and <code class="function">sd_bus_track_remove_name()</code> has to be called as many
    times as <code class="function">sd_bus_track_add_name()</code> was invoked before in order to stop tracking of the name. Use
    <a href="sd_bus_track_set_recursive.html#"><span class="citerefentry"><span class="refentrytitle">sd_bus_track_set_recursive</span>(3)</span></a> to
    switch from the default non-recursive mode to recursive mode, or back. Note that the specified name is tracked as
    it is, well-known names are not resolved to unique names by this call. Note that multiple bus peer tracking objects
    may track the same name.</p><p><code class="function">sd_bus_track_remove_name()</code> undoes the effect of
    <code class="function">sd_bus_track_add_name()</code> and removes a bus peer name from the list of peers to watch. Depending
    on whether non-recursive or recursive mode is enabled for the bus peer tracking object this call will either remove
    the name fully from the tracking object, or will simply decrement the per-name counter by one, removing the name
    only when the counter reaches zero (see above). Note that a bus peer disconnecting from the bus will implicitly
    remove its names fully from the bus peer tracking object, regardless of the current per-name counter.</p><p><code class="function">sd_bus_track_add_sender()</code> and <code class="function">sd_bus_track_remove_sender()</code> are
    similar to <code class="function">sd_bus_track_add_name()</code> and <code class="function">sd_bus_track_remove_name()</code> but
    take a bus message as argument. The sender of this bus message is determined and added to/removed from the bus peer
    tracking object. As messages always originate from unique names, and never from well-known names this means that
    this call will effectively only add unique names to the bus peer tracking object.</p><p><code class="function">sd_bus_track_count()</code> returns the number of names currently being tracked by the
    specified bus peer tracking object. Note that this function always returns the actual number of names tracked, and
    hence if <code class="function">sd_bus_track_add_name()</code> has been invoked multiple times for the same name it is only
    counted as one, regardless if recursive mode is used or not.</p><p><code class="function">sd_bus_track_count_name()</code> returns the current per-name counter for the specified
    name. If non-recursive mode is used this returns either 1 or 0, depending on whether the specified name has been
    added to the tracking object before, or not. If recursive mode has been enabled, values larger than 1 may be
    returned too, in case <code class="function">sd_bus_track_add_name()</code> has been called multiple times for the same
    name.</p><p><code class="function">sd_bus_track_count_sender()</code> is similar to
    <code class="function">sd_bus_track_count_name()</code>, but takes a bus message object and returns the per-name counter
    matching the sender of the message.</p><p><code class="function">sd_bus_track_contains()</code> may be used to determine whether the specified name has been
    added at least once to the specified bus peer tracking object.</p><p><code class="function">sd_bus_track_first()</code> and <code class="function">sd_bus_track_next()</code> may be used to
    enumerate all names currently being tracked by the passed bus peer tracking
    object. <code class="function">sd_bus_track_first()</code> returns the first entry in the object, and resets an internally
    maintained read index. Each subsequent invocation of <code class="function">sd_bus_track_next()</code> returns the next name
    contained in the bus object. If the end is reached <code class="constant">NULL</code> is returned. If no names have been
    added to the object yet <code class="function">sd_bus_track_first()</code> will return <code class="constant">NULL</code>
    immediately. The order in which names are returned is undefined; in particular which name is considered the first
    returned is not defined. If recursive mode is enabled and the same name has been added multiple times to the bus
    peer tracking object it is only returned once by this enumeration. If new names are added to or existing names
    removed from the bus peer tracking object while it is being enumerated the enumeration ends on the next invocation
    of <code class="function">sd_bus_track_next()</code> as <code class="constant">NULL</code> is returned.</p></div><div class="refsect1"><a name="id-1.6"></a><h2 id="Return Value">Return Value<a class="headerlink" title="Permalink to this headline" href="sd_bus_track_next.html#Return%20Value">¶</a></h2><p>On success, <code class="function">sd_bus_track_add_name()</code> and <code class="function">sd_bus_track_add_sender()</code>
    return 0 if the specified name has already been added to the bus peer tracking object before and positive if it
    hasn't. On failure, they return a negative errno-style error code.</p><p><code class="function">sd_bus_track_remove_name()</code> and <code class="function">sd_bus_track_remove_sender()</code> return
    positive if the specified name was previously tracked by the bus peer tracking object and has now been removed. In
    non-recursive mode, 0 is returned if the specified name was not being tracked yet. In recursive mode
    <code class="constant">-EUNATCH</code> is returned in this case. On failure, they return a negative errno-style error
    code.</p><p><code class="function">sd_bus_track_count()</code> returns the number of names currently being tracked, or 0 on
    failure.</p><p><code class="function">sd_bus_track_count_name()</code> and <code class="function">sd_bus_track_count_sender()</code> return
    the current per-name counter for the specified name or the sender of the specified message. Zero is returned for
    names that are not being tracked yet, a positive value for names added at least once. Larger values than 1 are only
    returned in recursive mode. On failure, a negative errno-style error code is returned.</p><p><code class="function">sd_bus_track_contains()</code> returns the passed name if it exists in the bus peer tracking
    object. On failure, and if the name has not been added yet <code class="constant">NULL</code> is returned.</p><p><code class="function">sd_bus_track_first()</code> and <code class="function">sd_bus_track_next()</code> return the first/next
    name contained in the bus peer tracking object, and <code class="constant">NULL</code> if the end of the enumeration is
    reached and on error.</p><div class="refsect2"><a name="id-1.6.8"></a><h3 id="Errors">Errors<a class="headerlink" title="Permalink to this headline" href="sd_bus_track_next.html#Errors">¶</a></h3><p>Returned errors may indicate the following problems:</p><div class="variablelist"><dl class="variablelist"><dt id="-EUNATCH"><span class="term"><code class="constant">-EUNATCH</code></span><a class="headerlink" title="Permalink to this term" href="sd_bus_track_next.html#-EUNATCH">¶</a></dt><dd><p><code class="function">sd_bus_track_remove_name()</code> or
          <code class="function">sd_bus_track_remove_sender()</code> have been invoked for a name not previously added
          to the bus peer object.</p></dd><dt id="-EINVAL"><span class="term"><code class="constant">-EINVAL</code></span><a class="headerlink" title="Permalink to this term" href="sd_bus_track_next.html#-EINVAL">¶</a></dt><dd><p>Specified parameter is invalid.</p></dd><dt id="-ENOMEM"><span class="term"><code class="constant">-ENOMEM</code></span><a class="headerlink" title="Permalink to this term" href="sd_bus_track_next.html#-ENOMEM">¶</a></dt><dd><p>Memory allocation failed.</p></dd></dl></div></div></div><div class="refsect1"><a name="id-1.7"></a><h2 id="Notes">Notes<a class="headerlink" title="Permalink to this headline" href="sd_bus_track_next.html#Notes">¶</a></h2><p><a name="pkgconfig-text"></a>These APIs are implemented as a shared
  library, which can be compiled and linked to with the
  <code class="constant">libsystemd</code> <a href="http://linux.die.net/man/1/pkg-config"><span class="citerefentry"><span class="refentrytitle">pkg-config</span>(1)</span></a>
  file.</p></div><div class="refsect1"><a name="id-1.8"></a><h2 id="See Also">See Also<a class="headerlink" title="Permalink to this headline" href="sd_bus_track_next.html#See%20Also">¶</a></h2><p>
      <a href="systemd.html#"><span class="citerefentry"><span class="refentrytitle">systemd</span>(1)</span></a>,
      <a href="sd-bus.html#"><span class="citerefentry"><span class="refentrytitle">sd-bus</span>(3)</span></a>,
      <a href="sd_bus_track_new.html#"><span class="citerefentry"><span class="refentrytitle">sd_bus_track_new</span>(3)</span></a>
    </p></div></div></body></html>
