<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>systemd-nspawn</title><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><style>
    a.headerlink {
      color: #c60f0f;
      font-size: 0.8em;
      padding: 0 4px 0 4px;
      text-decoration: none;
      visibility: hidden;
    }

    a.headerlink:hover {
      background-color: #c60f0f;
      color: white;
    }

    h1:hover > a.headerlink, h2:hover > a.headerlink, h3:hover > a.headerlink, dt:hover > a.headerlink {
      visibility: visible;
    }
  </style><a href="index.html">Index </a>·
  <a href="systemd.directives.html">Directives </a><span style="float:right">systemd 249</span><hr><div class="refentry"><a name="systemd-nspawn"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>systemd-nspawn — Spawn a command or OS in a light-weight container</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><code class="command">systemd-nspawn</code>  [OPTIONS...] [<em class="replaceable"><code>COMMAND</code></em>
       [ARGS...]
      ]</p></div><div class="cmdsynopsis"><p><code class="command">systemd-nspawn</code>   --boot  [OPTIONS...] [ARGS...]</p></div></div><div class="refsect1"><a name="id-1.5"></a><h2 id="Description">Description<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#Description">¶</a></h2><p><span class="command"><strong>systemd-nspawn</strong></span> may be used to run a command or OS in a light-weight namespace
    container. In many ways it is similar to <a href="http://man7.org/linux/man-pages/man1/chroot.1.html"><span class="citerefentry"><span class="refentrytitle">chroot</span>(1)</span></a>, but more powerful
    since it fully virtualizes the file system hierarchy, as well as the process tree, the various IPC subsystems and
    the host and domain name.</p><p><span class="command"><strong>systemd-nspawn</strong></span> may be invoked on any directory tree containing an operating system tree,
    using the <code class="option">--directory=</code> command line option. By using the <code class="option">--machine=</code> option an OS
    tree is automatically searched for in a couple of locations, most importantly in
    <code class="filename">/var/lib/machines/</code>, the suggested directory to place OS container images installed on the
    system.</p><p>In contrast to <a href="http://man7.org/linux/man-pages/man1/chroot.1.html"><span class="citerefentry"><span class="refentrytitle">chroot</span>(1)</span></a> <span class="command"><strong>systemd-nspawn</strong></span>
    may be used to boot full Linux-based operating systems in a container.</p><p><span class="command"><strong>systemd-nspawn</strong></span> limits access to various kernel interfaces in the container to read-only,
    such as <code class="filename">/sys/</code>, <code class="filename">/proc/sys/</code> or <code class="filename">/sys/fs/selinux/</code>. The
    host's network interfaces and the system clock may not be changed from within the container. Device nodes may not
    be created. The host system cannot be rebooted and kernel modules may not be loaded from within the
    container.</p><p>Use a tool like <a href="https://www.mankier.com/8/dnf"><span class="citerefentry"><span class="refentrytitle">dnf</span>(8)</span></a>, <a href="http://linux.die.net/man/8/debootstrap"><span class="citerefentry"><span class="refentrytitle">debootstrap</span>(8)</span></a>, or
    <a href="https://www.archlinux.org/pacman/pacman.8.html"><span class="citerefentry"><span class="refentrytitle">pacman</span>(8)</span></a> to
    set up an OS directory tree suitable as file system hierarchy for <span class="command"><strong>systemd-nspawn</strong></span> containers. See
    the Examples section below for details on suitable invocation of these commands.</p><p>As a safety check <span class="command"><strong>systemd-nspawn</strong></span> will verify the existence of
    <code class="filename">/usr/lib/os-release</code> or <code class="filename">/etc/os-release</code> in the container tree before
    starting the container (see
    <a href="os-release.html#"><span class="citerefentry"><span class="refentrytitle">os-release</span>(5)</span></a>).  It might be
    necessary to add this file to the container tree manually if the OS of the container is too old to contain this
    file out-of-the-box.</p><p><span class="command"><strong>systemd-nspawn</strong></span> may be invoked directly from the interactive command line or run as system
    service in the background. In this mode each container instance runs as its own service instance; a default
    template unit file <code class="filename">systemd-nspawn@.service</code> is provided to make this easy, taking the container
    name as instance identifier. Note that different default options apply when <span class="command"><strong>systemd-nspawn</strong></span> is
    invoked by the template unit file than interactively on the command line. Most importantly the template unit file
    makes use of the <code class="option">--boot</code> which is not the default in case <span class="command"><strong>systemd-nspawn</strong></span> is
    invoked from the interactive command line. Further differences with the defaults are documented along with the
    various supported options below.</p><p>The <a href="machinectl.html#"><span class="citerefentry"><span class="refentrytitle">machinectl</span>(1)</span></a> tool may
    be used to execute a number of operations on containers. In particular it provides easy-to-use commands to run
    containers as system services using the <code class="filename">systemd-nspawn@.service</code> template unit
    file.</p><p>Along with each container a settings file with the <code class="filename">.nspawn</code> suffix may exist, containing
    additional settings to apply when running the container. See
    <a href="systemd.nspawn.html#"><span class="citerefentry"><span class="refentrytitle">systemd.nspawn</span>(5)</span></a> for
    details. Settings files override the default options used by the <code class="filename">systemd-nspawn@.service</code>
    template unit file, making it usually unnecessary to alter this template file directly.</p><p>Note that <span class="command"><strong>systemd-nspawn</strong></span> will mount file systems private to the container to
    <code class="filename">/dev/</code>, <code class="filename">/run/</code> and similar. These will not be visible outside of the
    container, and their contents will be lost when the container exits.</p><p>Note that running two <span class="command"><strong>systemd-nspawn</strong></span> containers from the same directory tree will not make
    processes in them see each other. The PID namespace separation of the two containers is complete and the containers
    will share very few runtime objects except for the underlying file system. Use
    <a href="machinectl.html#"><span class="citerefentry"><span class="refentrytitle">machinectl</span>(1)</span></a>'s
    <span class="command"><strong>login</strong></span> or <span class="command"><strong>shell</strong></span> commands to request an additional login session in a running
    container.</p><p><span class="command"><strong>systemd-nspawn</strong></span> implements the <a class="ulink" href="https://systemd.io/CONTAINER_INTERFACE" target="_top">Container Interface</a> specification.</p><p>While running, containers invoked with <span class="command"><strong>systemd-nspawn</strong></span> are registered with the
    <a href="systemd-machined.html#"><span class="citerefentry"><span class="refentrytitle">systemd-machined</span>(8)</span></a> service that
    keeps track of running containers, and provides programming interfaces to interact with them.</p></div><div class="refsect1"><a name="id-1.6"></a><h2 id="Options">Options<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#Options">¶</a></h2><p>If option <code class="option">-b</code> is specified, the arguments
    are used as arguments for the init program. Otherwise,
    <em class="replaceable"><code>COMMAND</code></em> specifies the program to launch
    in the container, and the remaining arguments are used as
    arguments for this program. If <code class="option">--boot</code> is not used and
    no arguments are specified, a shell is launched in the
    container.</p><p>The following options are understood:</p><div class="variablelist"><dl class="variablelist"><dt id="-q"><span class="term"><code class="option">-q</code>, </span><span class="term"><code class="option">--quiet</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#-q">¶</a></dt><dd><p>Turns off any status output by the tool
        itself. When this switch is used, the only output from nspawn
        will be the console output of the container OS
        itself.</p></dd><dt id="--settings=MODE"><span class="term"><code class="option">--settings=</code><em class="replaceable"><code>MODE</code></em></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--settings=MODE">¶</a></dt><dd><p>Controls whether
        <span class="command"><strong>systemd-nspawn</strong></span> shall search for and use
        additional per-container settings from
        <code class="filename">.nspawn</code> files. Takes a boolean or the
        special values <code class="option">override</code> or
        <code class="option">trusted</code>.</p><p>If enabled (the default), a settings file named after the
        machine (as specified with the <code class="option">--machine=</code>
        setting, or derived from the directory or image file name)
        with the suffix <code class="filename">.nspawn</code> is searched in
        <code class="filename">/etc/systemd/nspawn/</code> and
        <code class="filename">/run/systemd/nspawn/</code>. If it is found
        there, its settings are read and used. If it is not found
        there, it is subsequently searched in the same directory as the
        image file or in the immediate parent of the root directory of
        the container. In this case, if the file is found, its settings
        will be also read and used, but potentially unsafe settings
        are ignored. Note that in both these cases, settings on the
        command line take precedence over the corresponding settings
        from loaded <code class="filename">.nspawn</code> files, if both are
        specified. Unsafe settings are considered all settings that
        elevate the container's privileges or grant access to
        additional resources such as files or directories of the
        host. For details about the format and contents of
        <code class="filename">.nspawn</code> files, consult
        <a href="systemd.nspawn.html#"><span class="citerefentry"><span class="refentrytitle">systemd.nspawn</span>(5)</span></a>.</p><p>If this option is set to <code class="option">override</code>, the
        file is searched, read and used the same way, however, the order of
        precedence is reversed: settings read from the
        <code class="filename">.nspawn</code> file will take precedence over
        the corresponding command line options, if both are
        specified.</p><p>If this option is set to <code class="option">trusted</code>, the
        file is searched, read and used the same way, but regardless
        of being found in <code class="filename">/etc/systemd/nspawn/</code>,
        <code class="filename">/run/systemd/nspawn/</code> or next to the image
        file or container root directory, all settings will take
        effect, however, command line arguments still take precedence
        over corresponding settings.</p><p>If disabled, no <code class="filename">.nspawn</code> file is read
        and no settings except the ones on the command line are in
        effect.</p></dd></dl></div><div class="refsect2"><a name="id-1.6.5"></a><h3 id="Image Options">Image Options<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#Image%20Options">¶</a></h3><div class="variablelist"><dl class="variablelist"><dt id="-D"><span class="term"><code class="option">-D</code>, </span><span class="term"><code class="option">--directory=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#-D">¶</a></dt><dd><p>Directory to use as file system root for the
        container.</p><p>If neither <code class="option">--directory=</code>, nor
        <code class="option">--image=</code> is specified the directory is
        determined by searching for a directory named the same as the
        machine name specified with <code class="option">--machine=</code>. See
        <a href="machinectl.html#"><span class="citerefentry"><span class="refentrytitle">machinectl</span>(1)</span></a>
        section "Files and Directories" for the precise search path.</p><p>If neither <code class="option">--directory=</code>,
        <code class="option">--image=</code>, nor <code class="option">--machine=</code>
        are specified, the current directory will
        be used. May not be specified together with
        <code class="option">--image=</code>.</p></dd><dt id="--template="><span class="term"><code class="option">--template=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--template=">¶</a></dt><dd><p>Directory or "<code class="literal">btrfs</code>" subvolume to use as template for the
        container's root directory. If this is specified and the container's root directory (as configured by
        <code class="option">--directory=</code>) does not yet exist it is created as "<code class="literal">btrfs</code>" snapshot
        (if supported) or plain directory (otherwise) and populated from this template tree. Ideally, the
        specified template path refers to the root of a "<code class="literal">btrfs</code>" subvolume, in which case a
        simple copy-on-write snapshot is taken, and populating the root directory is instant. If the
        specified template path does not refer to the root of a "<code class="literal">btrfs</code>" subvolume (or not
        even to a "<code class="literal">btrfs</code>" file system at all), the tree is copied (though possibly in a
        'reflink' copy-on-write scheme — if the file system supports that), which can be substantially more
        time-consuming. Note that the snapshot taken is of the specified directory or subvolume, including
        all subdirectories and subvolumes below it, but excluding any sub-mounts. May not be specified
        together with <code class="option">--image=</code> or <code class="option">--ephemeral</code>.</p><p>Note that this switch leaves hostname, machine ID and
        all other settings that could identify the instance
        unmodified.</p></dd><dt id="-x"><span class="term"><code class="option">-x</code>, </span><span class="term"><code class="option">--ephemeral</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#-x">¶</a></dt><dd><p>If specified, the container is run with a temporary snapshot of its file system that is removed
        immediately when the container terminates. May not be specified together with
        <code class="option">--template=</code>.</p><p>Note that this switch leaves hostname, machine ID and all other settings that could identify
        the instance unmodified. Please note that — as with <code class="option">--template=</code> — taking the
        temporary snapshot is more efficient on file systems that support subvolume snapshots or 'reflinks'
        natively ("<code class="literal">btrfs</code>" or new "<code class="literal">xfs</code>") than on more traditional file
        systems that do not ("<code class="literal">ext4</code>"). Note that the snapshot taken is of the specified
        directory or subvolume, including all subdirectories and subvolumes below it, but excluding any
        sub-mounts.</p><p>With this option no modifications of the container image are retained. Use
        <code class="option">--volatile=</code> (described below) for other mechanisms to restrict persistency of
        container images during runtime.</p></dd><dt id="-i"><span class="term"><code class="option">-i</code>, </span><span class="term"><code class="option">--image=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#-i">¶</a></dt><dd><p>Disk image to mount the root directory for the
        container from. Takes a path to a regular file or to a block
        device node. The file or block device must contain
        either:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>An MBR partition table with a single
          partition of type 0x83 that is marked
          bootable.</p></li><li class="listitem"><p>A GUID partition table (GPT) with a single
          partition of type
          0fc63daf-8483-4772-8e79-3d69d8477de4.</p></li><li class="listitem"><p>A GUID partition table (GPT) with a marked
          root partition which is mounted as the root directory of the
          container. Optionally, GPT images may contain a home and/or
          a server data partition which are mounted to the appropriate
          places in the container. All these partitions must be
          identified by the partition types defined by the <a class="ulink" href="https://systemd.io/DISCOVERABLE_PARTITIONS" target="_top">Discoverable
          Partitions Specification</a>.</p></li><li class="listitem"><p>No partition table, and a single file system spanning the whole image.</p></li></ul></div><p>On GPT images, if an EFI System Partition (ESP) is discovered, it is automatically mounted to
        <code class="filename">/efi</code> (or <code class="filename">/boot</code> as fallback) in case a directory by this name exists
        and is empty.</p><p>Partitions encrypted with LUKS are automatically decrypted. Also, on GPT images dm-verity data integrity
        hash partitions are set up if the root hash for them is specified using the <code class="option">--root-hash=</code>
        option.</p><p>Single file system images (i.e. file systems without a surrounding partition table) can be opened using
        dm-verity if the integrity data is passed using the <code class="option">--root-hash=</code> and
        <code class="option">--verity-data=</code> (and optionally <code class="option">--root-hash-sig=</code>) options.</p><p>Any other partitions, such as foreign partitions or swap partitions are not mounted. May not be specified
        together with <code class="option">--directory=</code>, <code class="option">--template=</code>.</p></dd><dt id="--oci-bundle="><span class="term"><code class="option">--oci-bundle=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--oci-bundle=">¶</a></dt><dd><p>Takes the path to an OCI runtime bundle to invoke, as specified in the <a class="ulink" href="https://github.com/opencontainers/runtime-spec/blob/master/spec.md" target="_top">OCI Runtime Specification</a>. In
        this case no <code class="filename">.nspawn</code> file is loaded, and the root directory and various settings are read
        from the OCI runtime JSON data (but data passed on the command line takes precedence).</p></dd><dt id="--read-only"><span class="term"><code class="option">--read-only</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--read-only">¶</a></dt><dd><p>Mount the container's root file system (and any other file systems container in the container
        image) read-only. This has no effect on additional mounts made with <code class="option">--bind=</code>,
        <code class="option">--tmpfs=</code> and similar options. This mode is implied if the container image file or directory is
        marked read-only itself. It is also implied if <code class="option">--volatile=</code> is used. In this case the container
        image on disk is strictly read-only, while changes are permitted but kept non-persistently in memory only. For
        further details, see below.</p></dd><dt id="--volatile"><span class="term"><code class="option">--volatile</code>, </span><span class="term"><code class="option">--volatile=</code><em class="replaceable"><code>MODE</code></em></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--volatile">¶</a></dt><dd><p>Boots the container in volatile mode. When no mode parameter is passed or when mode is
        specified as <code class="option">yes</code>, full volatile mode is enabled. This means the root directory is mounted as a
        mostly unpopulated "<code class="literal">tmpfs</code>" instance, and <code class="filename">/usr/</code> from the OS tree is
        mounted into it in read-only mode (the system thus starts up with read-only OS image, but pristine state and
        configuration, any changes are lost on shutdown). When the mode parameter is specified as
        <code class="option">state</code>, the OS tree is mounted read-only, but <code class="filename">/var/</code> is mounted as a
        writable "<code class="literal">tmpfs</code>" instance into it (the system thus starts up with read-only OS resources and
        configuration, but pristine state, and any changes to the latter are lost on shutdown). When the mode parameter
        is specified as <code class="option">overlay</code> the read-only root file system is combined with a writable
        <code class="filename">tmpfs</code> instance through "<code class="literal">overlayfs</code>", so that it appears at it normally
        would, but any changes are applied to the temporary file system only and lost when the container is
        terminated. When the mode parameter is specified as <code class="option">no</code> (the default), the whole OS tree is
        made available writable (unless <code class="option">--read-only</code> is specified, see above).</p><p>Note that if one of the volatile modes is chosen, its effect is limited to the root file system
        (or <code class="filename">/var/</code> in case of <code class="option">state</code>), and any other mounts placed in the
        hierarchy are unaffected — regardless if they are established automatically (e.g. the EFI system
        partition that might be mounted to <code class="filename">/efi/</code> or <code class="filename">/boot/</code>) or
        explicitly (e.g. through an additional command line option such as <code class="option">--bind=</code>, see
        below). This means, even if <code class="option">--volatile=overlay</code> is used changes to
        <code class="filename">/efi/</code> or <code class="filename">/boot/</code> are prohibited in case such a partition
        exists in the container image operated on, and even if <code class="option">--volatile=state</code> is used the
        hypothetical file <code class="filename">/etc/foobar</code> is potentially writable if
        <code class="option">--bind=/etc/foobar</code> if used to mount it from outside the read-only container
        <code class="filename">/etc/</code> directory.</p><p>The <code class="option">--ephemeral</code> option is closely related to this setting, and provides similar
        behaviour by making a temporary, ephemeral copy of the whole OS image and executing that. For further details,
        see above.</p><p>The <code class="option">--tmpfs=</code> and <code class="option">--overlay=</code> options provide similar functionality, but
        for specific sub-directories of the OS image only. For details, see below.</p><p>This option provides similar functionality for containers as the "<code class="literal">systemd.volatile=</code>"
        kernel command line switch provides for host systems. See
        <a href="kernel-command-line.html#"><span class="citerefentry"><span class="refentrytitle">kernel-command-line</span>(7)</span></a> for
        details.</p><p>Note that setting this option to <code class="option">yes</code> or <code class="option">state</code> will only work
        correctly with operating systems in the container that can boot up with only
        <code class="filename">/usr/</code> mounted, and are able to automatically populate <code class="filename">/var/</code>
        (and <code class="filename">/etc/</code> in case of "<code class="literal">--volatile=yes</code>"). Specifically, this
        means that operating systems that follow the historic split of <code class="filename">/bin/</code> and
        <code class="filename">/lib/</code> (and related directories) from <code class="filename">/usr/</code> (i.e. where the
        former are not symlinks into the latter) are not supported by "<code class="literal">--volatile=yes</code>" as
        container payload. The <code class="option">overlay</code> option does not require any particular preparations
        in the OS, but do note that "<code class="literal">overlayfs</code>" behaviour differs from regular file systems
        in a number of ways, and hence compatibility is limited.</p></dd><dt id="--root-hash="><span class="term"><code class="option">--root-hash=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--root-hash=">¶</a></dt><dd><p>Takes a data integrity (dm-verity) root hash specified in hexadecimal. This option enables data
        integrity checks using dm-verity, if the used image contains the appropriate integrity data (see above). The
        specified hash must match the root hash of integrity data, and is usually at least 256 bits (and hence 64
        formatted hexadecimal characters) long (in case of SHA256 for example). If this option is not specified, but
        the image file carries the "<code class="literal">user.verity.roothash</code>" extended file attribute (see <a href="http://man7.org/linux/man-pages/man7/xattr.7.html"><span class="citerefentry"><span class="refentrytitle">xattr</span>(7)</span></a>), then the root
        hash is read from it, also as formatted hexadecimal characters. If the extended file attribute is not found (or
        is not supported by the underlying file system), but a file with the <code class="filename">.roothash</code> suffix is
        found next to the image file, bearing otherwise the same name (except if the image has the
        <code class="filename">.raw</code> suffix, in which case the root hash file must not have it in its name), the root hash
        is read from it and automatically used, also as formatted hexadecimal characters.</p><p>Note that this configures the root hash for the root file system. Disk images may also contain
        separate file systems for the <code class="filename">/usr/</code> hierarchy, which may be Verity protected as
        well. The root hash for this protection may be configured via the
        "<code class="literal">user.verity.usrhash</code>" extended file attribute or via a <code class="filename">.usrhash</code>
        file adjacent to the disk image, following the same format and logic as for the root hash for the
        root file system described here. Note that there's currently no switch to configure the root hash for
        the <code class="filename">/usr/</code> from the command line.</p><p>Also see the <code class="varname">RootHash=</code> option in
        <a href="systemd.exec.html#"><span class="citerefentry"><span class="refentrytitle">systemd.exec</span>(5)</span></a>.</p></dd><dt id="--root-hash-sig="><span class="term"><code class="option">--root-hash-sig=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--root-hash-sig=">¶</a></dt><dd><p>Takes a PKCS7 signature of the <code class="option">--root-hash=</code> option.
        The semantics are the same as for the <code class="varname">RootHashSignature=</code> option, see
        <a href="systemd.exec.html#"><span class="citerefentry"><span class="refentrytitle">systemd.exec</span>(5)</span></a>.
        </p></dd><dt id="--verity-data="><span class="term"><code class="option">--verity-data=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--verity-data=">¶</a></dt><dd><p>Takes the path to a data integrity (dm-verity) file. This option enables data integrity checks
        using dm-verity, if a root-hash is passed and if the used image itself does not contains the integrity data.
        The integrity data must be matched by the root hash. If this option is not specified, but a file with the
        <code class="filename">.verity</code> suffix is found next to the image file, bearing otherwise the same name (except if
        the image has the <code class="filename">.raw</code> suffix, in which case the verity data file must not have it in its name),
        the verity data is read from it and automatically used.</p></dd><dt id="--pivot-root="><span class="term"><code class="option">--pivot-root=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--pivot-root=">¶</a></dt><dd><p>Pivot the specified directory to <code class="filename">/</code> inside the container, and either unmount the
        container's old root, or pivot it to another specified directory. Takes one of: a path argument — in which case the
        specified path will be pivoted to <code class="filename">/</code> and the old root will be unmounted; or a colon-separated pair
        of new root path and pivot destination for the old root. The new root path will be pivoted to <code class="filename">/</code>,
        and the old <code class="filename">/</code> will be pivoted to the other directory. Both paths must be absolute, and are resolved
        in the container's file system namespace.</p><p>This is for containers which have several bootable directories in them; for example, several
        <a class="ulink" href="https://ostree.readthedocs.io/en/latest/" target="_top">OSTree</a> deployments. It emulates the behavior of
        the boot loader and initial RAM disk which normally select which directory to mount as the root and start the
        container's PID 1 in.</p></dd></dl></div></div><div class="refsect2"><a name="id-1.6.6"></a><h3 id="Execution Options">Execution Options<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#Execution%20Options">¶</a></h3><div class="variablelist"><dl class="variablelist"><dt id="-a"><span class="term"><code class="option">-a</code>, </span><span class="term"><code class="option">--as-pid2</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#-a">¶</a></dt><dd><p>Invoke the shell or specified program as process ID (PID) 2 instead of PID 1 (init). By
        default, if neither this option nor <code class="option">--boot</code> is used, the selected program is run as the process
        with PID 1, a mode only suitable for programs that are aware of the special semantics that the process with
        PID 1 has on UNIX. For example, it needs to reap all processes reparented to it, and should implement
        <span class="command"><strong>sysvinit</strong></span> compatible signal handling (specifically: it needs to reboot on SIGINT, reexecute
        on SIGTERM, reload configuration on SIGHUP, and so on). With <code class="option">--as-pid2</code> a minimal stub init
        process is run as PID 1 and the selected program is executed as PID 2 (and hence does not need to implement any
        special semantics). The stub init process will reap processes as necessary and react appropriately to
        signals. It is recommended to use this mode to invoke arbitrary commands in containers, unless they have been
        modified to run correctly as PID 1. Or in other words: this switch should be used for pretty much all commands,
        except when the command refers to an init or shell implementation, as these are generally capable of running
        correctly as PID 1. This option may not be combined with <code class="option">--boot</code>.</p></dd><dt id="-b"><span class="term"><code class="option">-b</code>, </span><span class="term"><code class="option">--boot</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#-b">¶</a></dt><dd><p>Automatically search for an init program and invoke it as PID 1, instead of a shell or a user
        supplied program. If this option is used, arguments specified on the command line are used as arguments for the
        init program. This option may not be combined with <code class="option">--as-pid2</code>.</p><p>The following table explains the different modes of invocation and relationship to
        <code class="option">--as-pid2</code> (see above):</p><div class="table"><a name="id-1.6.6.2.2.3.3"></a><p class="title"><b>Table 1. Invocation Mode</b></p><div class="table-contents"><table class="table" summary="Invocation Mode" border="1"><colgroup><col align="left" class="switch"><col align="left" class="explanation"></colgroup><thead><tr><th align="left">Switch</th><th align="left">Explanation</th></tr></thead><tbody><tr><td align="left">Neither <code class="option">--as-pid2</code> nor <code class="option">--boot</code> specified</td><td align="left">The passed parameters are interpreted as the command line, which is executed as PID 1 in the container.</td></tr><tr><td align="left"><code class="option">--as-pid2</code> specified</td><td align="left">The passed parameters are interpreted as the command line, which is executed as PID 2 in the container. A stub init process is run as PID 1.</td></tr><tr><td align="left"><code class="option">--boot</code> specified</td><td align="left">An init program is automatically searched for and run as PID 1 in the container. The passed parameters are used as invocation parameters for this process.</td></tr></tbody></table></div></div><br class="table-break"><p>Note that <code class="option">--boot</code> is the default mode of operation if the
        <code class="filename">systemd-nspawn@.service</code> template unit file is used.</p></dd><dt id="--chdir="><span class="term"><code class="option">--chdir=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--chdir=">¶</a></dt><dd><p>Change to the specified working directory before invoking the process in the container. Expects
        an absolute path in the container's file system namespace.</p></dd><dt id="-E NAME[=VALUE]"><span class="term"><code class="option">-E <em class="replaceable"><code>NAME</code></em>[=<em class="replaceable"><code>VALUE</code></em>]</code>, </span><span class="term"><code class="option">--setenv=<em class="replaceable"><code>NAME</code></em>[=<em class="replaceable"><code>VALUE</code></em>]</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#-E%20NAME%5B=VALUE%5D">¶</a></dt><dd><p>Specifies an environment variable to pass to the init process in the container. This
        may be used to override the default variables or to set additional variables. It may be used more
        than once to set multiple variables. When "<code class="literal">=</code>" and <em class="replaceable"><code>VALUE</code></em>
        are omitted, the value of the variable with the same name in the program environment will be used.
        </p></dd><dt id="-u"><span class="term"><code class="option">-u</code>, </span><span class="term"><code class="option">--user=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#-u">¶</a></dt><dd><p>After transitioning into the container, change to the specified user defined in the
        container's user database. Like all other systemd-nspawn features, this is not a security feature and
        provides protection against accidental destructive operations only.</p></dd><dt id="--kill-signal="><span class="term"><code class="option">--kill-signal=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--kill-signal=">¶</a></dt><dd><p>Specify the process signal to send to the container's PID 1 when nspawn itself receives
        <code class="constant">SIGTERM</code>, in order to trigger an orderly shutdown of the container. Defaults to
        <code class="constant">SIGRTMIN+3</code> if <code class="option">--boot</code> is used (on systemd-compatible init systems
        <code class="constant">SIGRTMIN+3</code> triggers an orderly shutdown). If <code class="option">--boot</code> is not used and this
        option is not specified the container's processes are terminated abruptly via <code class="constant">SIGKILL</code>. For
        a list of valid signals, see <a href="http://man7.org/linux/man-pages/man7/signal.7.html"><span class="citerefentry"><span class="refentrytitle">signal</span>(7)</span></a>.</p></dd><dt id="--notify-ready="><span class="term"><code class="option">--notify-ready=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--notify-ready=">¶</a></dt><dd><p>Configures support for notifications from the container's init process.
        <code class="option">--notify-ready=</code> takes a boolean (<code class="option">no</code> and  <code class="option">yes</code>).
        With option <code class="option">no</code> systemd-nspawn notifies systemd
        with a "<code class="literal">READY=1</code>" message when the init process is created.
        With option <code class="option">yes</code> systemd-nspawn waits for the
        "<code class="literal">READY=1</code>" message from the init process in the container
        before sending its own to systemd. For more details about notifications
        see <a href="sd_notify.html#"><span class="citerefentry"><span class="refentrytitle">sd_notify</span>(3)</span></a>.</p></dd></dl></div></div><div class="refsect2"><a name="id-1.6.7"></a><h3 id="System Identity Options">System Identity Options<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#System%20Identity%20Options">¶</a></h3><div class="variablelist"><dl class="variablelist"><dt id="-M"><span class="term"><code class="option">-M</code>, </span><span class="term"><code class="option">--machine=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#-M">¶</a></dt><dd><p>Sets the machine name for this container. This
        name may be used to identify this container during its runtime
        (for example in tools like
        <a href="machinectl.html#"><span class="citerefentry"><span class="refentrytitle">machinectl</span>(1)</span></a>
        and similar), and is used to initialize the container's
        hostname (which the container can choose to override,
        however). If not specified, the last component of the root
        directory path of the container is used, possibly suffixed
        with a random identifier in case <code class="option">--ephemeral</code>
        mode is selected. If the root directory selected is the host's
        root directory the host's hostname is used as default
        instead.</p></dd><dt id="--hostname="><span class="term"><code class="option">--hostname=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--hostname=">¶</a></dt><dd><p>Controls the hostname to set within the container, if different from the machine name. Expects
        a valid hostname as argument. If this option is used, the kernel hostname of the container will be set to this
        value, otherwise it will be initialized to the machine name as controlled by the <code class="option">--machine=</code>
        option described above. The machine name is used for various aspect of identification of the container from the
        outside, the kernel hostname configurable with this option is useful for the container to identify itself from
        the inside. It is usually a good idea to keep both forms of identification synchronized, in order to avoid
        confusion. It is hence recommended to avoid usage of this option, and use <code class="option">--machine=</code>
        exclusively. Note that regardless whether the container's hostname is initialized from the name set with
        <code class="option">--hostname=</code> or the one set with <code class="option">--machine=</code>, the container can later override
        its kernel hostname freely on its own as well.</p></dd><dt id="--uuid="><span class="term"><code class="option">--uuid=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--uuid=">¶</a></dt><dd><p>Set the specified UUID for the container. The
        init system will initialize
        <code class="filename">/etc/machine-id</code> from this if this file is
        not set yet. Note that this option takes effect only if
        <code class="filename">/etc/machine-id</code> in the container is
        unpopulated.</p></dd></dl></div></div><div class="refsect2"><a name="id-1.6.8"></a><h3 id="Property Options">Property Options<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#Property%20Options">¶</a></h3><div class="variablelist"><dl class="variablelist"><dt id="-S"><span class="term"><code class="option">-S</code>, </span><span class="term"><code class="option">--slice=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#-S">¶</a></dt><dd><p>Make the container part of the specified slice, instead of the default
        <code class="filename">machine.slice</code>. This applies only if the machine is run in its own scope unit, i.e. if
        <code class="option">--keep-unit</code> isn't used.</p></dd><dt id="--property="><span class="term"><code class="option">--property=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--property=">¶</a></dt><dd><p>Set a unit property on the scope unit to register for the machine. This applies only if the
        machine is run in its own scope unit, i.e. if <code class="option">--keep-unit</code> isn't used. Takes unit property
        assignments in the same format as <span class="command"><strong>systemctl set-property</strong></span>. This is useful to set memory
        limits and similar for container.</p></dd><dt id="--register="><span class="term"><code class="option">--register=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--register=">¶</a></dt><dd><p>Controls whether the container is registered with
        <a href="systemd-machined.html#"><span class="citerefentry"><span class="refentrytitle">systemd-machined</span>(8)</span></a>.  Takes a
        boolean argument, which defaults to "<code class="literal">yes</code>".  This option should be enabled when the container
        runs a full Operating System (more specifically: a system and service manager as PID 1), and is useful to
        ensure that the container is accessible via
        <a href="machinectl.html#"><span class="citerefentry"><span class="refentrytitle">machinectl</span>(1)</span></a> and shown by
        tools such as <a href="http://man7.org/linux/man-pages/man1/ps.1.html"><span class="citerefentry"><span class="refentrytitle">ps</span>(1)</span></a>.  If the container
        does not run a service manager, it is recommended to set this option to
        "<code class="literal">no</code>".</p></dd><dt id="--keep-unit"><span class="term"><code class="option">--keep-unit</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--keep-unit">¶</a></dt><dd><p>Instead of creating a transient scope unit to run the container in, simply use the service or
        scope unit <span class="command"><strong>systemd-nspawn</strong></span> has been invoked in. If <code class="option">--register=yes</code> is set
        this unit is registered with
        <a href="systemd-machined.html#"><span class="citerefentry"><span class="refentrytitle">systemd-machined</span>(8)</span></a>. This
        switch should be used if <span class="command"><strong>systemd-nspawn</strong></span> is invoked from within a service unit, and the
        service unit's sole purpose is to run a single <span class="command"><strong>systemd-nspawn</strong></span> container. This option is not
        available if run from a user session.</p><p>Note that passing <code class="option">--keep-unit</code> disables the effect of <code class="option">--slice=</code> and
        <code class="option">--property=</code>. Use <code class="option">--keep-unit</code> and <code class="option">--register=no</code> in
        combination to disable any kind of unit allocation or registration with
        <span class="command"><strong>systemd-machined</strong></span>.</p></dd></dl></div></div><div class="refsect2"><a name="id-1.6.9"></a><h3 id="User Namespacing Options">User Namespacing Options<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#User%20Namespacing%20Options">¶</a></h3><div class="variablelist"><dl class="variablelist"><dt id="--private-users="><span class="term"><code class="option">--private-users=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--private-users=">¶</a></dt><dd><p>Controls user namespacing. If enabled, the container will run with its own private set of UNIX
        user and group ids (UIDs and GIDs). This involves mapping the private UIDs/GIDs used in the container (starting
        with the container's root user 0 and up) to a range of UIDs/GIDs on the host that are not used for other
        purposes (usually in the range beyond the host's UID/GID 65536). The parameter may be specified as follows:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>If one or two colon-separated numbers are specified, user namespacing is turned on. The first
          parameter specifies the first host UID/GID to assign to the container, the second parameter specifies the
          number of host UIDs/GIDs to assign to the container. If the second parameter is omitted, 65536 UIDs/GIDs are
          assigned.</p></li><li class="listitem"><p>If the parameter is "<code class="literal">yes</code>", user namespacing is turned on. The
          UID/GID range to use is determined automatically from the file ownership of the root directory of
          the container's directory tree. To use this option, make sure to prepare the directory tree in
          advance, and ensure that all files and directories in it are owned by UIDs/GIDs in the range you'd
          like to use. Also, make sure that used file ACLs exclusively reference UIDs/GIDs in the appropriate
          range. In this mode, the number of UIDs/GIDs assigned to the container is 65536, and the owner
          UID/GID of the root directory must be a multiple of 65536.</p></li><li class="listitem"><p>If the parameter is "<code class="literal">no</code>", user namespacing is turned off. This is
          the default.</p></li><li class="listitem"><p>If the parameter is "<code class="literal">identity</code>", user namespacing is employed with
          an identity mapping for the first 65536 UIDs/GIDs. This is mostly equivalent to
          <code class="option">--private-users=0:65536</code>. While it does not provide UID/GID isolation, since all
          host and container UIDs/GIDs are chosen identically it does provide process capability isolation,
          and hence is often a good choice if proper user namespacing with distinct UID maps is not
          appropriate.</p></li><li class="listitem"><p>The special value "<code class="literal">pick</code>" turns on user namespacing. In this case
          the UID/GID range is automatically chosen. As first step, the file owner UID/GID of the root
          directory of the container's directory tree is read, and it is checked that no other container is
          currently using it. If this check is successful, the UID/GID range determined this way is used,
          similar to the behavior if "<code class="literal">yes</code>" is specified. If the check is not successful (and
          thus the UID/GID range indicated in the root directory's file owner is already used elsewhere) a
          new – currently unused – UID/GID range of 65536 UIDs/GIDs is randomly chosen between the host
          UID/GIDs of 524288 and 1878982656, always starting at a multiple of 65536, and, if possible,
          consistently hashed from the machine name. This setting implies
          <code class="option">--private-users-ownership=auto</code> (see below), which possibly has the effect that the
          files and directories in the container's directory tree will be owned by the appropriate users of
          the range picked. Using this option makes user namespace behavior fully automatic. Note that the
          first invocation of a previously unused container image might result in picking a new UID/GID range
          for it, and thus in the (possibly expensive) file ownership adjustment operation. However,
          subsequent invocations of the container will be cheap (unless of course the picked UID/GID range is
          assigned to a different use by then).</p></li></ol></div><p>It is recommended to assign at least 65536 UIDs/GIDs to each container, so that the usable UID/GID range in the
        container covers 16 bit. For best security, do not assign overlapping UID/GID ranges to multiple containers. It is
        hence a good idea to use the upper 16 bit of the host 32-bit UIDs/GIDs as container identifier, while the lower 16
        bit encode the container UID/GID used. This is in fact the behavior enforced by the
        <code class="option">--private-users=pick</code> option.</p><p>When user namespaces are used, the GID range assigned to each container is always chosen identical to the
        UID range.</p><p>In most cases, using <code class="option">--private-users=pick</code> is the recommended option as it enhances
        container security massively and operates fully automatically in most cases.</p><p>Note that the picked UID/GID range is not written to <code class="filename">/etc/passwd</code> or
        <code class="filename">/etc/group</code>. In fact, the allocation of the range is not stored persistently anywhere,
        except in the file ownership of the files and directories of the container.</p><p>Note that when user namespacing is used file ownership on disk reflects this, and all of the container's
        files and directories are owned by the container's effective user and group IDs. This means that copying files
        from and to the container image requires correction of the numeric UID/GID values, according to the UID/GID
        shift applied.</p></dd><dt id="--private-users-ownership="><span class="term"><code class="option">--private-users-ownership=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--private-users-ownership=">¶</a></dt><dd><p>Controls how to adjust the container image's UIDs and GIDs to match the UID/GID range
        chosen with <code class="option">--private-users=</code>, see above. Takes one of "<code class="literal">off</code>" (to
        leave the image as is), "<code class="literal">chown</code>" (to recursively <code class="function">chown()</code> the
        container's directory tree as needed), "<code class="literal">map</code>" (in order to use transparent ID mapping
        mounts) or "<code class="literal">auto</code>" for automatically using "<code class="literal">map</code>" where available and
        "<code class="literal">chown</code>" where not.</p><p>If "<code class="literal">chown</code>" is selected, all files and directories in the container's directory
        tree will be adjusted so that they are owned by the appropriate UIDs/GIDs selected for the container
        (see above).  This operation is potentially expensive, as it involves iterating through the full
        directory tree of the container. Besides actual file ownership, file ACLs are adjusted as
        well.</p><p>Typically "<code class="literal">map</code>" is the best choice, since it transparently maps UIDs/GIDs in
        memory as needed without modifying the image, and without requiring an expensive recursive adjustment
        operation. However, it is not available for all file systems, currently.</p><p>The <code class="option">--private-users-ownership=auto</code> option is implied if
        <code class="option">--private-users=pick</code> is used. This option has no effect if user namespacing is not
        used.</p></dd><dt id="-U"><span class="term"><code class="option">-U</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#-U">¶</a></dt><dd><p>If the kernel supports the user namespaces feature, equivalent to
        <code class="option">--private-users=pick --private-users-ownership=auto</code>, otherwise equivalent to
        <code class="option">--private-users=no</code>.</p><p>Note that <code class="option">-U</code> is the default if the
        <code class="filename">systemd-nspawn@.service</code> template unit file is used.</p><p>Note: it is possible to undo the effect of <code class="option">--private-users-ownership=chown</code> (or
        <code class="option">-U</code>) on the file system by redoing the operation with the first UID of 0:</p><pre class="programlisting">systemd-nspawn … --private-users=0 --private-users-ownership=chown</pre></dd></dl></div></div><div class="refsect2"><a name="id-1.6.10"></a><h3 id="Networking Options">Networking Options<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#Networking%20Options">¶</a></h3><div class="variablelist"><dl class="variablelist"><dt id="--private-network"><span class="term"><code class="option">--private-network</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--private-network">¶</a></dt><dd><p>Disconnect networking of the container from
        the host. This makes all network interfaces unavailable in the
        container, with the exception of the loopback device and those
        specified with <code class="option">--network-interface=</code> and
        configured with <code class="option">--network-veth</code>. If this
        option is specified, the <code class="constant">CAP_NET_ADMIN</code> capability will be
        added to the set of capabilities the container retains. The
        latter may be disabled by using <code class="option">--drop-capability=</code>.
        If this option is not specified (or implied by one of the options
        listed below), the container will have full access to the host network.
        </p></dd><dt id="--network-interface="><span class="term"><code class="option">--network-interface=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--network-interface=">¶</a></dt><dd><p>Assign the specified network interface to the container. This will remove the
        specified interface from the calling namespace and place it in the container. When the container
        terminates, it is moved back to the calling namespace.  Note that
        <code class="option">--network-interface=</code> implies <code class="option">--private-network</code>. This option may be
        used more than once to add multiple network interfaces to the container.</p><p>Note that any network interface specified this way must already exist at the time the container
        is started. If the container shall be started automatically at boot via a
        <code class="filename">systemd-nspawn@.service</code> unit file instance, it might hence make sense to add a
        unit file drop-in to the service instance
        (e.g. <code class="filename">/etc/systemd/system/systemd-nspawn@foobar.service.d/50-network.conf</code>) with
        contents like the following:</p><pre class="programlisting">[Unit]
Wants=sys-subsystem-net-devices-ens1.device
After=sys-subsystem-net-devices-ens1.device</pre><p>This will make sure that activation of the container service will be delayed until the
        "<code class="literal">ens1</code>" network interface has shown up. This is required since hardware probing is
        fully asynchronous, and network interfaces might be discovered only later during the boot process,
        after the container would normally be started without these explicit dependencies.</p></dd><dt id="--network-macvlan="><span class="term"><code class="option">--network-macvlan=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--network-macvlan=">¶</a></dt><dd><p>Create a "<code class="literal">macvlan</code>" interface of the specified Ethernet network
        interface and add it to the container. A "<code class="literal">macvlan</code>" interface is a virtual interface
        that adds a second MAC address to an existing physical Ethernet link. The interface in the container
        will be named after the interface on the host, prefixed with "<code class="literal">mv-</code>". Note that
        <code class="option">--network-macvlan=</code> implies <code class="option">--private-network</code>. This option may be
        used more than once to add multiple network interfaces to the container.</p><p>As with <code class="option">--network-interface=</code>, the underlying Ethernet network interface must
        already exist at the time the container is started, and thus similar unit file drop-ins as described
        above might be useful.</p></dd><dt id="--network-ipvlan="><span class="term"><code class="option">--network-ipvlan=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--network-ipvlan=">¶</a></dt><dd><p>Create an "<code class="literal">ipvlan</code>" interface of the specified Ethernet network
        interface and add it to the container. An "<code class="literal">ipvlan</code>" interface is a virtual interface,
        similar to a "<code class="literal">macvlan</code>" interface, which uses the same MAC address as the underlying
        interface.  The interface in the container will be named after the interface on the host, prefixed
        with "<code class="literal">iv-</code>".  Note that <code class="option">--network-ipvlan=</code> implies
        <code class="option">--private-network</code>. This option may be used more than once to add multiple network
        interfaces to the container.</p><p>As with <code class="option">--network-interface=</code>, the underlying Ethernet network interface must
        already exist at the time the container is started, and thus similar unit file drop-ins as described
        above might be useful.</p></dd><dt id="-n"><span class="term"><code class="option">-n</code>, </span><span class="term"><code class="option">--network-veth</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#-n">¶</a></dt><dd><p>Create a virtual Ethernet link ("<code class="literal">veth</code>") between host and container. The host
        side of the Ethernet link will be available as a network interface named after the container's name (as
        specified with <code class="option">--machine=</code>), prefixed with "<code class="literal">ve-</code>". The container side of the
        Ethernet link will be named "<code class="literal">host0</code>". The <code class="option">--network-veth</code> option implies
        <code class="option">--private-network</code>.</p><p>Note that
        <a href="systemd-networkd.service.html#"><span class="citerefentry"><span class="refentrytitle">systemd-networkd.service</span>(8)</span></a>
        includes by default a network file <code class="filename">/usr/lib/systemd/network/80-container-ve.network</code>
        matching the host-side interfaces created this way, which contains settings to enable automatic address
        provisioning on the created virtual link via DHCP, as well as automatic IP routing onto the host's external
        network interfaces. It also contains <code class="filename">/usr/lib/systemd/network/80-container-host0.network</code>
        matching the container-side interface created this way, containing settings to enable client side address
        assignment via DHCP. In case <code class="filename">systemd-networkd</code> is running on both the host and inside the
        container, automatic IP communication from the container to the host is thus available, with further
        connectivity to the external network.</p><p>Note that <code class="option">--network-veth</code> is the default if the
        <code class="filename">systemd-nspawn@.service</code> template unit file is used.</p><p>Note that on Linux network interface names may have a length of 15 characters at maximum, while
        container names may have a length up to 64 characters. As this option derives the host-side interface
        name from the container name the name is possibly truncated. Thus, care needs to be taken to ensure
        that interface names remain unique in this case, or even better container names are generally not
        chosen longer than 12 characters, to avoid the truncation. If the name is truncated,
        <span class="command"><strong>systemd-nspawn</strong></span> will automatically append a 4-digit hash value to the name to
        reduce the chance of collisions. However, the hash algorithm is not collision-free. (See
        <a href="systemd.net-naming-scheme.html#"><span class="citerefentry"><span class="refentrytitle">systemd.net-naming-scheme</span>(7)</span></a>
        for details on older naming algorithms for this interface). Alternatively, the
        <code class="option">--network-veth-extra=</code> option may be used, which allows free configuration of the
        host-side interface name independently of the container name — but might require a bit more
        additional configuration in case bridging in a fashion similar to <code class="option">--network-bridge=</code>
        is desired.</p></dd><dt id="--network-veth-extra="><span class="term"><code class="option">--network-veth-extra=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--network-veth-extra=">¶</a></dt><dd><p>Adds an additional virtual Ethernet link
        between host and container. Takes a colon-separated pair of
        host interface name and container interface name. The latter
        may be omitted in which case the container and host sides will
        be assigned the same name. This switch is independent of
        <code class="option">--network-veth</code>, and — in contrast — may be
        used multiple times, and allows configuration of the network
        interface names. Note that <code class="option">--network-bridge=</code>
        has no effect on interfaces created with
        <code class="option">--network-veth-extra=</code>.</p></dd><dt id="--network-bridge="><span class="term"><code class="option">--network-bridge=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--network-bridge=">¶</a></dt><dd><p>Adds the host side of the Ethernet link created with <code class="option">--network-veth</code>
        to the specified Ethernet bridge interface. Expects a valid network interface name of a bridge device
        as argument. Note that <code class="option">--network-bridge=</code> implies <code class="option">--network-veth</code>. If
        this option is used, the host side of the Ethernet link will use the "<code class="literal">vb-</code>" prefix
        instead of "<code class="literal">ve-</code>". Regardless of the used naming prefix the same network interface
        name length limits imposed by Linux apply, along with the complications this creates (for details see
        above).</p><p>As with <code class="option">--network-interface=</code>, the underlying bridge network interface must
        already exist at the time the container is started, and thus similar unit file drop-ins as described
        above might be useful.</p></dd><dt id="--network-zone="><span class="term"><code class="option">--network-zone=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--network-zone=">¶</a></dt><dd><p>Creates a virtual Ethernet link ("<code class="literal">veth</code>") to the container and adds it to an
        automatically managed Ethernet bridge interface. The bridge interface is named after the passed argument,
        prefixed with "<code class="literal">vz-</code>". The bridge interface is automatically created when the first container
        configured for its name is started, and is automatically removed when the last container configured for its
        name exits. Hence, each bridge interface configured this way exists only as long as there's at least one
        container referencing it running. This option is very similar to <code class="option">--network-bridge=</code>, besides
        this automatic creation/removal of the bridge device.</p><p>This setting makes it easy to place multiple related containers on a common, virtual Ethernet-based
        broadcast domain, here called a "zone". Each container may only be part of one zone, but each zone may contain
        any number of containers. Each zone is referenced by its name. Names may be chosen freely (as long as they form
        valid network interface names when prefixed with "<code class="literal">vz-</code>"), and it is sufficient to pass the same
        name to the <code class="option">--network-zone=</code> switch of the various concurrently running containers to join
        them in one zone.</p><p>Note that
        <a href="systemd-networkd.service.html#"><span class="citerefentry"><span class="refentrytitle">systemd-networkd.service</span>(8)</span></a>
        includes by default a network file <code class="filename">/usr/lib/systemd/network/80-container-vz.network</code>
        matching the bridge interfaces created this way, which contains settings to enable automatic address
        provisioning on the created virtual network via DHCP, as well as automatic IP routing onto the host's external
        network interfaces. Using <code class="option">--network-zone=</code> is hence in most cases fully automatic and
        sufficient to connect multiple local containers in a joined broadcast domain to the host, with further
        connectivity to the external network.</p></dd><dt id="--network-namespace-path="><span class="term"><code class="option">--network-namespace-path=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--network-namespace-path=">¶</a></dt><dd><p>Takes the path to a file representing a kernel
        network namespace that the container shall run in. The specified path
        should refer to a (possibly bind-mounted) network namespace file, as
        exposed by the kernel below <code class="filename">/proc/$PID/ns/net</code>.
        This makes the container enter the given network namespace. One of the
        typical use cases is to give a network namespace under
        <code class="filename">/run/netns</code> created by <a href="http://man7.org/linux/man-pages/man8/ip-netns.8.html"><span class="citerefentry"><span class="refentrytitle">ip-netns</span>(8)</span></a>,
        for example, <code class="option">--network-namespace-path=/run/netns/foo</code>.
        Note that this option cannot be used together with other
        network-related options, such as <code class="option">--private-network</code>
        or <code class="option">--network-interface=</code>.</p></dd><dt id="-p"><span class="term"><code class="option">-p</code>, </span><span class="term"><code class="option">--port=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#-p">¶</a></dt><dd><p>If private networking is enabled, maps an IP
        port on the host onto an IP port on the container. Takes a
        protocol specifier (either "<code class="literal">tcp</code>" or
        "<code class="literal">udp</code>"), separated by a colon from a host port
        number in the range 1 to 65535, separated by a colon from a
        container port number in the range from 1 to 65535. The
        protocol specifier and its separating colon may be omitted, in
        which case "<code class="literal">tcp</code>" is assumed. The container
        port number and its colon may be omitted, in which case the
        same port as the host port is implied. This option is only
        supported if private networking is used, such as with
        <code class="option">--network-veth</code>, <code class="option">--network-zone=</code>
        <code class="option">--network-bridge=</code>.</p></dd></dl></div></div><div class="refsect2"><a name="id-1.6.11"></a><h3 id="Security Options">Security Options<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#Security%20Options">¶</a></h3><div class="variablelist"><dl class="variablelist"><dt id="--capability="><span class="term"><code class="option">--capability=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--capability=">¶</a></dt><dd><p>List one or more additional capabilities to grant the container.  Takes a
        comma-separated list of capability names, see <a href="http://man7.org/linux/man-pages/man7/capabilities.7.html"><span class="citerefentry"><span class="refentrytitle">capabilities</span>(7)</span></a>
        for more information. Note that the following capabilities will be granted in any way:
        <code class="constant">CAP_AUDIT_CONTROL</code>, <code class="constant">CAP_AUDIT_WRITE</code>,
        <code class="constant">CAP_CHOWN</code>, <code class="constant">CAP_DAC_OVERRIDE</code>,
        <code class="constant">CAP_DAC_READ_SEARCH</code>, <code class="constant">CAP_FOWNER</code>,
        <code class="constant">CAP_FSETID</code>, <code class="constant">CAP_IPC_OWNER</code>, <code class="constant">CAP_KILL</code>,
        <code class="constant">CAP_LEASE</code>, <code class="constant">CAP_LINUX_IMMUTABLE</code>,
        <code class="constant">CAP_MKNOD</code>, <code class="constant">CAP_NET_BIND_SERVICE</code>,
        <code class="constant">CAP_NET_BROADCAST</code>, <code class="constant">CAP_NET_RAW</code>,
        <code class="constant">CAP_SETFCAP</code>, <code class="constant">CAP_SETGID</code>, <code class="constant">CAP_SETPCAP</code>,
        <code class="constant">CAP_SETUID</code>, <code class="constant">CAP_SYS_ADMIN</code>,
        <code class="constant">CAP_SYS_BOOT</code>, <code class="constant">CAP_SYS_CHROOT</code>,
        <code class="constant">CAP_SYS_NICE</code>, <code class="constant">CAP_SYS_PTRACE</code>,
        <code class="constant">CAP_SYS_RESOURCE</code>, <code class="constant">CAP_SYS_TTY_CONFIG</code>. Also
        <code class="constant">CAP_NET_ADMIN</code> is retained if <code class="option">--private-network</code> is specified.
        If the special value "<code class="literal">all</code>" is passed, all capabilities are retained.</p><p>If the special value of "<code class="literal">help</code>" is passed, the program will print known
        capability names and exit.</p><p>This option sets the bounding set of capabilities which
        also limits the ambient capabilities as given with the
        <code class="option">--ambient-capability=</code>.</p></dd><dt id="--drop-capability="><span class="term"><code class="option">--drop-capability=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--drop-capability=">¶</a></dt><dd><p>Specify one or more additional capabilities to
        drop for the container. This allows running the container with
        fewer capabilities than the default (see
        above).</p><p>If the special value of "<code class="literal">help</code>" is passed, the program will print known
        capability names and exit.</p><p>This option sets the bounding set of capabilities which
        also limits the ambient capabilities as given with the
        <code class="option">--ambient-capability=</code>.</p></dd><dt id="--ambient-capability="><span class="term"><code class="option">--ambient-capability=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--ambient-capability=">¶</a></dt><dd><p>Specify one or more additional capabilities to
        pass in the inheritable and ambient set to the program started
        within the container. The value "<code class="literal">all</code>" is not
        supported for this setting.</p><p>All capabilities specified here must be in the set
        allowed with the <code class="option">--capability=</code> and
        <code class="option">--drop-capability=</code> options. Otherwise, an
        error message will be shown.</p><p>This option cannot be combined with the boot mode of the
        container (as requested via <code class="option">--boot</code>).</p><p>If the special value of "<code class="literal">help</code>" is
        passed, the program will print known capability names and
        exit.</p></dd><dt id="--no-new-privileges="><span class="term"><code class="option">--no-new-privileges=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--no-new-privileges=">¶</a></dt><dd><p>Takes a boolean argument. Specifies the value of the
        <code class="constant">PR_SET_NO_NEW_PRIVS</code> flag for the container payload. Defaults to off. When turned
        on the payload code of the container cannot acquire new privileges, i.e. the "setuid" file bit as
        well as file system capabilities will not have an effect anymore. See <a href="http://man7.org/linux/man-pages/man2/prctl.2.html"><span class="citerefentry"><span class="refentrytitle">prctl</span>(2)</span></a> for
        details about this flag. </p></dd><dt id="--system-call-filter="><span class="term"><code class="option">--system-call-filter=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--system-call-filter=">¶</a></dt><dd><p>Alter the system call filter
        applied to containers. Takes a space-separated list of system call names or group names (the latter
        prefixed with "<code class="literal">@</code>", as listed by the <span class="command"><strong>syscall-filter</strong></span> command of
        <a href="systemd-analyze.html#"><span class="citerefentry"><span class="refentrytitle">systemd-analyze</span>(1)</span></a>). Passed
        system calls will be permitted. The list may optionally be prefixed by "<code class="literal">~</code>", in which
        case all listed system calls are prohibited. If this command line option is used multiple times the
        configured lists are combined. If both a positive and a negative list (that is one system call list
        without and one with the "<code class="literal">~</code>" prefix) are configured, the negative list takes
        precedence over the positive list. Note that <span class="command"><strong>systemd-nspawn</strong></span> always implements a
        system call allow list (as opposed to a deny list!), and this command line option hence adds or
        removes entries from the default allow list, depending on the "<code class="literal">~</code>" prefix. Note that
        the applied system call filter is also altered implicitly if additional capabilities are passed using
        the <span class="command"><strong>--capabilities=</strong></span>.</p></dd><dt id="-Z"><span class="term"><code class="option">-Z</code>, </span><span class="term"><code class="option">--selinux-context=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#-Z">¶</a></dt><dd><p>Sets the SELinux security context to be used
        to label processes in the container.</p></dd><dt id="-L"><span class="term"><code class="option">-L</code>, </span><span class="term"><code class="option">--selinux-apifs-context=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#-L">¶</a></dt><dd><p>Sets the SELinux security context to be used
        to label files in the virtual API file systems in the
        container.</p></dd></dl></div></div><div class="refsect2"><a name="id-1.6.12"></a><h3 id="Resource Options">Resource Options<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#Resource%20Options">¶</a></h3><div class="variablelist"><dl class="variablelist"><dt id="--rlimit="><span class="term"><code class="option">--rlimit=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--rlimit=">¶</a></dt><dd><p>Sets the specified POSIX resource limit for the container payload. Expects an assignment of the
        form
        "<code class="literal"><em class="replaceable"><code>LIMIT</code></em>=<em class="replaceable"><code>SOFT</code></em>:<em class="replaceable"><code>HARD</code></em></code>"
        or "<code class="literal"><em class="replaceable"><code>LIMIT</code></em>=<em class="replaceable"><code>VALUE</code></em></code>", where
        <em class="replaceable"><code>LIMIT</code></em> should refer to a resource limit type, such as
        <code class="constant">RLIMIT_NOFILE</code> or <code class="constant">RLIMIT_NICE</code>. The <em class="replaceable"><code>SOFT</code></em> and
        <em class="replaceable"><code>HARD</code></em> fields should refer to the numeric soft and hard resource limit values. If the
        second form is used, <em class="replaceable"><code>VALUE</code></em> may specify a value that is used both as soft and hard
        limit. In place of a numeric value the special string "<code class="literal">infinity</code>" may be used to turn off
        resource limiting for the specific type of resource. This command line option may be used multiple times to
        control limits on multiple limit types. If used multiple times for the same limit type, the last use
        wins. For details about resource limits see <a href="http://man7.org/linux/man-pages/man2/setrlimit.2.html"><span class="citerefentry"><span class="refentrytitle">setrlimit</span>(2)</span></a>. By default
        resource limits for the container's init process (PID 1) are set to the same values the Linux kernel originally
        passed to the host init system. Note that some resource limits are enforced on resources counted per user, in
        particular <code class="constant">RLIMIT_NPROC</code>. This means that unless user namespacing is deployed
        (i.e. <code class="option">--private-users=</code> is used, see above), any limits set will be applied to the resource
        usage of the same user on all local containers as well as the host. This means particular care needs to be
        taken with these limits as they might be triggered by possibly less trusted code. Example:
        "<code class="literal">--rlimit=RLIMIT_NOFILE=8192:16384</code>".</p></dd><dt id="--oom-score-adjust="><span class="term"><code class="option">--oom-score-adjust=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--oom-score-adjust=">¶</a></dt><dd><p>Changes the OOM ("Out Of Memory") score adjustment value for the container payload. This controls
        <code class="filename">/proc/self/oom_score_adj</code> which influences the preference with which this container is
        terminated when memory becomes scarce. For details see <a href="http://man7.org/linux/man-pages/man5/proc.5.html"><span class="citerefentry"><span class="refentrytitle">proc</span>(5)</span></a>. Takes an
        integer in the range -1000…1000.</p></dd><dt id="--cpu-affinity="><span class="term"><code class="option">--cpu-affinity=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--cpu-affinity=">¶</a></dt><dd><p>Controls the CPU affinity of the container payload. Takes a comma separated list of CPU numbers
        or number ranges (the latter's start and end value separated by dashes). See <a href="http://man7.org/linux/man-pages/man2/sched_setaffinity.2.html"><span class="citerefentry"><span class="refentrytitle">sched_setaffinity</span>(2)</span></a> for
        details.</p></dd><dt id="--personality="><span class="term"><code class="option">--personality=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--personality=">¶</a></dt><dd><p>Control the architecture ("personality")
        reported by
        <a href="http://man7.org/linux/man-pages/man2/uname.2.html"><span class="citerefentry"><span class="refentrytitle">uname</span>(2)</span></a>
        in the container. Currently, only "<code class="literal">x86</code>" and
        "<code class="literal">x86-64</code>" are supported. This is useful when
        running a 32-bit container on a 64-bit host. If this setting
        is not used, the personality reported in the container is the
        same as the one reported on the host.</p></dd></dl></div></div><div class="refsect2"><a name="id-1.6.13"></a><h3 id="Integration Options">Integration Options<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#Integration%20Options">¶</a></h3><div class="variablelist"><dl class="variablelist"><dt id="--resolv-conf="><span class="term"><code class="option">--resolv-conf=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--resolv-conf=">¶</a></dt><dd><p>Configures how <code class="filename">/etc/resolv.conf</code> inside of the container shall be
        handled (i.e. DNS configuration synchronization from host to container). Takes one of
        "<code class="literal">off</code>", "<code class="literal">copy-host</code>", "<code class="literal">copy-static</code>",
        "<code class="literal">copy-uplink</code>", "<code class="literal">copy-stub</code>", "<code class="literal">replace-host</code>",
        "<code class="literal">replace-static</code>", "<code class="literal">replace-uplink</code>",
        "<code class="literal">replace-stub</code>", "<code class="literal">bind-host</code>", "<code class="literal">bind-static</code>",
        "<code class="literal">bind-uplink</code>", "<code class="literal">bind-stub</code>", "<code class="literal">delete</code>" or
        "<code class="literal">auto</code>".</p><p>If set to "<code class="literal">off</code>" the <code class="filename">/etc/resolv.conf</code> file in the
        container is left as it is included in the image, and neither modified nor bind mounted over.</p><p>If set to "<code class="literal">copy-host</code>", the <code class="filename">/etc/resolv.conf</code> file from the
        host is copied into the container, unless the file exists already and is not a regular file (e.g. a
        symlink). Similar, if "<code class="literal">replace-host</code>" is used the file is copied, replacing any
        existing inode, including symlinks. Similar, if "<code class="literal">bind-host</code>" is used, the file is
        bind mounted from the host into the container.</p><p>If set to "<code class="literal">copy-static</code>", "<code class="literal">replace-static</code>" or
        "<code class="literal">bind-static</code>" the static <code class="filename">resolv.conf</code> file supplied with
        <a href="systemd-resolved.service.html#"><span class="citerefentry"><span class="refentrytitle">systemd-resolved.service</span>(8)</span></a>
        (specifically: <code class="filename">/usr/lib/systemd/resolv.conf</code>) is copied or bind mounted into the
        container.</p><p>If set to "<code class="literal">copy-uplink</code>", "<code class="literal">replace-uplink</code>" or
        "<code class="literal">bind-uplink</code>" the uplink <code class="filename">resolv.conf</code> file managed by
        <code class="filename">systemd-resolved.service</code> (specifically:
        <code class="filename">/run/systemd/resolve/resolv.conf</code>) is copied or bind mounted into the
        container.</p><p>If set to "<code class="literal">copy-stub</code>", "<code class="literal">replace-stub</code>" or
        "<code class="literal">bind-stub</code>" the stub <code class="filename">resolv.conf</code> file managed by
        <code class="filename">systemd-resolved.service</code> (specifically:
        <code class="filename">/run/systemd/resolve/stub-resolv.conf</code>) is copied or bind mounted into the
        container.</p><p>If set to "<code class="literal">delete</code>" the <code class="filename">/etc/resolv.conf</code> file in the
        container is deleted if it exists.</p><p>Finally, if set to "<code class="literal">auto</code>" the file is left as it is if private networking is
        turned on (see <code class="option">--private-network</code>). Otherwise, if
        <code class="filename">systemd-resolved.service</code> is running its stub <code class="filename">resolv.conf</code>
        file is used, and if not the host's <code class="filename">/etc/resolv.conf</code> file. In the latter cases
        the file is copied if the image is writable, and bind mounted otherwise.</p><p>It's recommended to use "<code class="literal">copy-…</code>" or "<code class="literal">replace-…</code>" if the
        container shall be able to make changes to the DNS configuration on its own, deviating from the
        host's settings. Otherwise "<code class="literal">bind</code>" is preferable, as it means direct changes to
        <code class="filename">/etc/resolv.conf</code> in the container are not allowed, as it is a read-only bind
        mount (but note that if the container has enough privileges, it might simply go ahead and unmount the
        bind mount anyway). Note that both if the file is bind mounted and if it is copied no further
        propagation of configuration is generally done after the one-time early initialization (this is
        because the file is usually updated through copying and renaming). Defaults to
        "<code class="literal">auto</code>".</p></dd><dt id="--timezone="><span class="term"><code class="option">--timezone=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--timezone=">¶</a></dt><dd><p>Configures how <code class="filename">/etc/localtime</code> inside of the container
        (i.e. local timezone synchronization from host to container) shall be handled. Takes one of
        "<code class="literal">off</code>", "<code class="literal">copy</code>", "<code class="literal">bind</code>", "<code class="literal">symlink</code>",
        "<code class="literal">delete</code>" or "<code class="literal">auto</code>". If set to "<code class="literal">off</code>" the
        <code class="filename">/etc/localtime</code> file in the container is left as it is included in the image, and
        neither modified nor bind mounted over. If set to "<code class="literal">copy</code>" the
        <code class="filename">/etc/localtime</code> file of the host is copied into the container. Similarly, if
        "<code class="literal">bind</code>" is used, the file is bind mounted from the host into the container. If set to
        "<code class="literal">symlink</code>", a symlink is created pointing from <code class="filename">/etc/localtime</code> in
        the container to the timezone file in the container that matches the timezone setting on the host. If
        set to "<code class="literal">delete</code>", the file in the container is deleted, should it exist. If set to
        "<code class="literal">auto</code>" and the <code class="filename">/etc/localtime</code> file of the host is a symlink,
        then "<code class="literal">symlink</code>" mode is used, and "<code class="literal">copy</code>" otherwise, except if the
        image is read-only in which case "<code class="literal">bind</code>" is used instead. Defaults to
        "<code class="literal">auto</code>".</p></dd><dt id="--link-journal="><span class="term"><code class="option">--link-journal=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--link-journal=">¶</a></dt><dd><p>Control whether the container's journal shall
        be made visible to the host system. If enabled, allows viewing
        the container's journal files from the host (but not vice
        versa). Takes one of "<code class="literal">no</code>",
        "<code class="literal">host</code>", "<code class="literal">try-host</code>",
        "<code class="literal">guest</code>", "<code class="literal">try-guest</code>",
        "<code class="literal">auto</code>". If "<code class="literal">no</code>", the journal
        is not linked. If "<code class="literal">host</code>", the journal files
        are stored on the host file system (beneath
        <code class="filename">/var/log/journal/<em class="replaceable"><code>machine-id</code></em></code>)
        and the subdirectory is bind-mounted into the container at the
        same location. If "<code class="literal">guest</code>", the journal files
        are stored on the guest file system (beneath
        <code class="filename">/var/log/journal/<em class="replaceable"><code>machine-id</code></em></code>)
        and the subdirectory is symlinked into the host at the same
        location. "<code class="literal">try-host</code>" and
        "<code class="literal">try-guest</code>" do the same but do not fail if
        the host does not have persistent journaling enabled. If
        "<code class="literal">auto</code>" (the default), and the right
        subdirectory of <code class="filename">/var/log/journal</code> exists,
        it will be bind mounted into the container. If the
        subdirectory does not exist, no linking is performed.
        Effectively, booting a container once with
        "<code class="literal">guest</code>" or "<code class="literal">host</code>" will link
        the journal persistently if further on the default of
        "<code class="literal">auto</code>" is used.</p><p>Note that <code class="option">--link-journal=try-guest</code> is the default if the
        <code class="filename">systemd-nspawn@.service</code> template unit file is used.</p></dd><dt id="-j"><span class="term"><code class="option">-j</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#-j">¶</a></dt><dd><p>Equivalent to
        <code class="option">--link-journal=try-guest</code>.</p></dd></dl></div></div><div class="refsect2"><a name="id-1.6.14"></a><h3 id="Mount Options">Mount Options<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#Mount%20Options">¶</a></h3><div class="variablelist"><dl class="variablelist"><dt id="--bind="><span class="term"><code class="option">--bind=</code>, </span><span class="term"><code class="option">--bind-ro=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--bind=">¶</a></dt><dd><p>Bind mount a file or directory from the host into the container. Takes one of: a path
        argument — in which case the specified path will be mounted from the host to the same path in the container, or
        a colon-separated pair of paths — in which case the first specified path is the source in the host, and the
        second path is the destination in the container, or a colon-separated triple of source path, destination path
        and mount options. The source path may optionally be prefixed with a "<code class="literal">+</code>" character. If so, the
        source path is taken relative to the image's root directory. This permits setting up bind mounts within the
        container image. The source path may be specified as empty string, in which case a temporary directory below
        the host's <code class="filename">/var/tmp/</code> directory is used. It is automatically removed when the container is
        shut down. Mount options are comma-separated and currently, only <code class="option">rbind</code> and
        <code class="option">norbind</code> are allowed, controlling whether to create a recursive or a regular bind
        mount. Defaults to "rbind". Backslash escapes are interpreted, so "<code class="literal">\:</code>" may be used to embed
        colons in either path.  This option may be specified multiple times for creating multiple independent bind
        mount points. The <code class="option">--bind-ro=</code> option creates read-only bind mounts.</p><p>Note that when this option is used in combination with <code class="option">--private-users</code>, the resulting
        mount points will be owned by the <code class="constant">nobody</code> user. That's because the mount and its files and
        directories continue to be owned by the relevant host users and groups, which do not exist in the container,
        and thus show up under the wildcard UID 65534 (nobody). If such bind mounts are created, it is recommended to
        make them read-only, using <code class="option">--bind-ro=</code>.</p></dd><dt id="--bind-user="><span class="term"><code class="option">--bind-user=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--bind-user=">¶</a></dt><dd><p>Binds the home directory of the specified user on the host into the container. Takes
        the name of an existing user on the host as argument. May be used multiple times to bind multiple
        users into the container. This does three things:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>The user's home directory is bind mounted from the host into
          <code class="filename">/run/hosts/home/</code>.</p></li><li class="listitem"><p>An additional UID/GID mapping is added that maps the host user's UID/GID to a
          container UID/GID, allocated from the 60514…60577 range.</p></li><li class="listitem"><p>A JSON user and group record is generated in <code class="filename">/run/userdb/</code> that
          describes the mapped user. It contains a minimized representation of the host's user record,
          adjusted to the UID/GID and home directory path assigned to the user in the container. The
          <a href="nss-systemd.html#"><span class="citerefentry"><span class="refentrytitle">nss-systemd</span>(8)</span></a>
          glibc NSS module will pick up these records from there and make them available in the container's
          user/group databases.</p></li></ol></div><p>The combination of the three operations above ensures that it is possible to log into the
        container using the same account information as on the host. The user is only mapped transiently,
        while the container is running, and the mapping itself does not result in persistent changes to the
        container (except maybe for log messages generated at login time, and similar). Note that in
        particular the UID/GID assignment in the container is not made persistently. If the user is mapped
        transiently, it is best to not allow the user to make persistent changes to the container. If the
        user leaves files or directories owned by the user, and those UIDs/GIDs are reused during later
        container invocations (possibly with a different <code class="option">--bind-user=</code> mapping), those files
        and directories will be accessible to the "new" user.</p><p>The user/group record mapping only works if the container contains systemd 249 or newer, with
        <span class="command"><strong>nss-systemd</strong></span> properly configured in <code class="filename">nsswitch.conf</code>. See
        <a href="nss-systemd.html#"><span class="citerefentry"><span class="refentrytitle">nss-systemd</span>(8)</span></a> for
        details.</p><p>Note that the user record propagated from the host into the container will contain the UNIX
        password hash of the user, so that seamless logins in the container are possible. If the container is
        less trusted than the host it's hence important to use a strong UNIX password hash function
        (e.g. yescrypt or similar, with the "<code class="literal">$y$</code>" hash prefix).</p><p>When binding a user from the host into the container checks are executed to ensure that the
        username is not yet known in the container. Moreover, it is checked that the UID/GID allocated for it
        is not currently defined in the user/group databases of the container. Both checks directly access
        the container's <code class="filename">/etc/passwd</code> and <code class="filename">/etc/group</code>, and thus might
        not detect existing accounts in other databases.</p><p>This operation is only supported in combination with
        <code class="option">--private-users=</code>/<code class="option">-U</code>.</p></dd><dt id="--inaccessible="><span class="term"><code class="option">--inaccessible=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--inaccessible=">¶</a></dt><dd><p>Make the specified path inaccessible in the container. This over-mounts the specified path
        (which must exist in the container) with a file node of the same type that is empty and has the most
        restrictive access mode supported. This is an effective way to mask files, directories and other file system
        objects from the container payload. This option may be used more than once in case all specified paths are
        masked.</p></dd><dt id="--tmpfs="><span class="term"><code class="option">--tmpfs=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--tmpfs=">¶</a></dt><dd><p>Mount a tmpfs file system into the container.  Takes a single absolute path argument that
        specifies where to mount the tmpfs instance to (in which case the directory access mode will be chosen as 0755,
        owned by root/root), or optionally a colon-separated pair of path and mount option string that is used for
        mounting (in which case the kernel default for access mode and owner will be chosen, unless otherwise
        specified). Backslash escapes are interpreted in the path, so "<code class="literal">\:</code>" may be used to embed colons
        in the path.</p><p>Note that this option cannot be used to replace the root file system of the container with a temporary
        file system. However, the <code class="option">--volatile=</code> option described below provides similar
        functionality, with a focus on implementing stateless operating system images.</p></dd><dt id="--overlay="><span class="term"><code class="option">--overlay=</code>, </span><span class="term"><code class="option">--overlay-ro=</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--overlay=">¶</a></dt><dd><p>Combine multiple directory trees into one
        overlay file system and mount it into the container. Takes a
        list of colon-separated paths to the directory trees to
        combine and the destination mount point.</p><p>Backslash escapes are interpreted in the paths, so
        "<code class="literal">\:</code>" may be used to embed colons in the paths.
        </p><p>If three or more paths are specified, then the last
        specified path is the destination mount point in the
        container, all paths specified before refer to directory trees
        on the host and are combined in the specified order into one
        overlay file system. The left-most path is hence the lowest
        directory tree, the second-to-last path the highest directory
        tree in the stacking order. If <code class="option">--overlay-ro=</code>
        is used instead of <code class="option">--overlay=</code>, a read-only
        overlay file system is created. If a writable overlay file
        system is created, all changes made to it are written to the
        highest directory tree in the stacking order, i.e. the
        second-to-last specified.</p><p>If only two paths are specified, then the second
        specified path is used both as the top-level directory tree in
        the stacking order as seen from the host, as well as the mount
        point for the overlay file system in the container. At least
        two paths have to be specified.</p><p>The source paths may optionally be prefixed with "<code class="literal">+</code>" character. If so they are
        taken relative to the image's root directory. The uppermost source path may also be specified as an
        empty string, in which case a temporary directory below the host's <code class="filename">/var/tmp/</code> is
        used. The directory is removed automatically when the container is shut down. This behaviour is
        useful in order to make read-only container directories writable while the container is running. For
        example, use "<code class="literal">--overlay=+/var::/var</code>" in order to automatically overlay a writable
        temporary directory on a read-only <code class="filename">/var/</code> directory.</p><p>For details about overlay file systems, see <a class="ulink" href="https://www.kernel.org/doc/Documentation/filesystems/overlayfs.txt" target="_top">overlayfs.txt</a>. Note
        that the semantics of overlay file systems are substantially
        different from normal file systems, in particular regarding
        reported device and inode information. Device and inode
        information may change for a file while it is being written
        to, and processes might see out-of-date versions of files at
        times. Note that this switch automatically derives the
        "<code class="literal">workdir=</code>" mount option for the overlay file
        system from the top-level directory tree, making it a sibling
        of it. It is hence essential that the top-level directory tree
        is not a mount point itself (since the working directory must
        be on the same file system as the top-most directory
        tree). Also note that the "<code class="literal">lowerdir=</code>" mount
        option receives the paths to stack in the opposite order of
        this switch.</p><p>Note that this option cannot be used to replace the root file system of the container with an overlay
        file system. However, the <code class="option">--volatile=</code> option described above provides similar functionality,
        with a focus on implementing stateless operating system images.</p></dd></dl></div></div><div class="refsect2"><a name="id-1.6.15"></a><h3 id="Input/Output Options">Input/Output Options<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#Input/Output%20Options">¶</a></h3><div class="variablelist"><dl class="variablelist"><dt id="--console=MODE"><span class="term"><code class="option">--console=</code><em class="replaceable"><code>MODE</code></em></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--console=MODE">¶</a></dt><dd><p>Configures how to set up standard input, output and error output for the container
        payload, as well as the <code class="filename">/dev/console</code> device for the container. Takes one of
        <code class="option">interactive</code>, <code class="option">read-only</code>, <code class="option">passive</code>,
        <code class="option">pipe</code> or <code class="option">autopipe</code>. If <code class="option">interactive</code>, a pseudo-TTY is
        allocated and made available as <code class="filename">/dev/console</code> in the container. It is then
        bi-directionally connected to the standard input and output passed to
        <span class="command"><strong>systemd-nspawn</strong></span>. <code class="option">read-only</code> is similar but only the output of the
        container is propagated and no input from the caller is read. If <code class="option">passive</code>, a pseudo
        TTY is allocated, but it is not connected anywhere. In <code class="option">pipe</code> mode no pseudo TTY is
        allocated, but the standard input, output and error output file descriptors passed to
        <span class="command"><strong>systemd-nspawn</strong></span> are passed on — as they are — to the container payload, see the
        following paragraph. Finally, <code class="option">autopipe</code> mode operates like
        <code class="option">interactive</code> when <span class="command"><strong>systemd-nspawn</strong></span> is invoked on a terminal, and
        like <code class="option">pipe</code> otherwise. Defaults to <code class="option">interactive</code> if
        <span class="command"><strong>systemd-nspawn</strong></span> is invoked from a terminal, and <code class="option">read-only</code>
        otherwise.</p><p>In <code class="option">pipe</code> mode, <code class="filename">/dev/console</code> will not exist in the
        container. This means that the container payload generally cannot be a full init system as init
        systems tend to require <code class="filename">/dev/console</code> to be available. On the other hand, in this
        mode container invocations can be used within shell pipelines. This is because intermediary pseudo
        TTYs do not permit independent bidirectional propagation of the end-of-file (EOF) condition, which is
        necessary for shell pipelines to work correctly. <span class="emphasis"><em>Note that the <code class="option">pipe</code> mode
        should be used carefully</em></span>, as passing arbitrary file descriptors to less trusted container
        payloads might open up unwanted interfaces for access by the container payload. For example, if a
        passed file descriptor refers to a TTY of some form, APIs such as <code class="constant">TIOCSTI</code> may be
        used to synthesize input that might be used for escaping the container. Hence <code class="option">pipe</code>
        mode should only be used if the payload is sufficiently trusted or when the standard
        input/output/error output file descriptors are known safe, for example pipes.</p></dd><dt id="--pipe"><span class="term"><code class="option">--pipe</code>, </span><span class="term"><code class="option">-P</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--pipe">¶</a></dt><dd><p>Equivalent to <code class="option">--console=pipe</code>.</p></dd></dl></div></div><div class="refsect2"><a name="id-1.6.16"></a><h3 id="Credentials">Credentials<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#Credentials">¶</a></h3><div class="variablelist"><dl class="variablelist"><dt id="--load-credential=ID:PATH"><span class="term"><code class="option">--load-credential=</code><em class="replaceable"><code>ID</code></em>:<em class="replaceable"><code>PATH</code></em>, </span><span class="term"><code class="option">--set-credential=</code><em class="replaceable"><code>ID</code></em>:<em class="replaceable"><code>VALUE</code></em></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--load-credential=ID:PATH">¶</a></dt><dd><p>Pass a credential to the container. These two options correspond to the
        <code class="varname">LoadCredential=</code> and <code class="varname">SetCredential=</code> settings in unit files. See
        <a href="systemd.exec.html#"><span class="citerefentry"><span class="refentrytitle">systemd.exec</span>(5)</span></a> for
        details about these concepts, as well as the syntax of the option's arguments.</p><p>Note: when <span class="command"><strong>systemd-nspawn</strong></span> runs as systemd system service it can propagate
        the credentials it received via <code class="varname">LoadCredential=</code>/<code class="varname">SetCredential=</code>
        to the container payload. A systemd service manager running as PID 1 in the container can further
        propagate them to the services it itself starts. It is thus possible to easily propagate credentials
        from a parent service manager to a container manager service and from there into its payload. This
        can even be done recursively.</p><p>In order to embed binary data into the credential data for <code class="option">--set-credential=</code>
        use C-style escaping (i.e. "<code class="literal">\n</code>" to embed a newline, or "<code class="literal">\x00</code>" to
        embed a <code class="constant">NUL</code> byte. Note that the invoking shell might already apply unescaping
        once, hence this might require double escaping!).</p><p>The
        <a href="systemd-sysusers.service.html#"><span class="citerefentry"><span class="refentrytitle">systemd-sysusers.service</span>(8)</span></a>
        and
        <a href="systemd-firstboot.html#"><span class="citerefentry"><span class="refentrytitle">systemd-firstboot</span>(1)</span></a>
        services read credentials configured this way for the purpose of configuring the container's root
        user's password and shell, as well as system locale, keymap and timezone during the first boot
        process of the container. This is particularly useful in combination with
        <code class="option">--volatile=yes</code> where every single boot appears as first boot, since configuration
        applied to <code class="filename">/etc/</code> is lost on container reboot cycles. See the respective man
        pages for details. Example:</p><pre class="programlisting"># systemd-nspawn -i image.raw \
        --volatile=yes \
        --set-credential=firstboot.locale:de_DE.UTF-8 \
        --set-credential=passwd.hashed-password.root:'$y$j9T$yAuRJu1o5HioZAGDYPU5d.$F64ni6J2y2nNQve90M/p0ZP0ECP/qqzipNyaY9fjGpC' \
        -b</pre><p>The above command line will invoke the specified image file <code class="filename">image.raw</code> in
        volatile mode, i.e. with empty <code class="filename">/etc/</code> and <code class="filename">/var/</code>.  The
        container payload will recognize this as a first boot, and will invoke
        <code class="filename">systemd-firstboot.service</code>, which then reads the two passed credentials to
        configure the system's initial locale and root password.</p></dd></dl></div></div><div class="refsect2"><a name="id-1.6.17"></a><h3 id="Other">Other<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#Other">¶</a></h3><div class="variablelist"><dl class="variablelist"><dt id="--no-pager"><span class="term"><code class="option">--no-pager</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--no-pager">¶</a></dt><dd><p>Do not pipe output into a pager.</p></dd><dt id="-h"><span class="term"><code class="option">-h</code>, </span><span class="term"><code class="option">--help</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#-h">¶</a></dt><dd><p><a name="help-text"></a>Print a short help text and exit.
    </p></dd><dt id="--version"><span class="term"><code class="option">--version</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#--version">¶</a></dt><dd><p><a name="version-text"></a>Print a short version string and exit.</p></dd></dl></div></div></div><div class="refsect1"><a name="id-1.7"></a><h2 id="Environment">Environment<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#Environment">¶</a></h2><div class="variablelist"><dl class="variablelist"><dt id="$SYSTEMD_LOG_LEVEL"><span class="term"><code class="varname">$SYSTEMD_LOG_LEVEL</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#%24SYSTEMD_LOG_LEVEL">¶</a></dt><dd><p><a name="log-level-body"></a>The maximum log level of emitted messages (messages with a higher
      log level, i.e. less important ones, will be suppressed). Either one of (in order of decreasing
      importance) <code class="constant">emerg</code>, <code class="constant">alert</code>, <code class="constant">crit</code>,
      <code class="constant">err</code>, <code class="constant">warning</code>, <code class="constant">notice</code>,
      <code class="constant">info</code>, <code class="constant">debug</code>, or an integer in the range 0…7. See
      <a href="http://man7.org/linux/man-pages/man3/syslog.3.html"><span class="citerefentry"><span class="refentrytitle">syslog</span>(3)</span></a>
      for more information.</p></dd><dt id="$SYSTEMD_LOG_COLOR"><span class="term"><code class="varname">$SYSTEMD_LOG_COLOR</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#%24SYSTEMD_LOG_COLOR">¶</a></dt><dd><p><a name="log-color-body"></a>A boolean. If true, messages written to the tty will be colored
      according to priority.</p><p>This setting is only useful when messages are written directly to the terminal, because
      <a href="journalctl.html#"><span class="citerefentry"><span class="refentrytitle">journalctl</span>(1)</span></a> and
      other tools that display logs will color messages based on the log level on their own.</p></dd><dt id="$SYSTEMD_LOG_TIME"><span class="term"><code class="varname">$SYSTEMD_LOG_TIME</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#%24SYSTEMD_LOG_TIME">¶</a></dt><dd><p><a name="log-time-body"></a>A boolean. If true, console log messages will be prefixed with a
      timestamp.</p><p>This setting is only useful when messages are written directly to the terminal or a file, because
      <a href="journalctl.html#"><span class="citerefentry"><span class="refentrytitle">journalctl</span>(1)</span></a> and
      other tools that display logs will attach timestamps based on the entry metadata on their own.</p></dd><dt id="$SYSTEMD_LOG_LOCATION"><span class="term"><code class="varname">$SYSTEMD_LOG_LOCATION</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#%24SYSTEMD_LOG_LOCATION">¶</a></dt><dd><p><a name="log-location-body"></a>A boolean. If true, messages will be prefixed with a filename
      and line number in the source code where the message originates.</p><p>Note that the log location is often attached as metadata to journal entries anyway. Including it
      directly in the message text can nevertheless be convenient when debugging programs.</p></dd><dt id="$SYSTEMD_LOG_TID"><span class="term"><code class="varname">$SYSTEMD_LOG_TID</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#%24SYSTEMD_LOG_TID">¶</a></dt><dd><p><a name="log-tid-body"></a>A boolean. If true, messages will be prefixed with the current
      numerical thread ID (TID).</p><p>Note that the this information is attached as metadata to journal entries anyway. Including it
      directly in the message text can nevertheless be convenient when debugging programs.</p></dd><dt id="$SYSTEMD_LOG_TARGET"><span class="term"><code class="varname">$SYSTEMD_LOG_TARGET</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#%24SYSTEMD_LOG_TARGET">¶</a></dt><dd><p><a name="log-target-body"></a>The destination for log messages. One of
      <code class="constant">console</code> (log to the attached tty), <code class="constant">console-prefixed</code> (log to
      the attached tty but with prefixes encoding the log level and "facility", see <a href="http://man7.org/linux/man-pages/man3/syslog.3.html"><span class="citerefentry"><span class="refentrytitle">syslog</span>(3)</span></a>,
      <code class="constant">kmsg</code> (log to the kernel circular log buffer), <code class="constant">journal</code> (log to
      the journal), <code class="constant">journal-or-kmsg</code> (log to the journal if available, and to kmsg
      otherwise), <code class="constant">auto</code> (determine the appropriate log target automatically, the default),
      <code class="constant">null</code> (disable log output).</p></dd><dt id="$SYSTEMD_PAGER"><span class="term"><code class="varname">$SYSTEMD_PAGER</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#%24SYSTEMD_PAGER">¶</a></dt><dd><p>Pager to use when <code class="option">--no-pager</code> is not given; overrides
      <code class="varname">$PAGER</code>. If neither <code class="varname">$SYSTEMD_PAGER</code> nor <code class="varname">$PAGER</code> are set, a
      set of well-known pager implementations are tried in turn, including
      <a href="http://man7.org/linux/man-pages/man1/less.1.html"><span class="citerefentry"><span class="refentrytitle">less</span>(1)</span></a> and
      <a href="http://man7.org/linux/man-pages/man1/more.1.html"><span class="citerefentry"><span class="refentrytitle">more</span>(1)</span></a>, until one is found. If
      no pager implementation is discovered no pager is invoked. Setting this environment variable to an empty string
      or the value "<code class="literal">cat</code>" is equivalent to passing <code class="option">--no-pager</code>.</p></dd><dt id="$SYSTEMD_LESS"><span class="term"><code class="varname">$SYSTEMD_LESS</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#%24SYSTEMD_LESS">¶</a></dt><dd><p>Override the options passed to <span class="command"><strong>less</strong></span> (by default
      "<code class="literal">FRSXMK</code>").</p><p>Users might want to change two options in particular:</p><div class="variablelist"><dl class="variablelist"><dt id="K"><span class="term"><code class="option">K</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#K">¶</a></dt><dd></dd><dt id="X"><span class="term"><code class="option">X</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#X">¶</a></dt><dd></dd></dl></div><p>See
      <a href="http://man7.org/linux/man-pages/man1/less.1.html"><span class="citerefentry"><span class="refentrytitle">less</span>(1)</span></a>
      for more discussion.</p></dd><dt id="$SYSTEMD_LESSCHARSET"><span class="term"><code class="varname">$SYSTEMD_LESSCHARSET</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#%24SYSTEMD_LESSCHARSET">¶</a></dt><dd><p>Override the charset passed to <span class="command"><strong>less</strong></span> (by default "<code class="literal">utf-8</code>", if
      the invoking terminal is determined to be UTF-8 compatible).</p></dd><dt id="$SYSTEMD_PAGERSECURE"><span class="term"><code class="varname">$SYSTEMD_PAGERSECURE</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#%24SYSTEMD_PAGERSECURE">¶</a></dt><dd><p>Takes a boolean argument. When true, the "secure" mode of the pager is enabled; if
      false, disabled. If <code class="varname">$SYSTEMD_PAGERSECURE</code> is not set at all, secure mode is enabled
      if the effective UID is not the same as the owner of the login session, see
      <a href="http://man7.org/linux/man-pages/man2/geteuid.2.html"><span class="citerefentry"><span class="refentrytitle">geteuid</span>(2)</span></a>
      and <a href="sd_pid_get_owner_uid.html#"><span class="citerefentry"><span class="refentrytitle">sd_pid_get_owner_uid</span>(3)</span></a>.
      In secure mode, <code class="option">LESSSECURE=1</code> will be set when invoking the pager, and the pager shall
      disable commands that open or create new files or start new subprocesses. When
      <code class="varname">$SYSTEMD_PAGERSECURE</code> is not set at all, pagers which are not known to implement
      secure mode will not be used. (Currently only
      <a href="http://man7.org/linux/man-pages/man1/less.1.html"><span class="citerefentry"><span class="refentrytitle">less</span>(1)</span></a>
      implements secure mode.)</p><p>Note: when commands are invoked with elevated privileges, for example under <a href="http://man7.org/linux/man-pages/man8/sudo.8.html"><span class="citerefentry"><span class="refentrytitle">sudo</span>(8)</span></a> or
      <a href="http://linux.die.net/man/1/pkexec"><span class="citerefentry"><span class="refentrytitle">pkexec</span>(1)</span></a>, care
      must be taken to ensure that unintended interactive features are not enabled. "Secure" mode for the
      pager may be enabled automatically as describe above. Setting <code class="varname">SYSTEMD_PAGERSECURE=0</code>
      or not removing it from the inherited environment allows the user to invoke arbitrary commands. Note
      that if the <code class="varname">$SYSTEMD_PAGER</code> or <code class="varname">$PAGER</code> variables are to be
      honoured, <code class="varname">$SYSTEMD_PAGERSECURE</code> must be set too. It might be reasonable to completely
      disable the pager using <code class="option">--no-pager</code> instead.</p></dd><dt id="$SYSTEMD_COLORS"><span class="term"><code class="varname">$SYSTEMD_COLORS</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#%24SYSTEMD_COLORS">¶</a></dt><dd><p>Takes a boolean argument. When true, <span class="command"><strong>systemd</strong></span> and related utilities
      will use colors in their output, otherwise the output will be monochrome. Additionally, the variable can
      take one of the following special values: "<code class="literal">16</code>", "<code class="literal">256</code>" to restrict the use
      of colors to the base 16 or 256 ANSI colors, respectively. This can be specified to override the automatic
      decision based on <code class="varname">$TERM</code> and what the console is connected to.</p></dd><dt id="$SYSTEMD_URLIFY"><span class="term"><code class="varname">$SYSTEMD_URLIFY</code></span><a class="headerlink" title="Permalink to this term" href="systemd-nspawn.html#%24SYSTEMD_URLIFY">¶</a></dt><dd><p>The value must be a boolean. Controls whether clickable links should be generated in
      the output for terminal emulators supporting this. This can be specified to override the decision that
      <span class="command"><strong>systemd</strong></span> makes based on <code class="varname">$TERM</code> and other conditions.</p></dd></dl></div></div><div class="refsect1"><a name="id-1.8"></a><h2 id="Examples">Examples<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#Examples">¶</a></h2><div class="example"><a name="id-1.8.2"></a><p class="title"><b>Example 1. Download a
      <a class="ulink" href="https://getfedora.org" target="_top">Fedora</a> image and start a shell in it</b></p><div class="example-contents"><pre class="programlisting"># machinectl pull-raw --verify=no \
      https://download.fedoraproject.org/pub/fedora/linux/releases/34/Cloud/x86_64/images/Fedora-Cloud-Base-34-1.2.x86_64.raw.xz \
      Fedora-Cloud-Base-34-1.2.x86-64
# systemd-nspawn -M Fedora-Cloud-Base-34-1.2.x86-64</pre><p>This downloads an image using
      <a href="machinectl.html#"><span class="citerefentry"><span class="refentrytitle">machinectl</span>(1)</span></a>
      and opens a shell in it.</p></div></div><br class="example-break"><div class="example"><a name="id-1.8.3"></a><p class="title"><b>Example 2. Build and boot a minimal Fedora distribution in a container</b></p><div class="example-contents"><pre class="programlisting"># dnf -y --releasever=34 --installroot=/var/lib/machines/f34 \
      --disablerepo='*' --enablerepo=fedora --enablerepo=updates install \
      systemd passwd dnf fedora-release vim-minimal glibc-minimal-langpack
# systemd-nspawn -bD /var/lib/machines/f34</pre><p>This installs a minimal Fedora distribution into the
      directory <code class="filename">/var/lib/machines/f34</code>
      and then boots that OS in a namespace container. Because the installation
      is located underneath the standard <code class="filename">/var/lib/machines/</code>
      directory, it is also possible to start the machine using
      <span class="command"><strong>systemd-nspawn -M f34</strong></span>.</p></div></div><br class="example-break"><div class="example"><a name="id-1.8.4"></a><p class="title"><b>Example 3. Spawn a shell in a container of a minimal Debian unstable distribution</b></p><div class="example-contents"><pre class="programlisting"># debootstrap unstable ~/debian-tree/
# systemd-nspawn -D ~/debian-tree/</pre><p>This installs a minimal Debian unstable distribution into
      the directory <code class="filename">~/debian-tree/</code> and then
      spawns a shell from this image in a namespace container.</p><p><span class="command"><strong>debootstrap</strong></span> supports
      <a class="ulink" href="https://www.debian.org" target="_top">Debian</a>,
      <a class="ulink" href="https://www.ubuntu.com" target="_top">Ubuntu</a>,
      and <a class="ulink" href="https://www.tanglu.org" target="_top">Tanglu</a>
      out of the box, so the same command can be used to install any of those. For other
      distributions from the Debian family, a mirror has to be specified, see
      <a href="http://linux.die.net/man/8/debootstrap"><span class="citerefentry"><span class="refentrytitle">debootstrap</span>(8)</span></a>.
      </p></div></div><br class="example-break"><div class="example"><a name="id-1.8.5"></a><p class="title"><b>Example 4. Boot a minimal
      <a class="ulink" href="https://www.archlinux.org" target="_top">Arch Linux</a> distribution in a container</b></p><div class="example-contents"><pre class="programlisting"># pacstrap -c ~/arch-tree/ base
# systemd-nspawn -bD ~/arch-tree/</pre><p>This installs a minimal Arch Linux distribution into the
      directory <code class="filename">~/arch-tree/</code> and then boots an OS
      in a namespace container in it.</p></div></div><br class="example-break"><div class="example"><a name="id-1.8.6"></a><p class="title"><b>Example 5. Install the
      <a class="ulink" href="https://software.opensuse.org/distributions/tumbleweed" target="_top">OpenSUSE Tumbleweed</a>
      rolling distribution</b></p><div class="example-contents"><pre class="programlisting"># zypper --root=/var/lib/machines/tumbleweed ar -c \
      https://download.opensuse.org/tumbleweed/repo/oss tumbleweed
# zypper --root=/var/lib/machines/tumbleweed refresh
# zypper --root=/var/lib/machines/tumbleweed install --no-recommends \
      systemd shadow zypper openSUSE-release vim
# systemd-nspawn -M tumbleweed passwd root
# systemd-nspawn -M tumbleweed -b</pre></div></div><br class="example-break"><div class="example"><a name="id-1.8.7"></a><p class="title"><b>Example 6. Boot into an ephemeral snapshot of the host system</b></p><div class="example-contents"><pre class="programlisting"># systemd-nspawn -D / -xb</pre><p>This runs a copy of the host system in a snapshot which is removed immediately when the container
      exits. All file system changes made during runtime will be lost on shutdown, hence.</p></div></div><br class="example-break"><div class="example"><a name="id-1.8.8"></a><p class="title"><b>Example 7. Run a container with SELinux sandbox security contexts</b></p><div class="example-contents"><pre class="programlisting"># chcon system_u:object_r:svirt_sandbox_file_t:s0:c0,c1 -R /srv/container
# systemd-nspawn -L system_u:object_r:svirt_sandbox_file_t:s0:c0,c1 \
      -Z system_u:system_r:svirt_lxc_net_t:s0:c0,c1 -D /srv/container /bin/sh</pre></div></div><br class="example-break"><div class="example"><a name="id-1.8.9"></a><p class="title"><b>Example 8. Run a container with an OSTree deployment</b></p><div class="example-contents"><pre class="programlisting"># systemd-nspawn -b -i ~/image.raw \
      --pivot-root=/ostree/deploy/$OS/deploy/$CHECKSUM:/sysroot \
      --bind=+/sysroot/ostree/deploy/$OS/var:/var</pre></div></div><br class="example-break"></div><div class="refsect1"><a name="id-1.9"></a><h2 id="Exit status">Exit status<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#Exit%20status">¶</a></h2><p>The exit code of the program executed in the container is
    returned.</p></div><div class="refsect1"><a name="id-1.10"></a><h2 id="See Also">See Also<a class="headerlink" title="Permalink to this headline" href="systemd-nspawn.html#See%20Also">¶</a></h2><p>
      <a href="systemd.html#"><span class="citerefentry"><span class="refentrytitle">systemd</span>(1)</span></a>,
      <a href="systemd.nspawn.html#"><span class="citerefentry"><span class="refentrytitle">systemd.nspawn</span>(5)</span></a>,
      <a href="http://man7.org/linux/man-pages/man1/chroot.1.html"><span class="citerefentry"><span class="refentrytitle">chroot</span>(1)</span></a>,
      <a href="https://www.mankier.com/8/dnf"><span class="citerefentry"><span class="refentrytitle">dnf</span>(8)</span></a>,
      <a href="http://linux.die.net/man/8/debootstrap"><span class="citerefentry"><span class="refentrytitle">debootstrap</span>(8)</span></a>,
      <a href="https://www.archlinux.org/pacman/pacman.8.html"><span class="citerefentry"><span class="refentrytitle">pacman</span>(8)</span></a>,
      <a href="https://www.mankier.com/8/zypper"><span class="citerefentry"><span class="refentrytitle">zypper</span>(8)</span></a>,
      <a href="systemd.slice.html#"><span class="citerefentry"><span class="refentrytitle">systemd.slice</span>(5)</span></a>,
      <a href="machinectl.html#"><span class="citerefentry"><span class="refentrytitle">machinectl</span>(1)</span></a>,
      <a href="http://man7.org/linux/man-pages/man8/btrfs.8.html"><span class="citerefentry"><span class="refentrytitle">btrfs</span>(8)</span></a>
    </p></div></div></body></html>
