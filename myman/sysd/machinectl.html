<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><title>machinectl</title><meta name="generator" content="DocBook XSL Stylesheets Vsnapshot"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><style>
    a.headerlink {
      color: #c60f0f;
      font-size: 0.8em;
      padding: 0 4px 0 4px;
      text-decoration: none;
      visibility: hidden;
    }

    a.headerlink:hover {
      background-color: #c60f0f;
      color: white;
    }

    h1:hover > a.headerlink, h2:hover > a.headerlink, h3:hover > a.headerlink, dt:hover > a.headerlink {
      visibility: visible;
    }
  </style><a href="index.html">Index </a>·
  <a href="systemd.directives.html">Directives </a><span style="float:right">systemd 249</span><hr><div class="refentry"><a name="machinectl"></a><div class="titlepage"></div><div class="refnamediv"><h2>Name</h2><p>machinectl — Control the systemd machine manager</p></div><div class="refsynopsisdiv"><h2>Synopsis</h2><div class="cmdsynopsis"><p><code class="command">machinectl</code>  [OPTIONS...] {COMMAND} [NAME...]</p></div></div><div class="refsect1"><a name="id-1.5"></a><h2 id="Description">Description<a class="headerlink" title="Permalink to this headline" href="machinectl.html#Description">¶</a></h2><p><span class="command"><strong>machinectl</strong></span> may be used to introspect and
    control the state of the
    <a href="systemd.html#"><span class="citerefentry"><span class="refentrytitle">systemd</span>(1)</span></a>
    virtual machine and container registration manager
    <a href="systemd-machined.service.html#"><span class="citerefentry"><span class="refentrytitle">systemd-machined.service</span>(8)</span></a>.</p><p><span class="command"><strong>machinectl</strong></span> may be used to execute
    operations on machines and images. Machines in this sense are
    considered running instances of:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Virtual Machines (VMs) that virtualize hardware
      to run full operating system (OS) instances (including their kernels)
      in a virtualized environment on top of the host OS.</p></li><li class="listitem"><p>Containers that share the hardware and
      OS kernel with the host OS, in order to run
      OS userspace instances on top the host OS.</p></li><li class="listitem"><p>The host system itself.</p></li></ul></div><p>Machines are identified by names that follow the same rules
    as UNIX and DNS hostnames. For details, see below.</p><p>Machines are instantiated from disk or file system images that
    frequently — but not necessarily — carry the same name as machines running
    from them. Images in this sense may be:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>Directory trees containing an OS, including the
      top-level directories <code class="filename">/usr/</code>,
      <code class="filename">/etc/</code>, and so on.</p></li><li class="listitem"><p>btrfs subvolumes containing OS trees, similar to regular directory trees.</p></li><li class="listitem"><p>Binary "raw" disk image files containing MBR or GPT partition tables and Linux file
      systems.</p></li><li class="listitem"><p>Similarly, block devices containing MBR or GPT partition tables and file systems.</p></li><li class="listitem"><p>The file system tree of the host OS itself.</p></li></ul></div></div><div class="refsect1"><a name="id-1.6"></a><h2 id="Commands">Commands<a class="headerlink" title="Permalink to this headline" href="machinectl.html#Commands">¶</a></h2><p>The following commands are understood:</p><div class="refsect2"><a name="id-1.6.3"></a><h3 id="Machine Commands">Machine Commands<a class="headerlink" title="Permalink to this headline" href="machinectl.html#Machine%20Commands">¶</a></h3><div class="variablelist"><dl class="variablelist"><dt id="list"><span class="term"><span class="command"><strong>list</strong></span></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#list">¶</a></dt><dd><p>List currently running (online) virtual
        machines and containers. To enumerate machine images that can
        be started, use <span class="command"><strong>list-images</strong></span> (see
        below). Note that this command hides the special
        "<code class="literal">.host</code>" machine by default. Use the
        <code class="option">--all</code> switch to show it.</p></dd><dt id="status NAME…"><span class="term"><span class="command"><strong>status</strong></span> <em class="replaceable"><code>NAME</code></em>…</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#status%20NAME%E2%80%A6">¶</a></dt><dd><p>Show runtime status information about
        one or more virtual machines and containers, followed by the
        most recent log data from the journal. This function is
        intended to generate human-readable output. If you are looking
        for computer-parsable output, use <span class="command"><strong>show</strong></span>
        instead. Note that the log data shown is reported by the
        virtual machine or container manager, and frequently contains
        console output of the machine, but not necessarily journal
        contents of the machine itself.</p></dd><dt id="show [NAME…]"><span class="term"><span class="command"><strong>show</strong></span> [<em class="replaceable"><code>NAME</code></em>…]</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#show%20%5BNAME%E2%80%A6%5D">¶</a></dt><dd><p>Show properties of one or more registered virtual machines or containers or the manager
        itself. If no argument is specified, properties of the manager will be shown. If a NAME is specified,
        properties of this virtual machine or container are shown. By default, empty properties are suppressed. Use
        <code class="option">--all</code> to show those too.  To select specific properties to show, use
        <code class="option">--property=</code>. This command is intended to be used whenever computer-parsable output is
        required, and does not print the control group tree or journal entries. Use <span class="command"><strong>status</strong></span> if you
        are looking for formatted human-readable output.</p></dd><dt id="start NAME…"><span class="term"><span class="command"><strong>start</strong></span> <em class="replaceable"><code>NAME</code></em>…</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#start%20NAME%E2%80%A6">¶</a></dt><dd><p>Start a container as a system service, using
        <a href="systemd-nspawn.html#"><span class="citerefentry"><span class="refentrytitle">systemd-nspawn</span>(1)</span></a>.
        This starts <code class="filename">systemd-nspawn@.service</code>,
        instantiated for the specified machine name, similar to the
        effect of <span class="command"><strong>systemctl start</strong></span> on the service
        name. <span class="command"><strong>systemd-nspawn</strong></span> looks for a container
        image by the specified name in
        <code class="filename">/var/lib/machines/</code> (and other search
        paths, see below) and runs it. Use
        <span class="command"><strong>list-images</strong></span> (see below) for listing
        available container images to start.</p><p>Note that
        <a href="systemd-machined.service.html#"><span class="citerefentry"><span class="refentrytitle">systemd-machined.service</span>(8)</span></a>
        also interfaces with a variety of other container and VM
        managers, <span class="command"><strong>systemd-nspawn</strong></span> is just one
        implementation of it. Most of the commands available in
        <span class="command"><strong>machinectl</strong></span> may be used on containers or VMs
        controlled by other managers, not just
        <span class="command"><strong>systemd-nspawn</strong></span>. Starting VMs and container
        images on those managers requires manager-specific
        tools.</p><p>To interactively start a container on the command line
        with full access to the container's console, please invoke
        <span class="command"><strong>systemd-nspawn</strong></span> directly. To stop a running
        container use <span class="command"><strong>machinectl poweroff</strong></span>.</p></dd><dt id="login [NAME]"><span class="term"><span class="command"><strong>login</strong></span> [<em class="replaceable"><code>NAME</code></em>]</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#login%20%5BNAME%5D">¶</a></dt><dd><p>Open an interactive terminal login session in
        a container or on the local host. If an argument is supplied,
        it refers to the container machine to connect to. If none is
        specified, or the container name is specified as the empty
        string, or the special machine name "<code class="literal">.host</code>"
        (see below) is specified, the connection is made to the local
        host instead. This will create a TTY connection to a specific
        container or the local host and asks for the execution of a
        getty on it. Note that this is only supported for containers
        running
        <a href="systemd.html#"><span class="citerefentry"><span class="refentrytitle">systemd</span>(1)</span></a>
        as init system.</p><p>This command will open a full login prompt on the
        container or the local host, which then asks for username and
        password. Use <span class="command"><strong>shell</strong></span> (see below) or
        <a href="systemd-run.html#"><span class="citerefentry"><span class="refentrytitle">systemd-run</span>(1)</span></a>
        with the <code class="option">--machine=</code> switch to directly invoke
        a single command, either interactively or in the
        background.</p></dd><dt id="shell [[NAME@]NAME [PATH [ARGUMENTS…]]] "><span class="term"><span class="command"><strong>shell</strong></span> [[<em class="replaceable"><code>NAME</code></em>@]<em class="replaceable"><code>NAME</code></em> [<em class="replaceable"><code>PATH</code></em> [<em class="replaceable"><code>ARGUMENTS</code></em>…]]] </span><a class="headerlink" title="Permalink to this term" href="machinectl.html#shell%20%5B%5BNAME@%5DNAME%20%5BPATH%20%5BARGUMENTS%E2%80%A6%5D%5D%5D%20">¶</a></dt><dd><p>Open an interactive shell session in a
        container or on the local host. The first argument refers to
        the container machine to connect to. If none is specified, or
        the machine name is specified as the empty string, or the
        special machine name "<code class="literal">.host</code>" (see below) is
        specified, the connection is made to the local host
        instead. This works similar to <span class="command"><strong>login</strong></span> but
        immediately invokes a user process. This command runs the
        specified executable with the specified arguments, or the
        default shell for the user if none is specified, or
        <code class="filename">/bin/sh</code> if no default shell is found. By default,
        <code class="option">--uid=</code>, or by prefixing the machine name with
        a username and an "<code class="literal">@</code>" character, a different
        user may be selected. Use <code class="option">--setenv=</code> to set
        environment variables for the executed process.</p><p>Note that <span class="command"><strong>machinectl shell</strong></span> does not propagate the exit code/status of the invoked
        shell process. Use <span class="command"><strong>systemd-run</strong></span> instead if that information is required (see below).</p><p>When using the <span class="command"><strong>shell</strong></span> command without
        arguments, (thus invoking the executed shell or command on the
        local host), it is in many ways similar to a <a href="http://linux.die.net/man/1/su"><span class="citerefentry"><span class="refentrytitle">su</span>(1)</span></a>
        session, but, unlike <span class="command"><strong>su</strong></span>, completely isolates
        the new session from the originating session, so that it
        shares no process or session properties, and is in a clean and
        well-defined state. It will be tracked in a new utmp, login,
        audit, security and keyring session, and will not inherit any
        environment variables or resource limits, among other
        properties.</p><p>Note that <a href="systemd-run.html#"><span class="citerefentry"><span class="refentrytitle">systemd-run</span>(1)</span></a>
        with its <code class="option">--machine=</code> switch may be used in place of the <span class="command"><strong>machinectl shell</strong></span>
        command, and allows non-interactive operation, more detailed and low-level configuration of the invoked unit,
        as well as access to runtime and exit code/status information of the invoked shell process. In particular, use
        <span class="command"><strong>systemd-run</strong></span>'s <code class="option">--wait</code> switch to propagate exit status information of the
        invoked process. Use <span class="command"><strong>systemd-run</strong></span>'s <code class="option">--pty</code> switch for acquiring an
        interactive shell, similar to <span class="command"><strong>machinectl shell</strong></span>. In general, <span class="command"><strong>systemd-run</strong></span>
        is preferable for scripting purposes. However, note that <span class="command"><strong>systemd-run</strong></span> might require higher
        privileges than <span class="command"><strong>machinectl shell</strong></span>.</p></dd><dt id="enable NAME…"><span class="term"><span class="command"><strong>enable</strong></span> <em class="replaceable"><code>NAME</code></em>…, </span><span class="term"><span class="command"><strong>disable</strong></span> <em class="replaceable"><code>NAME</code></em>…</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#enable%20NAME%E2%80%A6">¶</a></dt><dd><p>Enable or disable a container as a system
        service to start at system boot, using
        <a href="systemd-nspawn.html#"><span class="citerefentry"><span class="refentrytitle">systemd-nspawn</span>(1)</span></a>.
        This enables or disables
        <code class="filename">systemd-nspawn@.service</code>, instantiated for
        the specified machine name, similar to the effect of
        <span class="command"><strong>systemctl enable</strong></span> or <span class="command"><strong>systemctl
        disable</strong></span> on the service name.</p></dd><dt id="poweroff NAME…"><span class="term"><span class="command"><strong>poweroff</strong></span> <em class="replaceable"><code>NAME</code></em>…</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#poweroff%20NAME%E2%80%A6">¶</a></dt><dd><p>Power off one or more containers. This will
        trigger a reboot by sending SIGRTMIN+4 to the container's init
        process, which causes systemd-compatible init systems to shut
        down cleanly. Use <span class="command"><strong>stop</strong></span> as alias for <span class="command"><strong>poweroff</strong></span>.
        This operation does not work on containers that do not run a
        <a href="systemd.html#"><span class="citerefentry"><span class="refentrytitle">systemd</span>(1)</span></a>-compatible
        init system, such as sysvinit. Use
        <span class="command"><strong>terminate</strong></span> (see below) to immediately
        terminate a container or VM, without cleanly shutting it
        down.</p></dd><dt id="reboot NAME…"><span class="term"><span class="command"><strong>reboot</strong></span> <em class="replaceable"><code>NAME</code></em>…</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#reboot%20NAME%E2%80%A6">¶</a></dt><dd><p>Reboot one or more containers. This will
        trigger a reboot by sending SIGINT to the container's init
        process, which is roughly equivalent to pressing Ctrl+Alt+Del
        on a non-containerized system, and is compatible with
        containers running any system manager.</p></dd><dt id="terminate NAME…"><span class="term"><span class="command"><strong>terminate</strong></span> <em class="replaceable"><code>NAME</code></em>…</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#terminate%20NAME%E2%80%A6">¶</a></dt><dd><p>Immediately terminates a virtual machine or
        container, without cleanly shutting it down. This kills all
        processes of the virtual machine or container and deallocates
        all resources attached to that instance. Use
        <span class="command"><strong>poweroff</strong></span> to issue a clean shutdown
        request.</p></dd><dt id="kill NAME…"><span class="term"><span class="command"><strong>kill</strong></span> <em class="replaceable"><code>NAME</code></em>…</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#kill%20NAME%E2%80%A6">¶</a></dt><dd><p>Send a signal to one or more processes of the
        virtual machine or container. This means processes as seen by
        the host, not the processes inside the virtual machine or
        container. Use <code class="option">--kill-who=</code> to select which
        process to kill. Use <code class="option">--signal=</code> to select the
        signal to send.</p></dd><dt id="bind NAME PATH [PATH]"><span class="term"><span class="command"><strong>bind</strong></span> <em class="replaceable"><code>NAME</code></em> <em class="replaceable"><code>PATH</code></em> [<em class="replaceable"><code>PATH</code></em>]</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#bind%20NAME%20PATH%20%5BPATH%5D">¶</a></dt><dd><p>Bind mounts a file or directory from the host into the specified container. The first path
        argument is the source file or directory on the host, the second path argument is the destination file or
        directory in the container. When the latter is omitted, the destination path in the container is the same as
        the source path on the host. When combined with the <code class="option">--read-only</code> switch, a ready-only bind
        mount is created. When combined with the <code class="option">--mkdir</code> switch, the destination path is first created
        before the mount is applied. Note that this option is currently only supported for
        <a href="systemd-nspawn.html#"><span class="citerefentry"><span class="refentrytitle">systemd-nspawn</span>(1)</span></a> containers,
        and only if user namespacing (<code class="option">--private-users</code>) is not used. This command supports bind
        mounting directories, regular files, device nodes, <code class="constant">AF_UNIX</code> socket nodes, as well as
        FIFOs.</p></dd><dt id="copy-to NAME PATH [PATH]"><span class="term"><span class="command"><strong>copy-to</strong></span> <em class="replaceable"><code>NAME</code></em> <em class="replaceable"><code>PATH</code></em> [<em class="replaceable"><code>PATH</code></em>]</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#copy-to%20NAME%20PATH%20%5BPATH%5D">¶</a></dt><dd><p>Copies files or directories from the host
        system into a running container. Takes a container name,
        followed by the source path on the host and the destination
        path in the container. If the destination path is omitted, the
        same as the source path is used.</p><p>If host and container share the same user and group namespace, file ownership by numeric user ID and
        group ID is preserved for the copy, otherwise all files and directories in the copy will be owned by the root
        user and group (UID/GID 0).</p></dd><dt id="copy-from NAME PATH [PATH]"><span class="term"><span class="command"><strong>copy-from</strong></span> <em class="replaceable"><code>NAME</code></em> <em class="replaceable"><code>PATH</code></em> [<em class="replaceable"><code>PATH</code></em>]</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#copy-from%20NAME%20PATH%20%5BPATH%5D">¶</a></dt><dd><p>Copies files or directories from a container
        into the host system. Takes a container name, followed by the
        source path in the container and the destination path on the host.
        If the destination path is omitted, the same as the source path
        is used.</p><p>If host and container share the same user and group namespace, file ownership by numeric user ID and
        group ID is preserved for the copy, otherwise all files and directories in the copy will be owned by the root
        user and group (UID/GID 0).</p></dd></dl></div></div><div class="refsect2"><a name="id-1.6.4"></a><h3 id="Image Commands">Image Commands<a class="headerlink" title="Permalink to this headline" href="machinectl.html#Image%20Commands">¶</a></h3><div class="variablelist"><dl class="variablelist"><dt id="list-images"><span class="term"><span class="command"><strong>list-images</strong></span></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#list-images">¶</a></dt><dd><p>Show a list of locally installed container and
        VM images. This enumerates all raw disk images and container
        directories and subvolumes in
        <code class="filename">/var/lib/machines/</code> (and other search
        paths, see below). Use <span class="command"><strong>start</strong></span> (see above) to
        run a container off one of the listed images. Note that, by
        default, containers whose name begins with a dot
        ("<code class="literal">.</code>") are not shown. To show these too,
        specify <code class="option">--all</code>. Note that a special image
        "<code class="literal">.host</code>" always implicitly exists and refers
        to the image the host itself is booted from.</p></dd><dt id="image-status [NAME…]"><span class="term"><span class="command"><strong>image-status</strong></span> [<em class="replaceable"><code>NAME</code></em>…]</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#image-status%20%5BNAME%E2%80%A6%5D">¶</a></dt><dd><p>Show terse status information about one or
        more container or VM images. This function is intended to
        generate human-readable output. Use
        <span class="command"><strong>show-image</strong></span> (see below) to generate
        computer-parsable output instead.</p></dd><dt id="show-image [NAME…]"><span class="term"><span class="command"><strong>show-image</strong></span> [<em class="replaceable"><code>NAME</code></em>…]</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#show-image%20%5BNAME%E2%80%A6%5D">¶</a></dt><dd><p>Show properties of one or more registered
        virtual machine or container images, or the manager itself. If
        no argument is specified, properties of the manager will be
        shown. If a NAME is specified, properties of this virtual
        machine or container image are shown. By default, empty
        properties are suppressed. Use <code class="option">--all</code> to show
        those too. To select specific properties to show, use
        <code class="option">--property=</code>. This command is intended to be
        used whenever computer-parsable output is required. Use
        <span class="command"><strong>image-status</strong></span> if you are looking for
        formatted human-readable output.</p></dd><dt id="clone NAME NAME"><span class="term"><span class="command"><strong>clone</strong></span> <em class="replaceable"><code>NAME</code></em> <em class="replaceable"><code>NAME</code></em></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#clone%20NAME%20NAME">¶</a></dt><dd><p>Clones a container or VM image. The arguments specify the name of the image to clone and the
        name of the newly cloned image. Note that plain directory container images are cloned into btrfs subvolume
        images with this command, if the underlying file system supports this.  Note that cloning a container or VM
        image is optimized for file systems that support copy-on-write, and might not be efficient on others, due to
        file system limitations.</p><p>Note that this command leaves hostname, machine ID and
        all other settings that could identify the instance
        unmodified. The original image and the cloned copy will hence
        share these credentials, and it might be necessary to manually
        change them in the copy.</p><p>If combined with the <code class="option">--read-only</code> switch a read-only cloned image is
        created.</p></dd><dt id="rename NAME NAME"><span class="term"><span class="command"><strong>rename</strong></span> <em class="replaceable"><code>NAME</code></em> <em class="replaceable"><code>NAME</code></em></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#rename%20NAME%20NAME">¶</a></dt><dd><p>Renames a container or VM image. The
        arguments specify the name of the image to rename and the new
        name of the image.</p></dd><dt id="read-only NAME [BOOL]"><span class="term"><span class="command"><strong>read-only</strong></span> <em class="replaceable"><code>NAME</code></em> [<em class="replaceable"><code>BOOL</code></em>]</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#read-only%20NAME%20%5BBOOL%5D">¶</a></dt><dd><p>Marks or (unmarks) a container or VM image
        read-only. Takes a VM or container image name, followed by a
        boolean as arguments. If the boolean is omitted, positive is
        implied, i.e. the image is marked read-only.</p></dd><dt id="remove NAME…"><span class="term"><span class="command"><strong>remove</strong></span> <em class="replaceable"><code>NAME</code></em>…</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#remove%20NAME%E2%80%A6">¶</a></dt><dd><p>Removes one or more container or VM images.
        The special image "<code class="literal">.host</code>", which refers to
        the host's own directory tree, may not be
        removed.</p></dd><dt id="set-limit [NAME] BYTES"><span class="term"><span class="command"><strong>set-limit</strong></span> [<em class="replaceable"><code>NAME</code></em>] <em class="replaceable"><code>BYTES</code></em></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#set-limit%20%5BNAME%5D%20BYTES">¶</a></dt><dd><p>Sets the maximum size in bytes that a specific
        container or VM image, or all images, may grow up to on disk
        (disk quota). Takes either one or two parameters. The first,
        optional parameter refers to a container or VM image name. If
        specified, the size limit of the specified image is changed. If
        omitted, the overall size limit of the sum of all images stored
        locally is changed. The final argument specifies the size
        limit in bytes, possibly suffixed by the usual K, M, G, T
        units. If the size limit shall be disabled, specify
        "<code class="literal">-</code>" as size.</p><p>Note that per-container size limits are only supported on btrfs file systems.</p></dd><dt id="clean"><span class="term"><span class="command"><strong>clean</strong></span></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#clean">¶</a></dt><dd><p>Remove hidden VM or container images (or all). This command removes all hidden machine images
        from <code class="filename">/var/lib/machines/</code>, i.e. those whose name begins with a dot. Use <span class="command"><strong>machinectl
        list-images --all</strong></span> to see a list of all machine images, including the hidden ones.</p><p>When combined with the <code class="option">--all</code> switch removes all images, not just hidden ones. This
        command effectively empties <code class="filename">/var/lib/machines/</code>.</p><p>Note that commands such as <span class="command"><strong>machinectl pull-tar</strong></span> or <span class="command"><strong>machinectl
        pull-raw</strong></span> usually create hidden, read-only, unmodified machine images from the downloaded image first,
        before cloning a writable working copy of it, in order to avoid duplicate downloads in case of images that are
        reused multiple times. Use <span class="command"><strong>machinectl clean</strong></span> to remove old, hidden images created this
        way.</p></dd></dl></div></div><div class="refsect2"><a name="id-1.6.5"></a><h3 id="Image Transfer Commands">Image Transfer Commands<a class="headerlink" title="Permalink to this headline" href="machinectl.html#Image%20Transfer%20Commands">¶</a></h3><div class="variablelist"><dl class="variablelist"><dt id="pull-tar URL [NAME]"><span class="term"><span class="command"><strong>pull-tar</strong></span> <em class="replaceable"><code>URL</code></em> [<em class="replaceable"><code>NAME</code></em>]</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#pull-tar%20URL%20%5BNAME%5D">¶</a></dt><dd><p>Downloads a <code class="filename">.tar</code>
        container image from the specified URL, and makes it available
        under the specified local machine name. The URL must be of
        type "<code class="literal">http://</code>" or
        "<code class="literal">https://</code>", and must refer to a
        <code class="filename">.tar</code>, <code class="filename">.tar.gz</code>,
        <code class="filename">.tar.xz</code> or <code class="filename">.tar.bz2</code>
        archive file. If the local machine name is omitted, it
        is automatically derived from the last component of the URL,
        with its suffix removed.</p><p>The image is verified before it is made available, unless
        <code class="option">--verify=no</code> is specified.
        Verification is done either via an inline signed file with the name
        of the image and the suffix <code class="filename">.sha256</code> or via
        separate <code class="filename">SHA256SUMS</code> and
        <code class="filename">SHA256SUMS.gpg</code> files.
        The signature files need to be made available on the same web
        server, under the same URL as the <code class="filename">.tar</code> file.
        With <code class="option">--verify=checksum</code>, only the SHA256 checksum
        for the file is verified, based on the <code class="filename">.sha256</code>
        suffixed file or the <code class="filename">SHA256SUMS</code> file.
        With <code class="option">--verify=signature</code>, the sha checksum file is
        first verified with the inline signature in the
        <code class="filename">.sha256</code> file or the detached GPG signature file
        <code class="filename">SHA256SUMS.gpg</code>.
        The public key for this verification step needs to be available in
        <code class="filename">/usr/lib/systemd/import-pubring.gpg</code> or
        <code class="filename">/etc/systemd/import-pubring.gpg</code>.</p><p>The container image will be downloaded and stored in a
        read-only subvolume in
        <code class="filename">/var/lib/machines/</code> that is named after
        the specified URL and its HTTP etag. A writable snapshot is
        then taken from this subvolume, and named after the specified
        local name. This behavior ensures that creating multiple
        container instances of the same URL is efficient, as multiple
        downloads are not necessary. In order to create only the
        read-only image, and avoid creating its writable snapshot,
        specify "<code class="literal">-</code>" as local machine name.</p><p>Note that the read-only subvolume is prefixed with
        <code class="filename">.tar-</code>, and is thus not shown by
        <span class="command"><strong>list-images</strong></span>, unless <code class="option">--all</code>
        is passed.</p><p>Note that pressing C-c during execution of this command
        will not abort the download. Use
        <span class="command"><strong>cancel-transfer</strong></span>, described
        below.</p></dd><dt id="pull-raw URL [NAME]"><span class="term"><span class="command"><strong>pull-raw</strong></span> <em class="replaceable"><code>URL</code></em> [<em class="replaceable"><code>NAME</code></em>]</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#pull-raw%20URL%20%5BNAME%5D">¶</a></dt><dd><p>Downloads a <code class="filename">.raw</code>
        container or VM disk image from the specified URL, and makes
        it available under the specified local machine name. The URL
        must be of type "<code class="literal">http://</code>" or
        "<code class="literal">https://</code>". The container image must either
        be a <code class="filename">.qcow2</code> or raw disk image, optionally
        compressed as <code class="filename">.gz</code>,
        <code class="filename">.xz</code>, or <code class="filename">.bz2</code>. If the
        local machine name is omitted, it is automatically
        derived from the last component of the URL, with its suffix
        removed.</p><p>Image verification is identical for raw and tar images
        (see above).</p><p>If the downloaded image is in
        <code class="filename">.qcow2</code> format it is converted into a raw
        image file before it is made available.</p><p>Downloaded images of this type will be placed as
        read-only <code class="filename">.raw</code> file in
        <code class="filename">/var/lib/machines/</code>. A local, writable
        (reflinked) copy is then made under the specified local
        machine name. To omit creation of the local, writable copy
        pass "<code class="literal">-</code>" as local machine name.</p><p>Similar to the behavior of <span class="command"><strong>pull-tar</strong></span>,
        the read-only image is prefixed with
        <code class="filename">.raw-</code>, and thus not shown by
        <span class="command"><strong>list-images</strong></span>, unless <code class="option">--all</code>
        is passed.</p><p>Note that pressing C-c during execution of this command
        will not abort the download. Use
        <span class="command"><strong>cancel-transfer</strong></span>, described
        below.</p></dd><dt id="import-tar FILE [NAME]"><span class="term"><span class="command"><strong>import-tar</strong></span> <em class="replaceable"><code>FILE</code></em> [<em class="replaceable"><code>NAME</code></em>], </span><span class="term"><span class="command"><strong>import-raw</strong></span> <em class="replaceable"><code>FILE</code></em> [<em class="replaceable"><code>NAME</code></em>]</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#import-tar%20FILE%20%5BNAME%5D">¶</a></dt><dd><p>Imports a TAR or RAW container or VM image,
        and places it under the specified name in
        <code class="filename">/var/lib/machines/</code>. When
        <span class="command"><strong>import-tar</strong></span> is used, the file specified as
        the first argument should be a tar archive, possibly compressed
        with xz, gzip or bzip2. It will then be unpacked into its own
        subvolume in <code class="filename">/var/lib/machines/</code>. When
        <span class="command"><strong>import-raw</strong></span> is used, the file should be a
        qcow2 or raw disk image, possibly compressed with xz, gzip or
        bzip2. If the second argument (the resulting image name) is
        not specified, it is automatically derived from the file
        name. If the filename is passed as "<code class="literal">-</code>", the
        image is read from standard input, in which case the second
        argument is mandatory.</p><p>Optionally, the <code class="option">--read-only</code> switch may be used to create a read-only container or VM
        image. No cryptographic validation is done when importing the images.</p><p>Much like image downloads, ongoing imports may be listed
        with <span class="command"><strong>list-transfers</strong></span> and aborted with
        <span class="command"><strong>cancel-transfer</strong></span>.</p></dd><dt id="import-fs DIRECTORY [NAME]"><span class="term"><span class="command"><strong>import-fs</strong></span> <em class="replaceable"><code>DIRECTORY</code></em> [<em class="replaceable"><code>NAME</code></em>]</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#import-fs%20DIRECTORY%20%5BNAME%5D">¶</a></dt><dd><p>Imports a container image stored in a local directory into
        <code class="filename">/var/lib/machines/</code>, operates similar to <span class="command"><strong>import-tar</strong></span> or
        <span class="command"><strong>import-raw</strong></span>, but the first argument is the source directory. If supported, this command will
        create btrfs snapshot or subvolume for the new image.</p></dd><dt id="export-tar NAME [FILE]"><span class="term"><span class="command"><strong>export-tar</strong></span> <em class="replaceable"><code>NAME</code></em> [<em class="replaceable"><code>FILE</code></em>], </span><span class="term"><span class="command"><strong>export-raw</strong></span> <em class="replaceable"><code>NAME</code></em> [<em class="replaceable"><code>FILE</code></em>]</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#export-tar%20NAME%20%5BFILE%5D">¶</a></dt><dd><p>Exports a TAR or RAW container or VM image and
        stores it in the specified file. The first parameter should be
        a VM or container image name. The second parameter should be a
        file path the TAR or RAW image is written to. If the path ends
        in "<code class="literal">.gz</code>", the file is compressed with gzip, if
        it ends in "<code class="literal">.xz</code>", with xz, and if it ends in
        "<code class="literal">.bz2</code>", with bzip2. If the path ends in
        neither, the file is left uncompressed. If the second argument
        is missing, the image is written to standard output. The
        compression may also be explicitly selected with the
        <code class="option">--format=</code> switch. This is in particular
        useful if the second parameter is left unspecified.</p><p>Much like image downloads and imports, ongoing exports
        may be listed with <span class="command"><strong>list-transfers</strong></span> and
        aborted with
        <span class="command"><strong>cancel-transfer</strong></span>.</p><p>Note that, currently, only directory and subvolume images
        may be exported as TAR images, and only raw disk images as RAW
        images.</p></dd><dt id="list-transfers"><span class="term"><span class="command"><strong>list-transfers</strong></span></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#list-transfers">¶</a></dt><dd><p>Shows a list of container or VM image
        downloads, imports and exports that are currently in
        progress.</p></dd><dt id="cancel-transfer ID…"><span class="term"><span class="command"><strong>cancel-transfer</strong></span> <em class="replaceable"><code>ID</code></em>…</span><a class="headerlink" title="Permalink to this term" href="machinectl.html#cancel-transfer%20ID%E2%80%A6">¶</a></dt><dd><p>Aborts a download, import or export of the
        container or VM image with the specified ID. To list ongoing
        transfers and their IDs, use
        <span class="command"><strong>list-transfers</strong></span>. </p></dd></dl></div></div></div><div class="refsect1"><a name="id-1.7"></a><h2 id="Options">Options<a class="headerlink" title="Permalink to this headline" href="machinectl.html#Options">¶</a></h2><p>The following options are understood:</p><div class="variablelist"><dl class="variablelist"><dt id="-p"><span class="term"><code class="option">-p</code>, </span><span class="term"><code class="option">--property=</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#-p">¶</a></dt><dd><p>When showing machine or image properties,
        limit the output to certain properties as specified by the
        argument. If not specified, all set properties are shown. The
        argument should be a property name, such as
        "<code class="literal">Name</code>". If specified more than once, all
        properties with the specified names are
        shown.</p></dd><dt id="-a"><span class="term"><code class="option">-a</code>, </span><span class="term"><code class="option">--all</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#-a">¶</a></dt><dd><p>When showing machine or image properties, show
        all properties regardless of whether they are set or
        not.</p><p>When listing VM or container images, do not suppress
        images beginning in a dot character
        ("<code class="literal">.</code>").</p><p>When cleaning VM or container images, remove all images, not just hidden ones.</p></dd><dt id="--value"><span class="term"><code class="option">--value</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#--value">¶</a></dt><dd><p>When printing properties with <span class="command"><strong>show</strong></span>, only print the value,
        and skip the property name and "<code class="literal">=</code>".</p></dd><dt id="-l"><span class="term"><code class="option">-l</code>, </span><span class="term"><code class="option">--full</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#-l">¶</a></dt><dd><p>Do not ellipsize process tree entries or table. This implies
        <code class="option">--max-addresses=full</code>.</p></dd><dt id="--kill-who="><span class="term"><code class="option">--kill-who=</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#--kill-who=">¶</a></dt><dd><p>When used with <span class="command"><strong>kill</strong></span>, choose
        which processes to kill. Must be one of
        <code class="option">leader</code>, or <code class="option">all</code> to select
        whether to kill only the leader process of the machine or all
        processes of the machine. If omitted, defaults to
        <code class="option">all</code>.</p></dd><dt id="-s"><span class="term"><code class="option">-s</code>, </span><span class="term"><code class="option">--signal=</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#-s">¶</a></dt><dd><p>When used with <span class="command"><strong>kill</strong></span>, choose which signal to send to selected processes. Must
      be one of the well-known signal specifiers such as <code class="constant">SIGTERM</code>,
      <code class="constant">SIGINT</code> or <code class="constant">SIGSTOP</code>. If omitted, defaults to
      <code class="option">SIGTERM</code>.</p><p>The special value "<code class="literal">help</code>" will list the known values and the program will exit
      immediately, and the special value "<code class="literal">list</code>" will list known values along with the
      numerical signal numbers and the program will exit immediately.</p></dd><dt id="--uid="><span class="term"><code class="option">--uid=</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#--uid=">¶</a></dt><dd><p>When used with the <span class="command"><strong>shell</strong></span> command, chooses the user ID to
         open the interactive shell session as. If the argument to the <span class="command"><strong>shell</strong></span>
         command also specifies a user name, this option is ignored. If the name is not specified
         in either way, "<code class="literal">root</code>" will be used by default. Note that this switch is
         not supported for the <span class="command"><strong>login</strong></span> command (see below).</p></dd><dt id="-E NAME[=VALUE]"><span class="term"><code class="option">-E <em class="replaceable"><code>NAME</code></em>[=<em class="replaceable"><code>VALUE</code></em>]</code>, </span><span class="term"><code class="option">--setenv=<em class="replaceable"><code>NAME</code></em>[=<em class="replaceable"><code>VALUE</code></em>]</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#-E%20NAME%5B=VALUE%5D">¶</a></dt><dd><p>When used with the <span class="command"><strong>shell</strong></span> command, sets an environment variable for
        the executed shell. This option may be used more than once to set multiple variables. When
        "<code class="literal">=</code>" and <em class="replaceable"><code>VALUE</code></em> are omitted, the value of the variable with
        the same name in the program environment will be used.</p><p>Note that this option is not supported for the <span class="command"><strong>login</strong></span> command.
        </p></dd><dt id="--mkdir"><span class="term"><code class="option">--mkdir</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#--mkdir">¶</a></dt><dd><p>When used with <span class="command"><strong>bind</strong></span>, creates the destination file or directory before
        applying the bind mount. Note that even though the name of this option suggests that it is suitable only for
        directories, this option also creates the destination file node to mount over if the object to mount is not
        a directory, but a regular file, device node, socket or FIFO.</p></dd><dt id="--read-only"><span class="term"><code class="option">--read-only</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#--read-only">¶</a></dt><dd><p>When used with <span class="command"><strong>bind</strong></span>, creates a read-only bind mount.</p><p>When used with <span class="command"><strong>clone</strong></span>, <span class="command"><strong>import-raw</strong></span> or <span class="command"><strong>import-tar</strong></span> a
        read-only container or VM image is created.</p></dd><dt id="-n"><span class="term"><code class="option">-n</code>, </span><span class="term"><code class="option">--lines=</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#-n">¶</a></dt><dd><p>When used with <span class="command"><strong>status</strong></span>,
        controls the number of journal lines to show, counting from
        the most recent ones. Takes a positive integer argument.
        Defaults to 10.</p></dd><dt id="-o"><span class="term"><code class="option">-o</code>, </span><span class="term"><code class="option">--output=</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#-o">¶</a></dt><dd><p>When used with <span class="command"><strong>status</strong></span>,
        controls the formatting of the journal entries that are shown.
        For the available choices, see
        <a href="journalctl.html#"><span class="citerefentry"><span class="refentrytitle">journalctl</span>(1)</span></a>.
        Defaults to "<code class="literal">short</code>".</p></dd><dt id="--verify="><span class="term"><code class="option">--verify=</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#--verify=">¶</a></dt><dd><p>When downloading a container or VM image,
        specify whether the image shall be verified before it is made
        available. Takes one of "<code class="literal">no</code>",
        "<code class="literal">checksum</code>" and "<code class="literal">signature</code>".
        If "<code class="literal">no</code>", no verification is done. If
        "<code class="literal">checksum</code>" is specified, the download is
        checked for integrity after the transfer is complete, but no
        signatures are verified. If "<code class="literal">signature</code>" is
        specified, the checksum is verified and the image's signature
        is checked against a local keyring of trustable vendors. It is
        strongly recommended to set this option to
        "<code class="literal">signature</code>" if the server and protocol
        support this. Defaults to
        "<code class="literal">signature</code>".</p></dd><dt id="--force"><span class="term"><code class="option">--force</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#--force">¶</a></dt><dd><p>When downloading a container or VM image, and
        a local copy by the specified local machine name already
        exists, delete it first and replace it by the newly downloaded
        image.</p></dd><dt id="--format="><span class="term"><code class="option">--format=</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#--format=">¶</a></dt><dd><p>When used with the <code class="option">export-tar</code>
        or <code class="option">export-raw</code> commands, specifies the
        compression format to use for the resulting file. Takes one of
        "<code class="literal">uncompressed</code>", "<code class="literal">xz</code>",
        "<code class="literal">gzip</code>", "<code class="literal">bzip2</code>". By default,
        the format is determined automatically from the image file
        name passed.</p></dd><dt id="--max-addresses="><span class="term"><code class="option">--max-addresses=</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#--max-addresses=">¶</a></dt><dd><p>When used with the <code class="option">list-machines</code> command, limits the number of ip
        addresses output for every machine.  Defaults to 1. All addresses can be requested with
        "<code class="literal">all</code>" as argument to <code class="option">--max-addresses=</code>. If the argument to
        <code class="option">--max-addresses=</code> is less than the actual number of addresses,
        "<code class="literal">…</code>"follows the last address.</p></dd><dt id="-q"><span class="term"><code class="option">-q</code>, </span><span class="term"><code class="option">--quiet</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#-q">¶</a></dt><dd><p>Suppresses additional informational output while running.</p></dd><dt id="-H"><span class="term"><code class="option">-H</code>, </span><span class="term"><code class="option">--host=</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#-H">¶</a></dt><dd><p><a name="host-text"></a>Execute the operation remotely. Specify a hostname, or a
      username and hostname separated by "<code class="literal">@</code>", to
      connect to. The hostname may optionally be suffixed by a
      port ssh is listening on, separated by "<code class="literal">:</code>", and then a
      container name, separated by "<code class="literal">/</code>", which
      connects directly to a specific container on the specified
      host. This will use SSH to talk to the remote machine manager
      instance. Container names may be enumerated with
      <span class="command"><strong>machinectl -H
      <em class="replaceable"><code>HOST</code></em></strong></span>. Put IPv6 addresses in brackets.</p></dd><dt id="-M"><span class="term"><code class="option">-M</code>, </span><span class="term"><code class="option">--machine=</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#-M">¶</a></dt><dd><p>Connect to
        <a href="systemd-machined.service.html#"><span class="citerefentry"><span class="refentrytitle">systemd-machined.service</span>(8)</span></a>
        running in a local container, to perform the specified operation within
        the container.</p></dd><dt id="--no-pager"><span class="term"><code class="option">--no-pager</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#--no-pager">¶</a></dt><dd><p>Do not pipe output into a pager.</p></dd><dt id="--no-legend"><span class="term"><code class="option">--no-legend</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#--no-legend">¶</a></dt><dd><p>Do not print the legend, i.e. column headers and the
      footer with hints.</p></dd><dt id="--no-ask-password"><span class="term"><code class="option">--no-ask-password</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#--no-ask-password">¶</a></dt><dd><p>Do not query the user for authentication for privileged operations.</p></dd><dt id="-h"><span class="term"><code class="option">-h</code>, </span><span class="term"><code class="option">--help</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#-h">¶</a></dt><dd><p><a name="help-text"></a>Print a short help text and exit.
    </p></dd><dt id="--version"><span class="term"><code class="option">--version</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#--version">¶</a></dt><dd><p><a name="version-text"></a>Print a short version string and exit.</p></dd></dl></div></div><div class="refsect1"><a name="id-1.8"></a><h2 id="Machine and Image Names">Machine and Image Names<a class="headerlink" title="Permalink to this headline" href="machinectl.html#Machine%20and%20Image%20Names">¶</a></h2><p>The <span class="command"><strong>machinectl</strong></span> tool operates on machines
    and images whose names must be chosen following strict
    rules. Machine names must be suitable for use as hostnames
    following a conservative subset of DNS and UNIX/Linux
    semantics. Specifically, they must consist of one or more
    non-empty label strings, separated by dots. No leading or trailing
    dots are allowed. No sequences of multiple dots are allowed. The
    label strings may only consist of alphanumeric characters as well
    as the dash and underscore. The maximum length of a machine name
    is 64 characters.</p><p>A special machine with the name "<code class="literal">.host</code>"
    refers to the running host system itself. This is useful for execution
    operations or inspecting the host system as well. Note that
    <span class="command"><strong>machinectl list</strong></span> will not show this special
    machine unless the <code class="option">--all</code> switch is specified.</p><p>Requirements on image names are less strict, however, they must be
    valid UTF-8, must be suitable as file names (hence not be the
    single or double dot, and not include a slash), and may not
    contain control characters. Since many operations search for an
    image by the name of a requested machine, it is recommended to name
    images in the same strict fashion as machines.</p><p>A special image with the name "<code class="literal">.host</code>"
    refers to the image of the running host system. It hence
    conceptually maps to the special "<code class="literal">.host</code>" machine
    name described above. Note that <span class="command"><strong>machinectl
    list-images</strong></span> will not show this special image either, unless
    <code class="option">--all</code> is specified.</p></div><div class="refsect1"><a name="id-1.9"></a><h2 id="Files and Directories">Files and Directories<a class="headerlink" title="Permalink to this headline" href="machinectl.html#Files%20and%20Directories">¶</a></h2><p>Machine images are preferably stored in
    <code class="filename">/var/lib/machines/</code>, but are also searched for
    in <code class="filename">/usr/local/lib/machines/</code> and
    <code class="filename">/usr/lib/machines/</code>. For compatibility reasons,
    the directory <code class="filename">/var/lib/container/</code> is
    searched, too. Note that images stored below
    <code class="filename">/usr/</code> are always considered read-only. It is
    possible to symlink machines images from other directories into
    <code class="filename">/var/lib/machines/</code> to make them available for
    control with <span class="command"><strong>machinectl</strong></span>.</p><p>Note that some image operations are only supported, efficient or atomic on btrfs file systems.</p><p>Disk images are understood by
    <a href="systemd-nspawn.html#"><span class="citerefentry"><span class="refentrytitle">systemd-nspawn</span>(1)</span></a>
    and <span class="command"><strong>machinectl</strong></span> in three formats:</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><p>A simple directory tree, containing the files
      and directories of the container to boot.</p></li><li class="listitem"><p>Subvolumes (on btrfs file systems), which are
      similar to the simple directories, described above. However,
      they have additional benefits, such as efficient cloning and
      quota reporting.</p></li><li class="listitem"><p>"Raw" disk images, i.e. binary images of disks
      with a GPT or MBR partition table. Images of this type are
      regular files with the suffix
      "<code class="literal">.raw</code>".</p></li></ul></div><p>See
    <a href="systemd-nspawn.html#"><span class="citerefentry"><span class="refentrytitle">systemd-nspawn</span>(1)</span></a>
    for more information on image formats, in particular its
    <code class="option">--directory=</code> and <code class="option">--image=</code>
    options.</p></div><div class="refsect1"><a name="id-1.10"></a><h2 id="Examples">Examples<a class="headerlink" title="Permalink to this headline" href="machinectl.html#Examples">¶</a></h2><div class="example"><a name="id-1.10.2"></a><p class="title"><b>Example 1. Download an Ubuntu image and open a shell in it</b></p><div class="example-contents"><pre class="programlisting"># machinectl pull-tar https://cloud-images.ubuntu.com/trusty/current/trusty-server-cloudimg-amd64-root.tar.gz
# systemd-nspawn -M trusty-server-cloudimg-amd64-root</pre><p>This downloads and verifies the specified
      <code class="filename">.tar</code> image, and then uses
      <a href="systemd-nspawn.html#"><span class="citerefentry"><span class="refentrytitle">systemd-nspawn</span>(1)</span></a>
      to open a shell in it.</p></div></div><br class="example-break"><div class="example"><a name="id-1.10.3"></a><p class="title"><b>Example 2. Download a Fedora image, set a root password in it, start
      it as a service</b></p><div class="example-contents"><pre class="programlisting"># machinectl pull-raw --verify=no \
      https://download.fedoraproject.org/pub/fedora/linux/releases/34/Cloud/x86_64/images/Fedora-Cloud-Base-34-1.2.x86_64.raw.xz \
      Fedora-Cloud-Base-34-1.2.x86-64
# systemd-nspawn -M Fedora-Cloud-Base-34-1.2.x86-64
# passwd
# exit
# machinectl start Fedora-Cloud-Base-34-1.2.x86-64
# machinectl login Fedora-Cloud-Base-34-1.2.x86-64</pre><p>This downloads the specified <code class="filename">.raw</code>
      image with verification disabled. Then, a shell is opened in it
      and a root password is set. Afterwards the shell is left, and
      the machine started as system service. With the last command a
      login prompt into the container is requested.</p></div></div><br class="example-break"><div class="example"><a name="id-1.10.4"></a><p class="title"><b>Example 3. Exports a container image as tar file</b></p><div class="example-contents"><pre class="programlisting"># machinectl export-tar fedora myfedora.tar.xz</pre><p>Exports the container "<code class="literal">fedora</code>" as an
      xz-compressed tar file <code class="filename">myfedora.tar.xz</code> into the
      current directory.</p></div></div><br class="example-break"><div class="example"><a name="id-1.10.5"></a><p class="title"><b>Example 4. Create a new shell session</b></p><div class="example-contents"><pre class="programlisting"># machinectl shell --uid=lennart</pre><p>This creates a new shell session on the local host for
      the user ID "<code class="literal">lennart</code>", in a <a href="http://linux.die.net/man/1/su"><span class="citerefentry"><span class="refentrytitle">su</span>(1)</span></a>-like
      fashion.</p></div></div><br class="example-break"></div><div class="refsect1"><a name="id-1.11"></a><h2 id="Exit status">Exit status<a class="headerlink" title="Permalink to this headline" href="machinectl.html#Exit%20status">¶</a></h2><p>On success, 0 is returned, a non-zero failure code
    otherwise.</p></div><div class="refsect1"><a name="id-1.12"></a><h2 id="Environment">Environment<a class="headerlink" title="Permalink to this headline" href="machinectl.html#Environment">¶</a></h2><div class="variablelist"><dl class="variablelist"><dt id="$SYSTEMD_LOG_LEVEL"><span class="term"><code class="varname">$SYSTEMD_LOG_LEVEL</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#%24SYSTEMD_LOG_LEVEL">¶</a></dt><dd><p><a name="log-level-body"></a>The maximum log level of emitted messages (messages with a higher
      log level, i.e. less important ones, will be suppressed). Either one of (in order of decreasing
      importance) <code class="constant">emerg</code>, <code class="constant">alert</code>, <code class="constant">crit</code>,
      <code class="constant">err</code>, <code class="constant">warning</code>, <code class="constant">notice</code>,
      <code class="constant">info</code>, <code class="constant">debug</code>, or an integer in the range 0…7. See
      <a href="http://man7.org/linux/man-pages/man3/syslog.3.html"><span class="citerefentry"><span class="refentrytitle">syslog</span>(3)</span></a>
      for more information.</p></dd><dt id="$SYSTEMD_LOG_COLOR"><span class="term"><code class="varname">$SYSTEMD_LOG_COLOR</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#%24SYSTEMD_LOG_COLOR">¶</a></dt><dd><p><a name="log-color-body"></a>A boolean. If true, messages written to the tty will be colored
      according to priority.</p><p>This setting is only useful when messages are written directly to the terminal, because
      <a href="journalctl.html#"><span class="citerefentry"><span class="refentrytitle">journalctl</span>(1)</span></a> and
      other tools that display logs will color messages based on the log level on their own.</p></dd><dt id="$SYSTEMD_LOG_TIME"><span class="term"><code class="varname">$SYSTEMD_LOG_TIME</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#%24SYSTEMD_LOG_TIME">¶</a></dt><dd><p><a name="log-time-body"></a>A boolean. If true, console log messages will be prefixed with a
      timestamp.</p><p>This setting is only useful when messages are written directly to the terminal or a file, because
      <a href="journalctl.html#"><span class="citerefentry"><span class="refentrytitle">journalctl</span>(1)</span></a> and
      other tools that display logs will attach timestamps based on the entry metadata on their own.</p></dd><dt id="$SYSTEMD_LOG_LOCATION"><span class="term"><code class="varname">$SYSTEMD_LOG_LOCATION</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#%24SYSTEMD_LOG_LOCATION">¶</a></dt><dd><p><a name="log-location-body"></a>A boolean. If true, messages will be prefixed with a filename
      and line number in the source code where the message originates.</p><p>Note that the log location is often attached as metadata to journal entries anyway. Including it
      directly in the message text can nevertheless be convenient when debugging programs.</p></dd><dt id="$SYSTEMD_LOG_TID"><span class="term"><code class="varname">$SYSTEMD_LOG_TID</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#%24SYSTEMD_LOG_TID">¶</a></dt><dd><p><a name="log-tid-body"></a>A boolean. If true, messages will be prefixed with the current
      numerical thread ID (TID).</p><p>Note that the this information is attached as metadata to journal entries anyway. Including it
      directly in the message text can nevertheless be convenient when debugging programs.</p></dd><dt id="$SYSTEMD_LOG_TARGET"><span class="term"><code class="varname">$SYSTEMD_LOG_TARGET</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#%24SYSTEMD_LOG_TARGET">¶</a></dt><dd><p><a name="log-target-body"></a>The destination for log messages. One of
      <code class="constant">console</code> (log to the attached tty), <code class="constant">console-prefixed</code> (log to
      the attached tty but with prefixes encoding the log level and "facility", see <a href="http://man7.org/linux/man-pages/man3/syslog.3.html"><span class="citerefentry"><span class="refentrytitle">syslog</span>(3)</span></a>,
      <code class="constant">kmsg</code> (log to the kernel circular log buffer), <code class="constant">journal</code> (log to
      the journal), <code class="constant">journal-or-kmsg</code> (log to the journal if available, and to kmsg
      otherwise), <code class="constant">auto</code> (determine the appropriate log target automatically, the default),
      <code class="constant">null</code> (disable log output).</p></dd><dt id="$SYSTEMD_PAGER"><span class="term"><code class="varname">$SYSTEMD_PAGER</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#%24SYSTEMD_PAGER">¶</a></dt><dd><p>Pager to use when <code class="option">--no-pager</code> is not given; overrides
      <code class="varname">$PAGER</code>. If neither <code class="varname">$SYSTEMD_PAGER</code> nor <code class="varname">$PAGER</code> are set, a
      set of well-known pager implementations are tried in turn, including
      <a href="http://man7.org/linux/man-pages/man1/less.1.html"><span class="citerefentry"><span class="refentrytitle">less</span>(1)</span></a> and
      <a href="http://man7.org/linux/man-pages/man1/more.1.html"><span class="citerefentry"><span class="refentrytitle">more</span>(1)</span></a>, until one is found. If
      no pager implementation is discovered no pager is invoked. Setting this environment variable to an empty string
      or the value "<code class="literal">cat</code>" is equivalent to passing <code class="option">--no-pager</code>.</p></dd><dt id="$SYSTEMD_LESS"><span class="term"><code class="varname">$SYSTEMD_LESS</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#%24SYSTEMD_LESS">¶</a></dt><dd><p>Override the options passed to <span class="command"><strong>less</strong></span> (by default
      "<code class="literal">FRSXMK</code>").</p><p>Users might want to change two options in particular:</p><div class="variablelist"><dl class="variablelist"><dt id="K"><span class="term"><code class="option">K</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#K">¶</a></dt><dd></dd><dt id="X"><span class="term"><code class="option">X</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#X">¶</a></dt><dd></dd></dl></div><p>See
      <a href="http://man7.org/linux/man-pages/man1/less.1.html"><span class="citerefentry"><span class="refentrytitle">less</span>(1)</span></a>
      for more discussion.</p></dd><dt id="$SYSTEMD_LESSCHARSET"><span class="term"><code class="varname">$SYSTEMD_LESSCHARSET</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#%24SYSTEMD_LESSCHARSET">¶</a></dt><dd><p>Override the charset passed to <span class="command"><strong>less</strong></span> (by default "<code class="literal">utf-8</code>", if
      the invoking terminal is determined to be UTF-8 compatible).</p></dd><dt id="$SYSTEMD_PAGERSECURE"><span class="term"><code class="varname">$SYSTEMD_PAGERSECURE</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#%24SYSTEMD_PAGERSECURE">¶</a></dt><dd><p>Takes a boolean argument. When true, the "secure" mode of the pager is enabled; if
      false, disabled. If <code class="varname">$SYSTEMD_PAGERSECURE</code> is not set at all, secure mode is enabled
      if the effective UID is not the same as the owner of the login session, see
      <a href="http://man7.org/linux/man-pages/man2/geteuid.2.html"><span class="citerefentry"><span class="refentrytitle">geteuid</span>(2)</span></a>
      and <a href="sd_pid_get_owner_uid.html#"><span class="citerefentry"><span class="refentrytitle">sd_pid_get_owner_uid</span>(3)</span></a>.
      In secure mode, <code class="option">LESSSECURE=1</code> will be set when invoking the pager, and the pager shall
      disable commands that open or create new files or start new subprocesses. When
      <code class="varname">$SYSTEMD_PAGERSECURE</code> is not set at all, pagers which are not known to implement
      secure mode will not be used. (Currently only
      <a href="http://man7.org/linux/man-pages/man1/less.1.html"><span class="citerefentry"><span class="refentrytitle">less</span>(1)</span></a>
      implements secure mode.)</p><p>Note: when commands are invoked with elevated privileges, for example under <a href="http://man7.org/linux/man-pages/man8/sudo.8.html"><span class="citerefentry"><span class="refentrytitle">sudo</span>(8)</span></a> or
      <a href="http://linux.die.net/man/1/pkexec"><span class="citerefentry"><span class="refentrytitle">pkexec</span>(1)</span></a>, care
      must be taken to ensure that unintended interactive features are not enabled. "Secure" mode for the
      pager may be enabled automatically as describe above. Setting <code class="varname">SYSTEMD_PAGERSECURE=0</code>
      or not removing it from the inherited environment allows the user to invoke arbitrary commands. Note
      that if the <code class="varname">$SYSTEMD_PAGER</code> or <code class="varname">$PAGER</code> variables are to be
      honoured, <code class="varname">$SYSTEMD_PAGERSECURE</code> must be set too. It might be reasonable to completely
      disable the pager using <code class="option">--no-pager</code> instead.</p></dd><dt id="$SYSTEMD_COLORS"><span class="term"><code class="varname">$SYSTEMD_COLORS</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#%24SYSTEMD_COLORS">¶</a></dt><dd><p>Takes a boolean argument. When true, <span class="command"><strong>systemd</strong></span> and related utilities
      will use colors in their output, otherwise the output will be monochrome. Additionally, the variable can
      take one of the following special values: "<code class="literal">16</code>", "<code class="literal">256</code>" to restrict the use
      of colors to the base 16 or 256 ANSI colors, respectively. This can be specified to override the automatic
      decision based on <code class="varname">$TERM</code> and what the console is connected to.</p></dd><dt id="$SYSTEMD_URLIFY"><span class="term"><code class="varname">$SYSTEMD_URLIFY</code></span><a class="headerlink" title="Permalink to this term" href="machinectl.html#%24SYSTEMD_URLIFY">¶</a></dt><dd><p>The value must be a boolean. Controls whether clickable links should be generated in
      the output for terminal emulators supporting this. This can be specified to override the decision that
      <span class="command"><strong>systemd</strong></span> makes based on <code class="varname">$TERM</code> and other conditions.</p></dd></dl></div></div><div class="refsect1"><a name="id-1.13"></a><h2 id="See Also">See Also<a class="headerlink" title="Permalink to this headline" href="machinectl.html#See%20Also">¶</a></h2><p>
      <a href="systemd.html#"><span class="citerefentry"><span class="refentrytitle">systemd</span>(1)</span></a>,
      <a href="systemd-machined.service.html#"><span class="citerefentry"><span class="refentrytitle">systemd-machined.service</span>(8)</span></a>,
      <a href="systemd-nspawn.html#"><span class="citerefentry"><span class="refentrytitle">systemd-nspawn</span>(1)</span></a>,
      <a href="systemd.special.html#"><span class="citerefentry"><span class="refentrytitle">systemd.special</span>(7)</span></a>,
      <a href="http://linux.die.net/man/1/tar"><span class="citerefentry"><span class="refentrytitle">tar</span>(1)</span></a>,
      <a href="http://linux.die.net/man/1/xz"><span class="citerefentry"><span class="refentrytitle">xz</span>(1)</span></a>,
      <a href="http://linux.die.net/man/1/gzip"><span class="citerefentry"><span class="refentrytitle">gzip</span>(1)</span></a>,
      <a href="http://linux.die.net/man/1/bzip2"><span class="citerefentry"><span class="refentrytitle">bzip2</span>(1)</span></a>
    </p></div></div></body></html>
