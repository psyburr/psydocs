<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-49925874-3"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-49925874-3');
  </script>

  <meta charset='utf-8'>
  <meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Git - Packfiles</title>

  <link href='favicon.ico' rel='shortcut icon' type='image/x-icon'>

  <link rel="stylesheet" media="screen" href="application-317ee030890d2caf96a53cbcc2a67040b748b2506d55661fc9c6754d0a024f59.css" />
  <script src="modernize-b3ebe0c31c24f230dc62179d3e1030d2e57a53b1668d9382c0a27dbd44a94beb.js"></script>
  <!--[if (gte IE 6)&(lte IE 8)]>
  <script src="/javascripts/selectivizr-min.js"></script>
  <![endif]-->

</head>

<body id="documentation">

  <div class="inner">
    <header>

  <a href="https://git-scm.com/"><img src="logo@2x.png" width="110" height="46" alt="Git" /></a>
  <span id="tagline"></span>
  <script type="text/javascript">
    var taglines = ["fast-version-control","everything-is-local","distributed-even-if-your-workflow-isnt","local-branching-on-the-cheap","distributed-is-the-new-centralized"];
    var tagline = taglines[Math.floor(Math.random() * taglines.length)];
    document.getElementById('tagline').innerHTML = '--' + tagline;
  </script>
  <form id="search" action="https://git-scm.com/search/results">
    <input id="search-text" name="search" placeholder="Search entire site..." autocomplete="off" type="text" />
  </form>
  <div id="search-results"></div>

</header>

  </div> <!-- .inner -->

    <div class="inner">
      <div id="content-wrapper">
        <button class="sidebar-btn"></button>
<aside class="sidebar" id="sidebar">
  <nav>
    <ul>
      <li>
        <a href="https://git-scm.com/about">About</a>
        <ul class="">
          <li>
            <a href="https://git-scm.com/about">Branching and Merging</a>
          </li>
          <li>
            <a href="https://git-scm.com/about/small-and-fast">Small and Fast</a>
          </li>
          <li>
            <a href="https://git-scm.com/about/distributed">Distributed</a>
          </li>
          <li>
            <a href="https://git-scm.com/about/info-assurance">Data Assurance</a>
          </li>
          <li>
            <a href="https://git-scm.com/about/staging-area">Staging Area</a>
          </li>
          <li>
            <a href="https://git-scm.com/about/free-and-open-source">Free and Open Source</a>
          </li>
          <li>
            <a href="https://git-scm.com/about/trademark">Trademark</a>
          </li>
        </ul>
      </li>
      <li>
        <a class="active" href="https://git-scm.com/doc">Documentation</a>
        <ul class="expanded">
          <li>
            <a href="https://git-scm.com/docs">Reference</a>
          </li>
          <li>
            <a class="active" href="https://git-scm.com/book">Book</a>
          </li>
          <li>
            <a href="https://git-scm.com/videos">Videos</a>
          </li>
          <li>
            <a href="https://git-scm.com/doc/ext">External Links</a>
          </li>
        </ul>
      </li>
      <li>
        <a href="https://git-scm.com/downloads">Downloads</a>
        <ul class="">
          <li>
            <a href="https://git-scm.com/downloads/guis">GUI Clients</a>
          </li>
          <li>
            <a href="https://git-scm.com/downloads/logos">Logos</a>
          </li>
        </ul>
      </li>
      <li>
        <a href="https://git-scm.com/community">Community</a>
      </li>
    </ul>
      <hr class="sidebar">
        <p>
This book is available in
  <a href="https://git-scm.com/book/en">English</a>.
</p>
<p>
  Full translation available in
  <table>
    <tr><td><a href="https://git-scm.com/book/az">azərbaycan dili</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/bg">български език</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/de">Deutsch</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/es">Español</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/fr">Français</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/gr">Ελληνικά</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/ja">日本語</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/ko">한국어</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/nl">Nederlands</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/ru">Русский</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/sl">Slovenščina</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/tl">Tagalog</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/uk">Українська</a></td></tr>
    <tr><td><a href="https://git-scm.com/book/zh">简体中文</a>,</td></tr>
  </table>
</p>
<p>
  Partial translations available in
  <table>
    <tr><td><a href="https://git-scm.com/book/cs">Čeština</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/mk">Македонски</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/pl">Polski</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/sr">Српски</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/uz">Ўзбекча</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/zh-tw">繁體中文</a>,</td></tr>
  </table>
</p>
<p>
  Translations started for
  <table>
    <tr><td><a href="https://git-scm.com/book/be">Беларуская</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/fa" dir="rtl">فارسی</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/id">Indonesian</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/it">Italiano</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/ms">Bahasa Melayu</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/pt-br">Português (Brasil)</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/pt-pt">Português (Portugal)</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/sv">Svenska</a>,</td></tr>
    <tr><td><a href="https://git-scm.com/book/tr">Türkçe</a>.</td></tr>
  </table>
</p>
<hr class="sidebar"/>
<p>
The source of this book is <a href="https://github.com/progit/progit2">hosted on GitHub.</a></br>
Patches, suggestions and comments are welcome.
</p>


  </nav>
</aside>

        <div id="content">
          

<div id='book-chapters'>
  <a class="dropdown-trigger" id="book-chapters-trigger" data-panel-id="chapters-dropdown" href="Git-Internals-Packfiles.html#">Chapters ▾</a>
<div class='dropdown-panel' id='chapters-dropdown'>
  <div class="three-column">
    <div class='column-left'>
      <ol class='book-toc'>
  <li class='chapter'>
  <h2>1. <a href="ch00/ch01-getting-started.html">Getting Started</a></h2>
    <ol>
        <li>
          1.1
          <a href="ch00/ch01-getting-started.html" >About Version Control </a>
        </li>
        <li>
          1.2
          <a href="Getting-Started-A-Short-History-of-Git.html" >A Short History of Git </a>
        </li>
        <li>
          1.3
          <a href="ch00/what_is_git_section.html" >What is Git? </a>
        </li>
        <li>
          1.4
          <a href="Getting-Started-The-Command-Line.html" >The Command Line </a>
        </li>
        <li>
          1.5
          <a href="Getting-Started-Installing-Git.html" >Installing Git </a>
        </li>
        <li>
          1.6
          <a href="ch00/_editor.html" >First-Time Git Setup </a>
        </li>
        <li>
          1.7
          <a href="ch00/_git_help.html" >Getting Help </a>
        </li>
        <li>
          1.8
          <a href="Getting-Started-Summary.html" >Summary </a>
        </li>
    </ol>
  </li>
  <li class='chapter'>
  <h2>2. <a href="ch00/_git_cloning.html">Git Basics</a></h2>
    <ol>
        <li>
          2.1
          <a href="ch00/_git_cloning.html" >Getting a Git Repository </a>
        </li>
        <li>
          2.2
          <a href="ch00/_git_mv.html" >Recording Changes to the Repository </a>
        </li>
        <li>
          2.3
          <a href="ch00/_viewing_history.html" >Viewing the Commit History </a>
        </li>
        <li>
          2.4
          <a href="ch00/_unstaging.html" >Undoing Things </a>
        </li>
        <li>
          2.5
          <a href="ch00/_remote_repos.html" >Working with Remotes </a>
        </li>
        <li>
          2.6
          <a href="ch00/_annotated_tags.html" >Tagging </a>
        </li>
        <li>
          2.7
          <a href="ch00/_git_aliases.html" >Git Aliases </a>
        </li>
        <li>
          2.8
          <a href="Git-Basics-Summary.html" >Summary </a>
        </li>
    </ol>
  </li>
  <li class='chapter'>
  <h2>3. <a href="ch00/_switching_branches.html">Git Branching</a></h2>
    <ol>
        <li>
          3.1
          <a href="ch00/_switching_branches.html" >Branches in a Nutshell </a>
        </li>
        <li>
          3.2
          <a href="ch00/_basic_branching.html" >Basic Branching and Merging </a>
        </li>
        <li>
          3.3
          <a href="ch00/_branch_management.html" >Branch Management </a>
        </li>
        <li>
          3.4
          <a href="ch00/_topic_branch.html" >Branching Workflows </a>
        </li>
        <li>
          3.5
          <a href="ch00/_delete_branches.html" >Remote Branches </a>
        </li>
        <li>
          3.6
          <a href="ch00/_rebase_rebase.html" >Rebasing </a>
        </li>
        <li>
          3.7
          <a href="Git-Branching-Summary.html" >Summary </a>
        </li>
    </ol>
  </li>
  <li class='chapter'>
  <h2>4. <a href="Git-on-the-Server-The-Protocols.html">Git on the Server</a></h2>
    <ol>
        <li>
          4.1
          <a href="Git-on-the-Server-The-Protocols.html" >The Protocols </a>
        </li>
        <li>
          4.2
          <a href="ch00/_bare_repo.html" >Getting Git on a Server </a>
        </li>
        <li>
          4.3
          <a href="ch00/_generate_ssh_key.html" >Generating Your SSH Public Key </a>
        </li>
        <li>
          4.4
          <a href="ch00/_setting_up_server.html" >Setting Up the Server </a>
        </li>
        <li>
          4.5
          <a href="Git-on-the-Server-Git-Daemon.html" >Git Daemon </a>
        </li>
        <li>
          4.6
          <a href="Git-on-the-Server-Smart-HTTP.html" >Smart HTTP </a>
        </li>
        <li>
          4.7
          <a href="Git-on-the-Server-GitWeb.html" >GitWeb </a>
        </li>
        <li>
          4.8
          <a href="ch00/_gitlab_groups_section.html" >GitLab </a>
        </li>
        <li>
          4.9
          <a href="Git-on-the-Server-Third-Party-Hosted-Options.html" >Third Party Hosted Options </a>
        </li>
        <li>
          4.10
          <a href="Git-on-the-Server-Summary.html" >Summary </a>
        </li>
    </ol>
  </li>
  <li class='chapter'>
  <h2>5. <a href="ch00/_integration_manager.html">Distributed Git</a></h2>
    <ol>
        <li>
          5.1
          <a href="ch00/_integration_manager.html" >Distributed Workflows </a>
        </li>
        <li>
          5.2
          <a href="ch00/_project_over_email.html" >Contributing to a Project </a>
        </li>
        <li>
          5.3
          <a href="ch00/_git_am.html" >Maintaining a Project </a>
        </li>
        <li>
          5.4
          <a href="Distributed-Git-Summary.html" >Summary </a>
        </li>
    </ol>
  </li>
</ol>

    </div>
    <div class='column-middle'>
      <ol class='book-toc'>
  <li class='chapter'>
  <h2>6. <a href="ch00/_personal_avatar.html">GitHub</a></h2>
    <ol>
        <li>
          6.1
          <a href="ch00/_personal_avatar.html" >Account Setup and Configuration </a>
        </li>
        <li>
          6.2
          <a href="ch00/_fetch_and_push_on_different_repositories.html" >Contributing to a Project </a>
        </li>
        <li>
          6.3
          <a href="ch00/_email_notifications.html" >Maintaining a Project </a>
        </li>
        <li>
          6.4
          <a href="ch00/_team_page.html" >Managing an organization </a>
        </li>
        <li>
          6.5
          <a href="ch00/_commit_status.html" >Scripting GitHub </a>
        </li>
        <li>
          6.6
          <a href="GitHub-Summary.html" >Summary </a>
        </li>
    </ol>
  </li>
  <li class='chapter'>
  <h2>7. <a href="ch00/_git_reflog.html">Git Tools</a></h2>
    <ol>
        <li>
          7.1
          <a href="ch00/_git_reflog.html" >Revision Selection </a>
        </li>
        <li>
          7.2
          <a href="ch00/_interactive_staging.html" >Interactive Staging </a>
        </li>
        <li>
          7.3
          <a href="ch00/_git_clean.html" >Stashing and Cleaning </a>
        </li>
        <li>
          7.4
          <a href="ch00/_signing_commits.html" >Signing Your Work </a>
        </li>
        <li>
          7.5
          <a href="ch00/_git_grep.html" >Searching </a>
        </li>
        <li>
          7.6
          <a href="ch00/_removing_file_every_commit.html" >Rewriting History </a>
        </li>
        <li>
          7.7
          <a href="ch00/_the_index.html" >Reset Demystified </a>
        </li>
        <li>
          7.8
          <a href="ch00/_reverse_commit.html" >Advanced Merging </a>
        </li>
        <li>
          7.9
          <a href="ch00/ref_rerere.html" >Rerere </a>
        </li>
        <li>
          7.10
          <a href="ch00/_file_annotation.html" >Debugging with Git </a>
        </li>
        <li>
          7.11
          <a href="ch00/_publishing_submodules.html" >Submodules </a>
        </li>
        <li>
          7.12
          <a href="ch00/_bundling.html" >Bundling </a>
        </li>
        <li>
          7.13
          <a href="ch00/_replace.html" >Replace </a>
        </li>
        <li>
          7.14
          <a href="ch00/_credential_caching.html" >Credential Storage </a>
        </li>
        <li>
          7.15
          <a href="Git-Tools-Summary.html" >Summary </a>
        </li>
    </ol>
  </li>
  <li class='chapter'>
  <h2>8. <a href="ch00/_external_merge_tools.html">Customizing Git</a></h2>
    <ol>
        <li>
          8.1
          <a href="ch00/_external_merge_tools.html" >Git Configuration </a>
        </li>
        <li>
          8.2
          <a href="ch00/_keyword_expansion.html" >Git Attributes </a>
        </li>
        <li>
          8.3
          <a href="ch00/_email_hooks.html" >Git Hooks </a>
        </li>
        <li>
          8.4
          <a href="ch00/_enforcing_commit_message_format.html" >An Example Git-Enforced Policy </a>
        </li>
        <li>
          8.5
          <a href="Customizing-Git-Summary.html" >Summary </a>
        </li>
    </ol>
  </li>
  <li class='chapter'>
  <h2>9. <a href="ch00/_git_svn.html">Git and Other Systems</a></h2>
    <ol>
        <li>
          9.1
          <a href="ch00/_git_svn.html" >Git as a Client </a>
        </li>
        <li>
          9.2
          <a href="ch00/_git_p4.html" >Migrating to Git </a>
        </li>
        <li>
          9.3
          <a href="Git-and-Other-Systems-Summary.html" >Summary </a>
        </li>
    </ol>
  </li>
  <li class='chapter'>
  <h2>10. <a href="ch00/_plumbing_porcelain.html">Git Internals</a></h2>
    <ol>
        <li>
          10.1
          <a href="ch00/_plumbing_porcelain.html" >Plumbing and Porcelain </a>
        </li>
        <li>
          10.2
          <a href="ch00/_git_commit_objects.html" >Git Objects </a>
        </li>
        <li>
          10.3
          <a href="ch00/ref_the_ref.html" >Git References </a>
        </li>
        <li>
          10.4
          <a href="Git-Internals-Packfiles.html" class=active>Packfiles </a>
        </li>
        <li>
          10.5
          <a href="ch00/_pushing_refspecs.html" >The Refspec </a>
        </li>
        <li>
          10.6
          <a href="Git-Internals-Transfer-Protocols.html" >Transfer Protocols </a>
        </li>
        <li>
          10.7
          <a href="ch00/_git_gc.html" >Maintenance and Data Recovery </a>
        </li>
        <li>
          10.8
          <a href="Git-Internals-Environment-Variables.html" >Environment Variables </a>
        </li>
        <li>
          10.9
          <a href="Git-Internals-Summary.html" >Summary </a>
        </li>
    </ol>
  </li>
</ol>

    </div>
    <div class='column-right'>
      <ol class='book-toc'>
  <li class='chapter'>
  <h2>A1. <a href="./Appendix-A:-Git-in-Other-Environments-Graphical-Interfaces.html">Appendix A: Git in Other Environments</a></h2>
    <ol>
        <li>
          A1.1
          <a href="./Appendix-A:-Git-in-Other-Environments-Graphical-Interfaces.html" >Graphical Interfaces </a>
        </li>
        <li>
          A1.2
          <a href="./Appendix-A:-Git-in-Other-Environments-Git-in-Visual-Studio.html" >Git in Visual Studio </a>
        </li>
        <li>
          A1.3
          <a href="./Appendix-A:-Git-in-Other-Environments-Git-in-Visual-Studio-Code.html" >Git in Visual Studio Code </a>
        </li>
        <li>
          A1.4
          <a href="./Appendix-A:-Git-in-Other-Environments-Git-in-IntelliJ-%252F-PyCharm-%252F-WebStorm-%252F-PhpStorm-%252F-RubyMine.html" >Git in IntelliJ / PyCharm / WebStorm / PhpStorm / RubyMine </a>
        </li>
        <li>
          A1.5
          <a href="./Appendix-A:-Git-in-Other-Environments-Git-in-Sublime-Text.html" >Git in Sublime Text </a>
        </li>
        <li>
          A1.6
          <a href="./Appendix-A:-Git-in-Other-Environments-Git-in-Bash.html" >Git in Bash </a>
        </li>
        <li>
          A1.7
          <a href="ch00/oh_my_zsh_git.html" >Git in Zsh </a>
        </li>
        <li>
          A1.8
          <a href="./Appendix-A:-Git-in-Other-Environments-Git-in-PowerShell.html" >Git in PowerShell </a>
        </li>
        <li>
          A1.9
          <a href="./Appendix-A:-Git-in-Other-Environments-Summary.html" >Summary </a>
        </li>
    </ol>
  </li>
  <li class='chapter'>
  <h2>A2. <a href="./Appendix-B:-Embedding-Git-in-your-Applications-Command-line-Git.html">Appendix B: Embedding Git in your Applications</a></h2>
    <ol>
        <li>
          A2.1
          <a href="./Appendix-B:-Embedding-Git-in-your-Applications-Command-line-Git.html" >Command-line Git </a>
        </li>
        <li>
          A2.2
          <a href="ch00/_libgit2_bindings.html" >Libgit2 </a>
        </li>
        <li>
          A2.3
          <a href="./Appendix-B:-Embedding-Git-in-your-Applications-JGit.html" >JGit </a>
        </li>
        <li>
          A2.4
          <a href="./Appendix-B:-Embedding-Git-in-your-Applications-go-git.html" >go-git </a>
        </li>
        <li>
          A2.5
          <a href="./Appendix-B:-Embedding-Git-in-your-Applications-Dulwich.html" >Dulwich </a>
        </li>
    </ol>
  </li>
  <li class='chapter'>
  <h2>A3. <a href="ch00/ch_core_editor.html">Appendix C: Git Commands</a></h2>
    <ol>
        <li>
          A3.1
          <a href="ch00/ch_core_editor.html" >Setup and Config </a>
        </li>
        <li>
          A3.2
          <a href="./Appendix-C:-Git-Commands-Getting-and-Creating-Projects.html" >Getting and Creating Projects </a>
        </li>
        <li>
          A3.3
          <a href="./Appendix-C:-Git-Commands-Basic-Snapshotting.html" >Basic Snapshotting </a>
        </li>
        <li>
          A3.4
          <a href="./Appendix-C:-Git-Commands-Branching-and-Merging.html" >Branching and Merging </a>
        </li>
        <li>
          A3.5
          <a href="./Appendix-C:-Git-Commands-Sharing-and-Updating-Projects.html" >Sharing and Updating Projects </a>
        </li>
        <li>
          A3.6
          <a href="./Appendix-C:-Git-Commands-Inspection-and-Comparison.html" >Inspection and Comparison </a>
        </li>
        <li>
          A3.7
          <a href="./Appendix-C:-Git-Commands-Debugging.html" >Debugging </a>
        </li>
        <li>
          A3.8
          <a href="./Appendix-C:-Git-Commands-Patching.html" >Patching </a>
        </li>
        <li>
          A3.9
          <a href="./Appendix-C:-Git-Commands-Email.html" >Email </a>
        </li>
        <li>
          A3.10
          <a href="./Appendix-C:-Git-Commands-External-Systems.html" >External Systems </a>
        </li>
        <li>
          A3.11
          <a href="./Appendix-C:-Git-Commands-Administration.html" >Administration </a>
        </li>
        <li>
          A3.12
          <a href="./Appendix-C:-Git-Commands-Plumbing-Commands.html" >Plumbing Commands </a>
        </li>
    </ol>
  </li>
</ol>

    </div>
  </div>
 </div>

    <span class="light" id="edition">
      2nd Edition
    </span>
</div>

<div id='main' class="book edition2">
    <h1>10.4 Git Internals - Packfiles</h1>
  <div>
<h2 id="_packfiles">Packfiles</h2>
<div class="paragraph">
<p>If you followed all of the instructions in the example from the previous section, you should now have a test Git repository with 11 objects — four blobs, three trees, three commits, and one tag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ find .git/objects -type f
.git/objects/01/55eb4229851634a0f03eb265b69f5a2d56f341 # tree 2
.git/objects/1a/410efbd13591db07496601ebc7a059dd55cfe9 # commit 3
.git/objects/1f/7a7a472abf3dd9643fd615f6da379c4acb3e3a # test.txt v2
.git/objects/3c/4e9cd789d88d8d89c1073707c3585e41b0e614 # tree 3
.git/objects/83/baae61804e65cc73a7201a7252750c76066a30 # test.txt v1
.git/objects/95/85191f37f7b0fb9444f35a9bf50de191beadc2 # tag
.git/objects/ca/c0cab538b970a37ea1e769cbbde608743bc96d # commit 2
.git/objects/d6/70460b4b4aece5915caf5c68d12f560a9fe3e4 # 'test content'
.git/objects/d8/329fc1cc938780ffdd9f94e0d364e0ea74f579 # tree 1
.git/objects/fa/49b077972391ad58037050f2a75f74e3671e92 # new.txt
.git/objects/fd/f4fc3344e67ab068f836878b6c4951e3b15f3d # commit 1</code></pre>
</div>
</div>
<div class="paragraph">
<p>Git compresses the contents of these files with zlib, and you’re not storing much, so all these files collectively take up only 925 bytes.
Now you’ll add some more sizable content to the repository to demonstrate an interesting feature of Git.
To demonstrate, we’ll add the <code>repo.rb</code> file from the Grit library — this is about a 22K source code file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ curl https://raw.githubusercontent.com/mojombo/grit/master/lib/grit/repo.rb &gt; repo.rb
$ git checkout master
$ git add repo.rb
$ git commit -m 'Create repo.rb'
[master 484a592] Create repo.rb
 3 files changed, 709 insertions(+), 2 deletions(-)
 delete mode 100644 bak/test.txt
 create mode 100644 repo.rb
 rewrite test.txt (100%)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you look at the resulting tree, you can see the SHA-1 value that was calculated for your new <code>repo.rb</code> blob object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git cat-file -p master^{tree}
100644 blob fa49b077972391ad58037050f2a75f74e3671e92      new.txt
100644 blob 033b4468fa6b2a9547a70d88d1bbe8bf3f9ed0d5      repo.rb
100644 blob e3f094f522629ae358806b17daf78246c27c007b      test.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can then use <code>git cat-file</code> to see how large that object is:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git cat-file -s 033b4468fa6b2a9547a70d88d1bbe8bf3f9ed0d5
22044</code></pre>
</div>
</div>
<div class="paragraph">
<p>At this point, modify that file a little, and see what happens:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ echo '# testing' &gt;&gt; repo.rb
$ git commit -am 'Modify repo.rb a bit'
[master 2431da6] Modify repo.rb a bit
 1 file changed, 1 insertion(+)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Check the tree created by that last commit, and you see something interesting:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git cat-file -p master^{tree}
100644 blob fa49b077972391ad58037050f2a75f74e3671e92      new.txt
100644 blob b042a60ef7dff760008df33cee372b945b6e884e      repo.rb
100644 blob e3f094f522629ae358806b17daf78246c27c007b      test.txt</code></pre>
</div>
</div>
<div class="paragraph">
<p>The blob is now a different blob, which means that although you added only a single line to the end of a 400-line file, Git stored that new content as a completely new object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git cat-file -s b042a60ef7dff760008df33cee372b945b6e884e
22054</code></pre>
</div>
</div>
<div class="paragraph">
<p>You have two nearly identical 22K objects on your disk (each compressed to approximately 7K).
Wouldn’t it be nice if Git could store one of them in full but then the second object only as the delta between it and the first?</p>
</div>
<div class="paragraph">
<p>It turns out that it can.
The initial format in which Git saves objects on disk is called a “loose” object format.
However, occasionally Git packs up several of these objects into a single binary file called a “packfile” in order to save space and be more efficient.
Git does this if you have too many loose objects around, if you run the <code>git gc</code> command manually, or if you push to a remote server.
To see what happens, you can manually ask Git to pack up the objects by calling the <code>git gc</code> command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git gc
Counting objects: 18, done.
Delta compression using up to 8 threads.
Compressing objects: 100% (14/14), done.
Writing objects: 100% (18/18), done.
Total 18 (delta 3), reused 0 (delta 0)</code></pre>
</div>
</div>
<div class="paragraph">
<p>If you look in your <code>objects</code> directory, you’ll find that most of your objects are gone, and a new pair of files has appeared:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ find .git/objects -type f
.git/objects/bd/9dbf5aae1a3862dd1526723246b20206e5fc37
.git/objects/d6/70460b4b4aece5915caf5c68d12f560a9fe3e4
.git/objects/info/packs
.git/objects/pack/pack-978e03944f5c581011e6998cd0e9e30000905586.idx
.git/objects/pack/pack-978e03944f5c581011e6998cd0e9e30000905586.pack</code></pre>
</div>
</div>
<div class="paragraph">
<p>The objects that remain are the blobs that aren’t pointed to by any commit — in this case, the “what is up, doc?” example and the “test content” example blobs you created earlier.
Because you never added them to any commits, they’re considered dangling and aren’t packed up in your new packfile.</p>
</div>
<div class="paragraph">
<p>The other files are your new packfile and an index.
The packfile is a single file containing the contents of all the objects that were removed from your filesystem.
The index is a file that contains offsets into that packfile so you can quickly seek to a specific object.
What is cool is that although the objects on disk before you ran the <code>gc</code> command were collectively about 15K in size, the new packfile is only 7K.
You’ve cut your disk usage by half by packing your objects.</p>
</div>
<div class="paragraph">
<p>How does Git do this?
When Git packs objects, it looks for files that are named and sized similarly, and stores just the deltas from one version of the file to the next.
You can look into the packfile and see what Git did to save space.
The <code>git verify-pack</code> plumbing command allows you to see what was packed up:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-console" data-lang="console">$ git verify-pack -v .git/objects/pack/pack-978e03944f5c581011e6998cd0e9e30000905586.idx
2431da676938450a4d72e260db3bf7b0f587bbc1 commit 223 155 12
69bcdaff5328278ab1c0812ce0e07fa7d26a96d7 commit 214 152 167
80d02664cb23ed55b226516648c7ad5d0a3deb90 commit 214 145 319
43168a18b7613d1281e5560855a83eb8fde3d687 commit 213 146 464
092917823486a802e94d727c820a9024e14a1fc2 commit 214 146 610
702470739ce72005e2edff522fde85d52a65df9b commit 165 118 756
d368d0ac0678cbe6cce505be58126d3526706e54 tag    130 122 874
fe879577cb8cffcdf25441725141e310dd7d239b tree   136 136 996
d8329fc1cc938780ffdd9f94e0d364e0ea74f579 tree   36 46 1132
deef2e1b793907545e50a2ea2ddb5ba6c58c4506 tree   136 136 1178
d982c7cb2c2a972ee391a85da481fc1f9127a01d tree   6 17 1314 1 \
  deef2e1b793907545e50a2ea2ddb5ba6c58c4506
3c4e9cd789d88d8d89c1073707c3585e41b0e614 tree   8 19 1331 1 \
  deef2e1b793907545e50a2ea2ddb5ba6c58c4506
0155eb4229851634a0f03eb265b69f5a2d56f341 tree   71 76 1350
83baae61804e65cc73a7201a7252750c76066a30 blob   10 19 1426
fa49b077972391ad58037050f2a75f74e3671e92 blob   9 18 1445
b042a60ef7dff760008df33cee372b945b6e884e blob   22054 5799 1463
033b4468fa6b2a9547a70d88d1bbe8bf3f9ed0d5 blob   9 20 7262 1 \
  b042a60ef7dff760008df33cee372b945b6e884e
1f7a7a472abf3dd9643fd615f6da379c4acb3e3a blob   10 19 7282
non delta: 15 objects
chain length = 1: 3 objects
.git/objects/pack/pack-978e03944f5c581011e6998cd0e9e30000905586.pack: ok</code></pre>
</div>
</div>
<div class="paragraph">
<p>Here, the <code>033b4</code> blob, which if you remember was the first version of your <code>repo.rb</code> file, is referencing the <code>b042a</code> blob, which was the second version of the file.
The third column in the output is the size of the object in the pack, so you can see that <code>b042a</code> takes up 22K of the file, but that <code>033b4</code> only takes up 9 bytes.
What is also interesting is that the second version of the file is the one that is stored intact, whereas the original version is stored as a delta — this is because you’re most likely to need faster access to the most recent version of the file.</p>
</div>
<div class="paragraph">
<p>The really nice thing about this is that it can be repacked at any time.
Git will occasionally repack your database automatically, always trying to save more space, but you can also manually repack at any time by running <code>git gc</code> by hand.</p>
</div>
<div id="nav"><a href="ch00/ref_the_ref.html">prev</a> | <a href="ch00/_pushing_refspecs.html">next</a></div></div>
</div>

        </div>
      </div>
      <footer>
  <div class="site-source">
    <a href="https://git-scm.com/site">About this site</a><br>
    Patches, suggestions, and comments are welcome.
  </div>
  <div class="sfc-member">
    Git is a member of <a href="https://git-scm.com/sfc">Software Freedom Conservancy</a>
  </div>
</footer>
<a href="Git-Internals-Packfiles.html#top" class="no-js scrollToTop" id="scrollToTop" data-label="Scroll to top">
  <img src="chevron-up@2x.png" width="20" height="20" alt="scroll-to-top"/>
</a>
<script src="application-b09f91f7c527919e4bc194769429065537d64a7f73b9fe93b107afef32b02939.js"></script>

    </div>

</body>
</html>
