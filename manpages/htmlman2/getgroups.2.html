<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>getgroups(2) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="getgroups(2) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve"> </script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>
<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>
          <th rowspan="1" colspan="1"><a href="../index2.html" shape="rect">Section 2</a></th>
          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>
  <div class="refentry">
    <a id="getgroups.2" name="getgroups.2" shape="rect"> </a>
    <div class="titlepage"> </div>
    <div class="refnamediv">
      <h2>Name</h2>
      <p>getgroups, setgroups — get/set list of supplementary
      group IDs</p>
    </div>
    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>
      <div class="funcsynopsis">
        <pre class="funcsynopsisinfo" xml:space="preserve">#include &lt;unistd.h&gt;</pre>
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>getgroups</strong>(</code></td>
            <td rowspan="1" colspan="1">int <var class="pdparam">size</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">gid_t <var class="pdparam">list[]</var><code>)</code>;</td>
          </tr>
        </table>
        <div class="funcprototype-spacer">
           
        </div>
      </div>
      <div class="funcsynopsis">
        <pre class="funcsynopsisinfo" xml:space="preserve">#include &lt;grp.h&gt;</pre>
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>setgroups</strong>(</code></td>
            <td rowspan="1" colspan="1">size_t <var class="pdparam">size</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">const gid_t *<var class="pdparam">list</var><code>)</code>;</td>
          </tr>
        </table>
        <div class="funcprototype-spacer">
           
        </div>
      </div>
      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Note">
          <tr>
            <td rowspan="2" align="center" valign="top" width="25" colspan="1">
            <img alt="[Note]" src="../stylesheet/note.png" /></td>
            <th align="left" rowspan="1" colspan="1">Note</th>
          </tr>
          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">
              <div class="featuretests">
                <table class="featuretests" style="border-collapse: collapse;">
                  <colgroup span="1">
                    <col span="1" />
                  </colgroup>
                  <thead>
                    <tr>
                      <th style="" rowspan="1" colspan="1">Feature Test Macro Requirements
                      for glibc (see <a class="link" href="../htmlman7/feature_test_macros.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">feature_test_macros</span>(7)</span></a>):</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td style="" rowspan="1" colspan="1"><code class="function">setgroups</code>():</td>
                    </tr>
                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">Since
                      glibc 2.19:</td>
                    </tr>
                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">
                      <code class="constant">_DEFAULT_SOURCE</code>
                      Glibc 2.19 and earlier:</td>
                    </tr>
                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">
                      <code class="constant">_BSD_SOURCE</code></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </td>
          </tr>
        </table>
      </div>
    </div>
    <div class="refsect1">
      <a id="getgroups-2_sect1" name="getgroups-2_sect1" shape="rect"> </a>
      <h2>DESCRIPTION</h2>
      <p><code class="function">getgroups</code>() returns the
      supplementary group IDs of the calling process in <em class="parameter"><code>list</code></em>. The argument <em class="parameter"><code>size</code></em> should be set to the
      maximum number of items that can be stored in the buffer
      pointed to by <em class="parameter"><code>list</code></em>.
      If the calling process is a member of more than <em class="parameter"><code>size</code></em> supplementary groups, then
      an error results.</p>
      <p>It is unspecified whether the effective group ID of the
      calling process is included in the returned list. (Thus, an
      application should also call <a class="link" href="../htmlman2/getgid.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getegid</span>(2)</span></a> and add or
      remove the resulting value.)</p>
      <p>If <em class="parameter"><code>size</code></em> is zero,
      <em class="parameter"><code>list</code></em> is not modified,
      but the total number of supplementary group IDs for the
      process is returned. This allows the caller to determine the
      size of a dynamically allocated <em class="parameter"><code>list</code></em> to be used in a further
      call to <code class="function">getgroups</code>().</p>
      <p><code class="function">setgroups</code>() sets the
      supplementary group IDs for the calling process. Appropriate
      privileges are required (see the description of the
      <span class="errorname">EPERM</span> error, below). The
      <em class="parameter"><code>size</code></em> argument
      specifies the number of supplementary group IDs in the buffer
      pointed to by <em class="parameter"><code>list</code></em>. A
      process can drop all of its supplementary groups with the
      call:</p>
      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="informalexample">
            <pre class="programlisting" xml:space="preserve">
setgroups(0, NULL);
</pre>
          </div>
        </blockquote>
      </div>
    </div>
    <div class="refsect1">
      <a id="getgroups-2_sect2" name="getgroups-2_sect2" shape="rect"> </a>
      <h2>RETURN VALUE</h2>
      <p>On success, <code class="function">getgroups</code>()
      returns the number of supplementary group IDs. On error,
      −1 is returned, and <code class="varname">errno</code>
      is set to indicate the error.</p>
      <p>On success, <code class="function">setgroups</code>()
      returns 0. On error, −1 is returned, and <code class="varname">errno</code> is set to indicate the error.</p>
    </div>
    <div class="refsect1">
      <a id="getgroups-2_sect3" name="getgroups-2_sect3" shape="rect"> </a>
      <h2>ERRORS</h2>
      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><span class="errorname">EFAULT</span></span></dt>
          <dd>
            <p><em class="parameter"><code>list</code></em> has an
            invalid address.</p>
          </dd>
        </dl>
      </div>
      <p><code class="function">getgroups</code>() can additionally
      fail with the following error:</p>
      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><span class="errorname">EINVAL</span></span></dt>
          <dd>
            <p><em class="parameter"><code>size</code></em> is less
            than the number of supplementary group IDs, but is not
            zero.</p>
          </dd>
        </dl>
      </div>
      <p><code class="function">setgroups</code>() can additionally
      fail with the following errors:</p>
      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><span class="errorname">EINVAL</span></span></dt>
          <dd>
            <p><em class="parameter"><code>size</code></em> is
            greater than <code class="constant">NGROUPS_MAX</code>
            (32 before Linux 2.6.4; 65536 since Linux 2.6.4).</p>
          </dd>
          <dt><span class="term"><span class="errorname">ENOMEM</span></span></dt>
          <dd>
            <p>Out of memory.</p>
          </dd>
          <dt><span class="term"><span class="errorname">EPERM</span></span></dt>
          <dd>
            <p>The calling process has insufficient privilege (the
            caller does not have the <code class="constant">CAP_SETGID</code> capability in the user
            namespace in which it resides).</p>
          </dd>
          <dt><span class="term"><span class="errorname">EPERM</span> (since Linux 3.19)</span></dt>
          <dd>
            <p>The use of <code class="function">setgroups</code>()
            is denied in this user namespace. See the description
            of <code class="filename">/proc/[pid]/setgroups</code>
            in <a class="link" href="../htmlman7/user_namespaces.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">user_namespaces</span>(7)</span></a>.</p>
          </dd>
        </dl>
      </div>
    </div>
    <div class="refsect1">
      <a id="getgroups-2_sect4" name="getgroups-2_sect4" shape="rect"> </a>
      <h2>CONFORMING TO</h2>
      <p><code class="function">getgroups</code>(): SVr4, 4.3BSD,
      POSIX.1-2001, POSIX.1-2008.</p>
      <p><code class="function">setgroups</code>(): SVr4, 4.3BSD.
      Since <code class="function">setgroups</code>() requires
      privilege, it is not covered by POSIX.1.</p>
    </div>
    <div class="refsect1">
      <a id="getgroups-2_sect5" name="getgroups-2_sect5" shape="rect"> </a>
      <h2>NOTES</h2>
      <p>A process can have up to <code class="constant">NGROUPS_MAX</code> supplementary group IDs in
      addition to the effective group ID. The constant <code class="constant">NGROUPS_MAX</code> is defined in <code class="literal">&lt;</code><code class="filename">limits.h</code><code class="literal">&gt;</code>
      The set of supplementary group IDs is inherited from the
      parent process, and preserved across an <a class="link" href="../htmlman2/execve.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">execve</span>(2)</span></a>.</p>
      <p>The maximum number of supplementary group IDs can be found
      at run time using <a class="link" href="../htmlman3/sysconf.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">sysconf</span>(3)</span></a>:</p>
      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="informalexample">
            <pre class="programlisting" xml:space="preserve">
long ngroups_max;
ngroups_max = sysconf(_SC_NGROUPS_MAX);
</pre>
          </div>
        </blockquote>
      </div>
      <p>The maximum return value of <code class="function">getgroups</code>() cannot be larger than one more
      than this value. Since Linux 2.6.4, the maximum number of
      supplementary group IDs is also exposed via the
      Linux-specific read-only file, <code class="filename">/proc/sys/kernel/ngroups_max</code>.</p>
      <p>The original Linux <code class="function">getgroups</code>() system call supported only
      16-bit group IDs. Subsequently, Linux 2.4 added <code class="function">getgroups32</code>(), supporting 32-bit IDs. The
      glibc <code class="function">getgroups</code>() wrapper
      function transparently deals with the variation across kernel
      versions.</p>
      <div class="refsect2">
        <a id="getgroups-2_sect6" name="getgroups-2_sect6" shape="rect"> </a>
        <h3>C library/kernel differences</h3>
        <p>At the kernel level, user IDs and group IDs are a
        per-thread attribute. However, POSIX requires that all
        threads in a process share the same credentials. The NPTL
        threading implementation handles the POSIX requirements by
        providing wrapper functions for the various system calls
        that change process UIDs and GIDs. These wrapper functions
        (including the one for <code class="function">setgroups</code>()) employ a signal-based
        technique to ensure that when one thread changes
        credentials, all of the other threads in the process also
        change their credentials. For details, see <a class="link" href="../htmlman7/nptl.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">nptl</span>(7)</span></a>.</p>
      </div>
    </div>
    <div class="refsect1">
      <a id="getgroups-2_sect7" name="getgroups-2_sect7" shape="rect"> </a>
      <h2>SEE ALSO</h2>
      <p><a class="link" href="../htmlman2/getgid.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getgid</span>(2)</span></a>, <a class="link" href="../htmlman2/setgid.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">setgid</span>(2)</span></a>, <a class="link" href="../htmlman3/getgrouplist.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getgrouplist</span>(3)</span></a>, <a class="link" href="../htmlman3/group_member.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">group_member</span>(3)</span></a>, <a class="link" href="../htmlman3/initgroups.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">initgroups</span>(3)</span></a>, <a class="link" href="../htmlman7/capabilities.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">capabilities</span>(7)</span></a>, <a class="link" href="../htmlman7/credentials.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">credentials</span>(7)</span></a></p>
    </div>
    <div class="colophon">
      <a id="getgroups-2_sect8" name="getgroups-2_sect8" shape="rect"> </a>
      <h2>COLOPHON</h2>
      <p>This page is part of release 5.11 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      https://www.kernel.org/doc/man−pages/.</p>
      <div class="license">
        <table class="license" style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>
          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    Copyright 1993 Rickard E. Faith (faith<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cs.unc.edu)<br />

                  and Copyright (C) 2008, 2010, 2015, Michael Kerrisk &lt;mtk.manpages<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>gmail.com&gt;<br />

                  <br />
                  %%%LICENSE_START(VERBATIM)<br />
                  Permission is granted to make and distribute verbatim copies of this<br />

                  manual provided the copyright notice and this permission notice are<br />

                  preserved on all copies.<br />
                  <br />
                  Permission is granted to copy and distribute modified versions of this<br />

                  manual under the conditions for verbatim copying, provided that the<br />

                  entire resulting derived work is distributed under the terms of a<br />

                  permission notice identical to this one.<br />

                  <br />
                  Since the Linux kernel and libraries are constantly changing, this<br />

                  manual page may be incorrect or out-of-date.  The author(s) assume no<br />

                  responsibility for errors or omissions, or for damages resulting from<br />

                  the use of the information contained herein.  The author(s) may not<br />

                  have taken the same level of care in the production of this manual,<br />

                  which is licensed free of charge, as they might when working<br />

                  professionally.<br />
                  <br />
                  Formatted or processed versions of this manual, if unaccompanied by<br />

                  the source, must acknowledge the copyright and authors of this work.<br />

                  %%%LICENSE_END<br />
                  <br />
                  Modified Thu Oct 31 12:04:29 1996 by Eric S. Raymond &lt;esr<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>thyrsus.com&gt;<br />

                  Modified, 27 May 2004, Michael Kerrisk &lt;mtk.manpages<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>gmail.com&gt;<br />

                      Added notes on capability requirements<br />

                  2008-05-03, mtk, expanded and rewrote parts of DESCRIPTION and RETURN<br />

                      VALUE, made style of page more consistent with man-pages style.<br />
                  
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
