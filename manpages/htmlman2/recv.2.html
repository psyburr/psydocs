<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>recv(2) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="recv(2) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve"> </script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>
<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>
          <th rowspan="1" colspan="1"><a href="../index2.html" shape="rect">Section 2</a></th>
          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>
  <div class="refentry">
    <a id="recv.2" name="recv.2" shape="rect"> </a>
    <div class="titlepage"> </div>
    <div class="refnamediv">
      <h2>Name</h2>
      <p>recv, recvfrom, recvmsg — receive a message from a
      socket</p>
    </div>
    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>
      <div class="funcsynopsis">
        <pre class="funcsynopsisinfo" xml:space="preserve">#include &lt;sys/socket.h&gt;</pre>
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">ssize_t
            <strong>recv</strong>(</code></td>
            <td rowspan="1" colspan="1">int <var class="pdparam">sockfd</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">void *<var class="pdparam">buf</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">size_t <var class="pdparam">len</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">int <var class="pdparam">flags</var><code>)</code>;</td>
          </tr>
        </table>
        <div class="funcprototype-spacer">
           
        </div>
      </div>
      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">ssize_t
            <strong>recvfrom</strong>(</code></td>
            <td rowspan="1" colspan="1">int <var class="pdparam">sockfd</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">void *restrict <var class="pdparam">buf</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">size_t <var class="pdparam">len</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">int <var class="pdparam">flags</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">struct sockaddr *restrict <var class="pdparam">src_addr</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">socklen_t *restrict <var class="pdparam">addrlen</var><code>)</code>;</td>
          </tr>
        </table>
        <div class="funcprototype-spacer">
           
        </div>
      </div>
      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">ssize_t
            <strong>recvmsg</strong>(</code></td>
            <td rowspan="1" colspan="1">int <var class="pdparam">sockfd</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">struct msghdr *<var class="pdparam">msg</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">int <var class="pdparam">flags</var><code>)</code>;</td>
          </tr>
        </table>
        <div class="funcprototype-spacer">
           
        </div>
      </div>
    </div>
    <div class="refsect1">
      <a id="recv-2_sect1" name="recv-2_sect1" shape="rect"> </a>
      <h2>DESCRIPTION</h2>
      <p>The <code class="function">recv</code>(), <code class="function">recvfrom</code>(), and <code class="function">recvmsg</code>() calls are used to receive
      messages from a socket. They may be used to receive data on
      both connectionless and connection-oriented sockets. This
      page first describes common features of all three system
      calls, and then describes the differences between the
      calls.</p>
      <p>The only difference between <code class="function">recv</code>() and <a class="link" href="../htmlman2/read.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">read</span>(2)</span></a> is the presence of
      <em class="parameter"><code>flags</code></em>. With a zero
      <em class="parameter"><code>flags</code></em> argument,
      <code class="function">recv</code>() is generally equivalent
      to <a class="link" href="../htmlman2/read.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">read</span>(2)</span></a> (but see NOTES).
      Also, the following call</p>
      <p>recv(sockfd, buf, len, flags);</p>
      <p>is equivalent to</p>
      <p>recvfrom(sockfd, buf, len, flags, NULL, NULL);</p>
      <p>All three calls return the length of the message on
      successful completion. If a message is too long to fit in the
      supplied buffer, excess bytes may be discarded depending on
      the type of socket the message is received from.</p>
      <p>If no messages are available at the socket, the receive
      calls wait for a message to arrive, unless the socket is
      nonblocking (see <a class="link" href="../htmlman2/fcntl.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">fcntl</span>(2)</span></a>), in which case
      the value −1 is returned and <code class="varname">errno</code> is set to <span class="errorname">EAGAIN</span> or <span class="errorname">EWOULDBLOCK</span>. The receive calls normally
      return any data available, up to the requested amount, rather
      than waiting for receipt of the full amount requested.</p>
      <p>An application can use <a class="link" href="../htmlman2/select.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">select</span>(2)</span></a>, <a class="link" href="../htmlman2/poll.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">poll</span>(2)</span></a>, or <a class="link" href="../htmlman7/epoll.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">epoll</span>(7)</span></a> to determine when
      more data arrives on a socket.</p>
      <div class="refsect2">
        <a id="recv-2_sect2" name="recv-2_sect2" shape="rect"> </a>
        <h3>The flags argument</h3>
        <p>The <em class="parameter"><code>flags</code></em>
        argument is formed by ORing one or more of the following
        values:</p>
        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><code class="function">MSG_CMSG_CLOEXEC (recvmsg</code>() only;
            since Linux 2.6.23)</span></dt>
            <dd>
              <p>Set the close-on-exec flag for the file descriptor
              received via a UNIX domain file descriptor using the
              <code class="constant">SCM_RIGHTS</code> operation
              (described in <a class="link" href="../htmlman7/unix.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">unix</span>(7)</span></a>). This flag
              is useful for the same reasons as the <code class="constant">O_CLOEXEC</code> flag of <a class="link" href="../htmlman2/open.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">open</span>(2)</span></a>.</p>
            </dd>
            <dt><span class="term"><code class="constant">MSG_DONTWAIT</code> (since Linux
            2.2)</span></dt>
            <dd>
              <p>Enables nonblocking operation; if the operation
              would block, the call fails with the error
              <span class="errorname">EAGAIN</span> or <span class="errorname">EWOULDBLOCK</span>. This provides similar
              behavior to setting the <code class="constant">O_NONBLOCK</code> flag (via the <a class="link" href="../htmlman2/fcntl.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">fcntl</span>(2)</span></a>
              <code class="constant">F_SETFL</code> operation), but
              differs in that <code class="constant">MSG_DONTWAIT</code> is a per-call option,
              whereas <code class="constant">O_NONBLOCK</code> is a
              setting on the open file description (see <a class="link" href="../htmlman2/open.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">open</span>(2)</span></a>), which
              will affect all threads in the calling process and as
              well as other processes that hold file descriptors
              referring to the same open file description.</p>
            </dd>
            <dt><span class="term"><code class="constant">MSG_ERRQUEUE</code> (since Linux
            2.2)</span></dt>
            <dd>
              <p>This flag specifies that queued errors should be
              received from the socket error queue. The error is
              passed in an ancillary message with a type dependent
              on the protocol (for IPv4 <code class="constant">IP_RECVERR</code>). The user should supply
              a buffer of sufficient size. See <a class="link" href="../htmlman3/cmsg.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">cmsg</span>(3)</span></a> and
              <a class="link" href="../htmlman7/ip.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">ip</span>(7)</span></a> for more
              information. The payload of the original packet that
              caused the error is passed as normal data via
              <em class="replaceable"><code>msg_iovec</code></em>.
              The original destination address of the datagram that
              caused the error is supplied via <em class="replaceable"><code>msg_name</code></em>.</p>
              <p>The error is supplied in a <em class="replaceable"><code>sock_extended_err</code></em>
              structure:</p>
              <div class="blockquote">
                <blockquote class="blockquote">
                  <div class="informalexample">
                    <pre class="programlisting" xml:space="preserve">
#define SO_EE_ORIGIN_NONE    0
#define SO_EE_ORIGIN_LOCAL   1
#define SO_EE_ORIGIN_ICMP    2
#define SO_EE_ORIGIN_ICMP6   3

struct sock_extended_err
{
    uint32_t ee_errno;   /* Error number */
    uint8_t  ee_origin;  /* Where the error originated */
    uint8_t  ee_type;    /* Type */
    uint8_t  ee_code;    /* Code */
    uint8_t  ee_pad;     /* Padding */
    uint32_t ee_info;    /* Additional information */
    uint32_t ee_data;    /* Other data */
    /* More data may follow */
};

struct sockaddr *SO_EE_OFFENDER(struct sock_extended_err *);
</pre>
                  </div>
                </blockquote>
              </div>
              <p><em class="replaceable"><code>ee_errno</code></em>
              contains the <code class="varname">errno</code>
              number of the queued error. <em class="replaceable"><code>ee_origin</code></em> is the
              origin code of where the error originated. The other
              fields are protocol-specific. The macro <code class="constant">SOCK_EE_OFFENDER</code> returns a pointer
              to the address of the network object where the error
              originated from given a pointer to the ancillary
              message. If this address is not known, the <em class="replaceable"><code>sa_family</code></em> member of
              the <span class="structname">sockaddr</span> contains
              <code class="constant">AF_UNSPEC</code> and the other
              fields of the <span class="structname">sockaddr</span> are undefined. The
              payload of the packet that caused the error is passed
              as normal data.</p>
              <p>For local errors, no address is passed (this can
              be checked with the <em class="replaceable"><code>cmsg_len</code></em> member of
              the <em class="replaceable"><code>cmsghdr</code></em>). For error
              receives, the <code class="constant">MSG_ERRQUEUE</code> flag is set in the
              <span class="structname">msghdr</span>. After an
              error has been passed, the pending socket error is
              regenerated based on the next queued error and will
              be passed on the next socket operation.</p>
            </dd>
            <dt><span class="term"><code class="constant">MSG_OOB</code></span></dt>
            <dd>
              <p>This flag requests receipt of out-of-band data
              that would not be received in the normal data stream.
              Some protocols place expedited data at the head of
              the normal data queue, and thus this flag cannot be
              used with such protocols.</p>
            </dd>
            <dt><span class="term"><code class="constant">MSG_PEEK</code></span></dt>
            <dd>
              <p>This flag causes the receive operation to return
              data from the beginning of the receive queue without
              removing that data from the queue. Thus, a subsequent
              receive call will return the same data.</p>
            </dd>
            <dt><span class="term"><code class="constant">MSG_TRUNC</code> (since Linux
            2.2)</span></dt>
            <dd>
              <p>For raw (<code class="constant">AF_PACKET</code>),
              Internet datagram (since Linux 2.4.27/2.6.8), netlink
              (since Linux 2.6.22), and UNIX datagram (since Linux
              3.4) sockets: return the real length of the packet or
              datagram, even when it was longer than the passed
              buffer.</p>
              <p>For use with Internet stream sockets, see
              <a class="link" href="../htmlman7/tcp.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">tcp</span>(7)</span></a>.</p>
            </dd>
            <dt><span class="term"><code class="constant">MSG_WAITALL</code> (since Linux
            2.2)</span></dt>
            <dd>
              <p>This flag requests that the operation block until
              the full request is satisfied. However, the call may
              still return less data than requested if a signal is
              caught, an error or disconnect occurs, or the next
              data to be received is of a different type than that
              returned. This flag has no effect for datagram
              sockets.</p>
            </dd>
          </dl>
        </div>
      </div>
      <div class="refsect2">
        <a id="recv-2_sect3" name="recv-2_sect3" shape="rect"> </a>
        <h3>recvfrom()</h3>
        <p><code class="function">recvfrom</code>() places the
        received message into the buffer <em class="parameter"><code>buf</code></em>. The caller must specify
        the size of the buffer in <em class="parameter"><code>len</code></em>.</p>
        <p>If <em class="parameter"><code>src_addr</code></em> is
        not NULL, and the underlying protocol provides the source
        address of the message, that source address is placed in
        the buffer pointed to by <em class="parameter"><code>src_addr</code></em>. In this case,
        <em class="parameter"><code>addrlen</code></em> is a
        value-result argument. Before the call, it should be
        initialized to the size of the buffer associated with
        <em class="parameter"><code>src_addr</code></em>. Upon
        return, <em class="parameter"><code>addrlen</code></em> is
        updated to contain the actual size of the source address.
        The returned address is truncated if the buffer provided is
        too small; in this case, <em class="parameter"><code>addrlen</code></em> will return a value
        greater than was supplied to the call.</p>
        <p>If the caller is not interested in the source address,
        <em class="parameter"><code>src_addr</code></em> and
        <em class="parameter"><code>addrlen</code></em> should be
        specified as NULL.</p>
      </div>
      <div class="refsect2">
        <a id="recv-2_sect4" name="recv-2_sect4" shape="rect"> </a>
        <h3>recv()</h3>
        <p>The <code class="function">recv</code>() call is
        normally used only on a <em class="replaceable"><code>connected</code></em> socket (see
        <a class="link" href="../htmlman2/connect.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">connect</span>(2)</span></a>). It is
        equivalent to the call:</p>
        <p>recvfrom(fd, buf, len, flags, NULL, 0);</p>
      </div>
      <div class="refsect2">
        <a id="recv-2_sect5" name="recv-2_sect5" shape="rect"> </a>
        <h3>recvmsg()</h3>
        <p>The <code class="function">recvmsg</code>() call uses a
        <span class="structname">msghdr</span> structure to
        minimize the number of directly supplied arguments. This
        structure is defined as follows in <code class="literal">&lt;</code><code class="filename">sys/socket.h</code><code class="literal">&gt;</code></p>
        <div class="blockquote">
          <blockquote class="blockquote">
            <div class="structdef">
              <table class="structdef" style="border-collapse: collapse;">
                <colgroup span="1">
                  <col class="c1" span="1" />
                  <col class="c2" span="1" />
                  <col class="c3" span="1" />
                  <col class="c4" span="1" />
                  <col class="c5" span="1" />
                </colgroup>
                <tbody>
                  <tr>
                    <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">
                    struct</td>
                    <td class="structdefhdr" style="" colspan="3" align="left" rowspan="1"><span class="structname">iovec</span> {</td>
                    <td class="structdefhdrcomment" style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        
                        /* Scatter/gather array items */
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>
                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">void</span></td>
                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                    *</td>
                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>iov_base</code></em>;</td>
                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        
                        /* Starting address */
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>
                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">size_t</span></td>
                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                     </td>
                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>iov_len</code></em>;</td>
                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        
                        /* Number of bytes to transfer */
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">};</td>
                  </tr>
                  <tr>
                    <td class="structsep" style="" colspan="5" align="left" rowspan="1"></td>
                  </tr>
                  <tr>
                    <td class="structdefhdr2" style="" align="left" rowspan="1" colspan="1">struct</td>
                    <td class="structdefhdr2" style="" colspan="4" align="left" rowspan="1"><span class="structname">msghdr</span> {</td>
                  </tr>
                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>
                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">void</span></td>
                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                    *</td>
                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>msg_name</code></em>;</td>
                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        
                        /* Optional address */
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>
                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">socklen_t</span></td>
                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                     </td>
                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>msg_namelen</code></em>;</td>
                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        
                        /* Size of address */
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>
                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">struct iovec</span></td>
                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                    *</td>
                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>msg_iov</code></em>;</td>
                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        
                        /* Scatter/gather array */
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>
                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">size_t</span></td>
                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                     </td>
                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>msg_iovlen</code></em>;</td>
                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        
                        /* # elements in msg_iov */
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>
                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">void</span></td>
                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                    *</td>
                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>msg_control</code></em>;</td>
                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        
                        /* Ancillary data, see below */
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>
                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">size_t</span></td>
                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                     </td>
                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>msg_controllen</code></em>;</td>
                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        
                        /* Ancillary data buffer len */
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>
                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>
                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                     </td>
                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>msg_flags</code></em>;</td>
                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        
                        /* Flags on received message */
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">};</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </blockquote>
        </div>
        <p>The <em class="parameter"><code>msg_name</code></em>
        field points to a caller-allocated buffer that is used to
        return the source address if the socket is unconnected. The
        caller should set <em class="parameter"><code>msg_namelen</code></em> to the size of
        this buffer before this call; upon return from a successful
        call, <em class="parameter"><code>msg_namelen</code></em>
        will contain the length of the returned address. If the
        application does not need to know the source address,
        <em class="parameter"><code>msg_name</code></em> can be
        specified as NULL.</p>
        <p>The fields <em class="parameter"><code>msg_iov</code></em> and <em class="parameter"><code>msg_iovlen</code></em> describe
        scatter-gather locations, as discussed in <a class="link" href="../htmlman2/readv.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">readv</span>(2)</span></a>.</p>
        <p>The field <em class="parameter"><code>msg_control</code></em>, which has length
        <em class="parameter"><code>msg_controllen</code></em>,
        points to a buffer for other protocol control-related
        messages or miscellaneous ancillary data. When <code class="function">recvmsg</code>() is called, <em class="parameter"><code>msg_controllen</code></em> should contain
        the length of the available buffer in <em class="parameter"><code>msg_control</code></em>; upon return from
        a successful call it will contain the length of the control
        message sequence.</p>
        <p>The messages are of the form:</p>
        <div class="blockquote">
          <blockquote class="blockquote">
            <div class="structdef">
              <table class="structdef" style="border-collapse: collapse;">
                <colgroup span="1">
                  <col class="c1" span="1" />
                  <col class="c2" span="1" />
                  <col class="c3" span="1" />
                  <col class="c4" span="1" />
                  <col class="c5" span="1" />
                </colgroup>
                <tbody>
                  <tr>
                    <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">
                    struct</td>
                    <td class="structdefhdr" style="" colspan="4" align="left" rowspan="1"><span class="structname">cmsghdr</span> {</td>
                  </tr>
                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>
                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">size_t</span></td>
                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                     </td>
                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>cmsg_len</code></em>;</td>
                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        
                        /* Data byte count, including header<br />

                        (type is socklen_t in POSIX) */
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>
                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>
                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                     </td>
                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>cmsg_level</code></em>;</td>
                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        
                        /* Originating protocol */
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td style="" rowspan="1" colspan="1"> </td>
                    <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>
                    <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                     </td>
                    <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>cmsg_type</code></em>;</td>
                    <td style="" align="left" rowspan="1" colspan="1">
                      <div class="literallayout">
                        
                        /* Protocol\-specific type */
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td style="" colspan="5" align="left" rowspan="1">
                      <div class="literallayout">
                        /* followed by<br />
                        unsigned char cmsg_data[]; */
                      </div>
                    </td>
                  </tr>
                  <tr>
                    <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">};</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </blockquote>
        </div>
        <p>Ancillary data should be accessed only by the macros
        defined in <a class="link" href="../htmlman3/cmsg.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">cmsg</span>(3)</span></a>.</p>
        <p>As an example, Linux uses this ancillary data mechanism
        to pass extended errors, IP options, or file descriptors
        over UNIX domain sockets. For further information on the
        use of ancillary data in various socket domains, see
        <a class="link" href="../htmlman7/unix.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">unix</span>(7)</span></a> and <a class="link" href="../htmlman7/ip.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">ip</span>(7)</span></a>.</p>
        <p>The <em class="parameter"><code>msg_flags</code></em>
        field in the <span class="structname">msghdr</span> is set
        on return of <code class="function">recvmsg</code>(). It
        can contain several flags:</p>
        <div class="variablelist">
          <dl class="variablelist">
            <dt><span class="term"><code class="constant">MSG_EOR</code></span></dt>
            <dd>
              <p>indicates end-of-record; the data returned
              completed a record (generally used with sockets of
              type <code class="constant">SOCK_SEQPACKET</code>).</p>
            </dd>
            <dt><span class="term"><code class="constant">MSG_TRUNC</code></span></dt>
            <dd>
              <p>indicates that the trailing portion of a datagram
              was discarded because the datagram was larger than
              the buffer supplied.</p>
            </dd>
            <dt><span class="term"><code class="constant">MSG_CTRUNC</code></span></dt>
            <dd>
              <p>indicates that some control data was discarded due
              to lack of space in the buffer for ancillary
              data.</p>
            </dd>
            <dt><span class="term"><code class="constant">MSG_OOB</code></span></dt>
            <dd>
              <p>is returned to indicate that expedited or
              out-of-band data was received.</p>
            </dd>
            <dt><span class="term"><code class="constant">MSG_ERRQUEUE</code></span></dt>
            <dd>
              <p>indicates that no data was received but an
              extended error from the socket error queue.</p>
            </dd>
          </dl>
        </div>
      </div>
    </div>
    <div class="refsect1">
      <a id="recv-2_sect6" name="recv-2_sect6" shape="rect"> </a>
      <h2>RETURN VALUE</h2>
      <p>These calls return the number of bytes received, or
      −1 if an error occurred. In the event of an error,
      <code class="varname">errno</code> is set to indicate the
      error.</p>
      <p>When a stream socket peer has performed an orderly
      shutdown, the return value will be 0 (the traditional
      "end-of-file" return).</p>
      <p>Datagram sockets in various domains (e.g., the UNIX and
      Internet domains) permit zero-length datagrams. When such a
      datagram is received, the return value is 0.</p>
      <p>The value 0 may also be returned if the requested number
      of bytes to receive from a stream socket was 0.</p>
    </div>
    <div class="refsect1">
      <a id="recv-2_sect7" name="recv-2_sect7" shape="rect"> </a>
      <h2>ERRORS</h2>
      <p>These are some standard errors generated by the socket
      layer. Additional errors may be generated and returned from
      the underlying protocol modules; see their manual pages.</p>
      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><span class="errorname">EAGAIN</span> or <span class="errorname">EWOULDBLOCK</span></span></dt>
          <dd>
            <p>The socket is marked nonblocking and the receive
            operation would block, or a receive timeout had been
            set and the timeout expired before data was received.
            POSIX.1 allows either error to be returned for this
            case, and does not require these constants to have the
            same value, so a portable application should check for
            both possibilities.</p>
          </dd>
          <dt><span class="term"><span class="errorname">EBADF</span></span></dt>
          <dd>
            <p>The argument <em class="parameter"><code>sockfd</code></em> is an invalid file
            descriptor.</p>
          </dd>
          <dt><span class="term"><span class="errorname">ECONNREFUSED</span></span></dt>
          <dd>
            <p>A remote host refused to allow the network
            connection (typically because it is not running the
            requested service).</p>
          </dd>
          <dt><span class="term"><span class="errorname">EFAULT</span></span></dt>
          <dd>
            <p>The receive buffer pointer(s) point outside the
            process's address space.</p>
          </dd>
          <dt><span class="term"><span class="errorname">EINTR</span></span></dt>
          <dd>
            <p>The receive was interrupted by delivery of a signal
            before any data was available; see <a class="link" href="../htmlman7/signal.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">signal</span>(7)</span></a>.</p>
          </dd>
          <dt><span class="term"><span class="errorname">EINVAL</span></span></dt>
          <dd>
            <p>Invalid argument passed.</p>
          </dd>
          <dt><span class="term"><span class="errorname">ENOMEM</span></span></dt>
          <dd>
            <p>Could not allocate memory for <code class="function">recvmsg</code>().</p>
          </dd>
          <dt><span class="term"><span class="errorname">ENOTCONN</span></span></dt>
          <dd>
            <p>The socket is associated with a connection-oriented
            protocol and has not been connected (see <a class="link" href="../htmlman2/connect.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">connect</span>(2)</span></a> and
            <a class="link" href="../htmlman2/accept.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">accept</span>(2)</span></a>).</p>
          </dd>
          <dt><span class="term"><span class="errorname">ENOTSOCK</span></span></dt>
          <dd>
            <p>The file descriptor <em class="parameter"><code>sockfd</code></em> does not refer to
            a socket.</p>
          </dd>
        </dl>
      </div>
    </div>
    <div class="refsect1">
      <a id="recv-2_sect8" name="recv-2_sect8" shape="rect"> </a>
      <h2>CONFORMING TO</h2>
      <p>POSIX.1-2001, POSIX.1-2008, 4.4BSD (these interfaces first
      appeared in 4.2BSD).</p>
      <p>POSIX.1 describes only the <code class="constant">MSG_OOB</code>, <code class="constant">MSG_PEEK</code>, and <code class="constant">MSG_WAITALL</code> flags.</p>
    </div>
    <div class="refsect1">
      <a id="recv-2_sect9" name="recv-2_sect9" shape="rect"> </a>
      <h2>NOTES</h2>
      <p>If a zero-length datagram is pending, <a class="link" href="../htmlman2/read.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">read</span>(2)</span></a> and <code class="function">recv</code>() with a <em class="parameter"><code>flags</code></em> argument of zero provide
      different behavior. In this circumstance, <a class="link" href="../htmlman2/read.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">read</span>(2)</span></a> has no effect (the
      datagram remains pending), while <code class="function">recv</code>() consumes the pending datagram.</p>
      <p>The <span class="type">socklen_t</span> type was invented
      by POSIX. See also <a class="link" href="../htmlman2/accept.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">accept</span>(2)</span></a>.</p>
      <p>According to POSIX.1, the <em class="parameter"><code>msg_controllen</code></em> field of the
      <span class="structname">msghdr</span> structure should be
      typed as <span class="type">socklen_t</span>, and the
      <em class="parameter"><code>msg_iovlen</code></em> field
      should be typed as <span class="type">int</span>, but glibc
      currently types both as <span class="type">size_t</span>.</p>
      <p>See <a class="link" href="../htmlman2/recvmmsg.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">recvmmsg</span>(2)</span></a> for information
      about a Linux-specific system call that can be used to
      receive multiple datagrams in a single call.</p>
    </div>
    <div class="refsect1">
      <a id="recv-2_sect10" name="recv-2_sect10" shape="rect"> </a>
      <h2>EXAMPLES</h2>
      <p>An example of the use of <code class="function">recvfrom</code>() is shown in <a class="link" href="../htmlman3/getaddrinfo.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getaddrinfo</span>(3)</span></a>.</p>
    </div>
    <div class="refsect1">
      <a id="recv-2_sect11" name="recv-2_sect11" shape="rect"> </a>
      <h2>SEE ALSO</h2>
      <p><a class="link" href="../htmlman2/fcntl.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">fcntl</span>(2)</span></a>, <a class="link" href="../htmlman2/getsockopt.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getsockopt</span>(2)</span></a>, <a class="link" href="../htmlman2/read.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">read</span>(2)</span></a>, <a class="link" href="../htmlman2/recvmmsg.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">recvmmsg</span>(2)</span></a>, <a class="link" href="../htmlman2/select.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">select</span>(2)</span></a>, <a class="link" href="../htmlman2/shutdown.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">shutdown</span>(2)</span></a>, <a class="link" href="../htmlman2/socket.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">socket</span>(2)</span></a>, <a class="link" href="../htmlman3/cmsg.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">cmsg</span>(3)</span></a>, <a class="link" href="../htmlman3/sockatmark.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">sockatmark</span>(3)</span></a>, <a class="link" href="../htmlman7/ip.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">ip</span>(7)</span></a>, <a class="link" href="../htmlman7/ipv6.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">ipv6</span>(7)</span></a>, <a class="link" href="../htmlman7/socket.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">socket</span>(7)</span></a>, <a class="link" href="../htmlman7/tcp.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">tcp</span>(7)</span></a>, <a class="link" href="../htmlman7/udp.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">udp</span>(7)</span></a>, <a class="link" href="../htmlman7/unix.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">unix</span>(7)</span></a></p>
    </div>
    <div class="colophon">
      <a id="recv-2_sect12" name="recv-2_sect12" shape="rect"> </a>
      <h2>COLOPHON</h2>
      <p>This page is part of release 5.11 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      https://www.kernel.org/doc/man−pages/.</p>
      <div class="license">
        <table class="license" style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>
          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    Copyright (c) 1983, 1990, 1991 The Regents of the University of California.<br />

                  All rights reserved.<br />
                  <br />
                  %%%LICENSE_START(BSD_4_CLAUSE_UCB)<br />
                  Redistribution and use in source and binary forms, with or without<br />

                  modification, are permitted provided that the following conditions<br />

                  are met:<br />
                  1. Redistributions of source code must retain the above copyright<br />

                     notice, this list of conditions and the following disclaimer.<br />

                  2. Redistributions in binary form must reproduce the above copyright<br />

                     notice, this list of conditions and the following disclaimer in the<br />

                     documentation and/or other materials provided with the distribution.<br />

                  3. All advertising materials mentioning features or use of this software<br />

                     must display the following acknowledgement:<br />

                  This product includes software developed by the University of<br />

                  California, Berkeley and its contributors.<br />

                  4. Neither the name of the University nor the names of its contributors<br />

                     may be used to endorse or promote products derived from this software<br />

                     without specific prior written permission.<br />

                  <br />
                  THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND<br />

                  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE<br />

                  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE<br />

                  ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE<br />

                  FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL<br />

                  DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS<br />

                  OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)<br />

                  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT<br />

                  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY<br />

                  OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF<br />

                  SUCH DAMAGE.<br />
                  %%%LICENSE_END<br />
                  <br />
                      $Id: recv.2,v 1.3 1999/05/13 11:33:38 freitag Exp $<br />

                  <br />
                  Modified Sat Jul 24 00:22:20 1993 by Rik Faith &lt;faith<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cs.unc.edu&gt;<br />

                  Modified Tue Oct 22 17:45:19 1996 by Eric S. Raymond &lt;esr<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>thyrsus.com&gt;<br />

                  Modified 1998,1999 by Andi Kleen<br />

                  2001-06-19 corrected SO_EE_OFFENDER, bug report by James Hawtin<br />
                  
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
