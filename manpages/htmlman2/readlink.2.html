<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>readlink(2) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="readlink(2) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve"> </script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>
<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>
          <th rowspan="1" colspan="1"><a href="../index2.html" shape="rect">Section 2</a></th>
          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>
  <div class="refentry">
    <a id="readlink.2" name="readlink.2" shape="rect"> </a>
    <div class="titlepage"> </div>
    <div class="refnamediv">
      <h2>Name</h2>
      <p>readlink, readlinkat — read value of a symbolic
      link</p>
    </div>
    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>
      <div class="funcsynopsis">
        <pre class="funcsynopsisinfo" xml:space="preserve">#include &lt;unistd.h&gt;</pre>
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">ssize_t
            <strong>readlink</strong>(</code></td>
            <td rowspan="1" colspan="1">const char *restrict <var class="pdparam">pathname</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">char *restrict <var class="pdparam">buf</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">size_t <var class="pdparam">bufsiz</var><code>)</code>;</td>
          </tr>
        </table>
        <div class="funcprototype-spacer">
           
        </div>
      </div>
      <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">

#include &lt;fcntl.h&gt;            /* Definition of AT_* constants */
#include &lt;unistd.h&gt;</pre>
      </div>
      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">ssize_t
            <strong>readlinkat</strong>(</code></td>
            <td rowspan="1" colspan="1">int <var class="pdparam">dirfd</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">const char *restrict <var class="pdparam">pathname</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">char *restrict <var class="pdparam">buf</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">size_t <var class="pdparam">bufsiz</var><code>)</code>;</td>
          </tr>
        </table>
        <div class="funcprototype-spacer">
           
        </div>
      </div>
      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;">
        <table border="0" summary="Note">
          <tr>
            <td rowspan="2" align="center" valign="top" width="25" colspan="1">
            <img alt="[Note]" src="../stylesheet/note.png" /></td>
            <th align="left" rowspan="1" colspan="1">Note</th>
          </tr>
          <tr>
            <td align="left" valign="top" rowspan="1" colspan="1">
              <div class="featuretests">
                <table class="featuretests" style="border-collapse: collapse;">
                  <colgroup span="1">
                    <col span="1" />
                  </colgroup>
                  <thead>
                    <tr>
                      <th style="" rowspan="1" colspan="1">Feature Test Macro Requirements
                      for glibc (see <a class="link" href="../htmlman7/feature_test_macros.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">feature_test_macros</span>(7)</span></a>):</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td style="" rowspan="1" colspan="1"><code class="function">readlink</code>():</td>
                    </tr>
                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">
                      <code class="constant">_XOPEN_SOURCE</code>
                      &gt;= 500 || <code class="constant">_POSIX_C_SOURCE</code> &gt;=
                      200112L || /* Glibc &lt;= 2.19:</td>
                    </tr>
                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">*/
                      <code class="constant">_BSD_SOURCE</code></td>
                    </tr>
                    <tr>
                      <td style="" rowspan="1" colspan="1"><code class="function">readlinkat</code>():</td>
                    </tr>
                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">Since
                      glibc 2.10:</td>
                    </tr>
                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">
                      <code class="constant">_POSIX_C_SOURCE</code>
                      &gt;= 200809L Before glibc 2.10:</td>
                    </tr>
                    <tr>
                      <td class="featuretestdef" style="" rowspan="1" colspan="1">
                      <code class="constant">_ATFILE_SOURCE</code></td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </td>
          </tr>
        </table>
      </div>
    </div>
    <div class="refsect1">
      <a id="readlink-2_sect1" name="readlink-2_sect1" shape="rect"> </a>
      <h2>DESCRIPTION</h2>
      <p><code class="function">readlink</code>() places the
      contents of the symbolic link <em class="parameter"><code>pathname</code></em> in the buffer
      <em class="parameter"><code>buf</code></em>, which has size
      <em class="parameter"><code>bufsiz</code></em>. <code class="function">readlink</code>() does not append a terminating
      null byte to <em class="parameter"><code>buf</code></em>. It
      will (silently) truncate the contents (to a length of
      <em class="parameter"><code>bufsiz</code></em> characters),
      in case the buffer is too small to hold all of the
      contents.</p>
      <div class="refsect2">
        <a id="readlink-2_sect2" name="readlink-2_sect2" shape="rect"> </a>
        <h3>readlinkat()</h3>
        <p>The <code class="function">readlinkat</code>() system
        call operates in exactly the same way as <code class="function">readlink</code>(), except for the differences
        described here.</p>
        <p>If the pathname given in <em class="parameter"><code>pathname</code></em> is relative, then it
        is interpreted relative to the directory referred to by the
        file descriptor <em class="parameter"><code>dirfd</code></em> (rather than relative
        to the current working directory of the calling process, as
        is done by <code class="function">readlink</code>() for a
        relative pathname).</p>
        <p>If <em class="parameter"><code>pathname</code></em> is
        relative and <em class="parameter"><code>dirfd</code></em>
        is the special value <code class="constant">AT_FDCWD</code>, then <em class="parameter"><code>pathname</code></em> is interpreted
        relative to the current working directory of the calling
        process (like <code class="function">readlink</code>()).</p>
        <p>If <em class="parameter"><code>pathname</code></em> is
        absolute, then <em class="parameter"><code>dirfd</code></em> is ignored.</p>
        <p>Since Linux 2.6.39, <em class="parameter"><code>pathname</code></em> can be an empty
        string, in which case the call operates on the symbolic
        link referred to by <em class="parameter"><code>dirfd</code></em> (which should have been
        obtained using <a class="link" href="../htmlman2/open.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">open</span>(2)</span></a> with the
        <code class="constant">O_PATH</code> and <code class="constant">O_NOFOLLOW</code> flags).</p>
        <p>See <a class="link" href="../htmlman2/open.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">openat</span>(2)</span></a> for an
        explanation of the need for <code class="function">readlinkat</code>().</p>
      </div>
    </div>
    <div class="refsect1">
      <a id="readlink-2_sect3" name="readlink-2_sect3" shape="rect"> </a>
      <h2>RETURN VALUE</h2>
      <p>On success, these calls return the number of bytes placed
      in <em class="parameter"><code>buf</code></em>. (If the
      returned value equals <em class="parameter"><code>bufsiz</code></em>, then truncation may
      have occurred.) On error, −1 is returned and
      <code class="varname">errno</code> is set to indicate the
      error.</p>
    </div>
    <div class="refsect1">
      <a id="readlink-2_sect4" name="readlink-2_sect4" shape="rect"> </a>
      <h2>ERRORS</h2>
      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><span class="errorname">EACCES</span></span></dt>
          <dd>
            <p>Search permission is denied for a component of the
            path prefix. (See also <a class="link" href="../htmlman7/path_resolution.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">path_resolution</span>(7)</span></a>.)</p>
          </dd>
          <dt><span class="term"><span class="errorname">EFAULT</span></span></dt>
          <dd>
            <p><em class="parameter"><code>buf</code></em> extends
            outside the process's allocated address space.</p>
          </dd>
          <dt><span class="term"><span class="errorname">EINVAL</span></span></dt>
          <dd>
            <p><em class="parameter"><code>bufsiz</code></em> is
            not positive.</p>
          </dd>
          <dt><span class="term"><span class="errorname">EINVAL</span></span></dt>
          <dd>
            <p>The named file (i.e., the final filename component
            of <em class="parameter"><code>pathname</code></em>) is
            not a symbolic link.</p>
          </dd>
          <dt><span class="term"><span class="errorname">EIO</span></span></dt>
          <dd>
            <p>An I/O error occurred while reading from the
            filesystem.</p>
          </dd>
          <dt><span class="term"><span class="errorname">ELOOP</span></span></dt>
          <dd>
            <p>Too many symbolic links were encountered in
            translating the pathname.</p>
          </dd>
          <dt><span class="term"><span class="errorname">ENAMETOOLONG</span></span></dt>
          <dd>
            <p>A pathname, or a component of a pathname, was too
            long.</p>
          </dd>
          <dt><span class="term"><span class="errorname">ENOENT</span></span></dt>
          <dd>
            <p>The named file does not exist.</p>
          </dd>
          <dt><span class="term"><span class="errorname">ENOMEM</span></span></dt>
          <dd>
            <p>Insufficient kernel memory was available.</p>
          </dd>
          <dt><span class="term"><span class="errorname">ENOTDIR</span></span></dt>
          <dd>
            <p>A component of the path prefix is not a
            directory.</p>
          </dd>
        </dl>
      </div>
      <p>The following additional errors can occur for <code class="function">readlinkat</code>():</p>
      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><span class="errorname">EBADF</span></span></dt>
          <dd>
            <p><em class="parameter"><code>dirfd</code></em> is not
            a valid file descriptor.</p>
          </dd>
          <dt><span class="term"><span class="errorname">ENOTDIR</span></span></dt>
          <dd>
            <p><em class="parameter"><code>pathname</code></em> is
            relative and <em class="parameter"><code>dirfd</code></em> is a file
            descriptor referring to a file other than a
            directory.</p>
          </dd>
        </dl>
      </div>
    </div>
    <div class="refsect1">
      <a id="readlink-2_sect5" name="readlink-2_sect5" shape="rect"> </a>
      <h2>VERSIONS</h2>
      <p><code class="function">readlinkat</code>() was added to
      Linux in kernel 2.6.16; library support was added to glibc in
      version 2.4.</p>
    </div>
    <div class="refsect1">
      <a id="readlink-2_sect6" name="readlink-2_sect6" shape="rect"> </a>
      <h2>CONFORMING TO</h2>
      <p><code class="function">readlink</code>(): 4.4BSD
      (<code class="function">readlink</code>() first appeared in
      4.2BSD), POSIX.1-2001, POSIX.1-2008.</p>
      <p><code class="function">readlinkat</code>():
      POSIX.1-2008.</p>
    </div>
    <div class="refsect1">
      <a id="readlink-2_sect7" name="readlink-2_sect7" shape="rect"> </a>
      <h2>NOTES</h2>
      <p>In versions of glibc up to and including glibc 2.4, the
      return type of <code class="function">readlink</code>() was
      declared as <span class="type">int</span>. Nowadays, the
      return type is declared as <span class="type">ssize_t</span>,
      as (newly) required in POSIX.1-2001.</p>
      <p>Using a statically sized buffer might not provide enough
      room for the symbolic link contents. The required size for
      the buffer can be obtained from the <em class="replaceable"><code>stat.st_size</code></em> value returned
      by a call to <a class="link" href="../htmlman2/stat.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">lstat</span>(2)</span></a> on the link.
      However, the number of bytes written by <code class="function">readlink</code>() and <code class="function">readlinkat</code>() should be checked to make sure
      that the size of the symbolic link did not increase between
      the calls. Dynamically allocating the buffer for <code class="function">readlink</code>() and <code class="function">readlinkat</code>() also addresses a common
      portability problem when using <code class="constant">PATH_MAX</code> for the buffer size, as this
      constant is not guaranteed to be defined per POSIX if the
      system does not have such limit.</p>
      <div class="refsect2">
        <a id="readlink-2_sect8" name="readlink-2_sect8" shape="rect"> </a>
        <h3>Glibc notes</h3>
        <p>On older kernels where <code class="function">readlinkat</code>() is unavailable, the glibc
        wrapper function falls back to the use of <code class="function">readlink</code>(). When <em class="parameter"><code>pathname</code></em> is a relative
        pathname, glibc constructs a pathname based on the symbolic
        link in <code class="filename">/proc/self/fd</code> that
        corresponds to the <em class="parameter"><code>dirfd</code></em> argument.</p>
      </div>
    </div>
    <div class="refsect1">
      <a id="readlink-2_sect9" name="readlink-2_sect9" shape="rect"> </a>
      <h2>EXAMPLES</h2>
      <p>The following program allocates the buffer needed by
      <code class="function">readlink</code>() dynamically from the
      information provided by <a class="link" href="../htmlman2/stat.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">lstat</span>(2)</span></a>, falling back to a
      buffer of size <code class="constant">PATH_MAX</code> in
      cases where <a class="link" href="../htmlman2/stat.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">lstat</span>(2)</span></a> reports a size of
      zero.</p>
      <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
#include &lt;sys/types.h&gt;
#include &lt;sys/stat.h&gt;
#include &lt;limits.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;

int
main(int argc, char *argv[])
{
    struct stat sb;
    char *buf;
    ssize_t nbytes, bufsiz;

    if (argc != 2) {
        fprintf(stderr, "Usage: %s &lt;pathname&gt;\n", argv[0]);
        exit(EXIT_FAILURE);
    }

    if (lstat(argv[1], &amp;sb) == −1) {
        perror("lstat");
        exit(EXIT_FAILURE);
    }

    /* Add one to the link size, so that we can determine whether
       the buffer returned by readlink() was truncated. */

    bufsiz = sb.st_size + 1;

    /* Some magic symlinks under (for example) /proc and /sys
       report 'st_size' as zero. In that case, take PATH_MAX as
       a "good enough" estimate. */

    if (sb.st_size == 0)
        bufsiz = PATH_MAX;

    buf = malloc(bufsiz);
    if (buf == NULL) {
        perror("malloc");
        exit(EXIT_FAILURE);
    }

    nbytes = readlink(argv[1], buf, bufsiz);
    if (nbytes == −1) {
        perror("readlink");
        exit(EXIT_FAILURE);
    }

    /* Print only 'nbytes' of 'buf', as it doesn't contain a terminating
       null byte ('\0'). */
    printf("'%s' points to '%.*s'\n", argv[1], (int) nbytes, buf);

    /* If the return value was equal to the buffer size, then the
       the link target was larger than expected (perhaps because the
       target was changed between the call to lstat() and the call to
       readlink()). Warn the user that the returned target may have
       been truncated. */

    if (nbytes == bufsiz)
        printf("(Returned buffer may have been truncated)\n");

    free(buf);
    exit(EXIT_SUCCESS);
}
</pre>
      </div>
    </div>
    <div class="refsect1">
      <a id="readlink-2_sect10" name="readlink-2_sect10" shape="rect"> </a>
      <h2>SEE ALSO</h2>
      <p><a class="link" href="../htmlman1/readlink.1.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">readlink</span>(1)</span></a>, <a class="link" href="../htmlman2/stat.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">lstat</span>(2)</span></a>, <a class="link" href="../htmlman2/stat.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">stat</span>(2)</span></a>, <a class="link" href="../htmlman2/symlink.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">symlink</span>(2)</span></a>, <a class="link" href="../htmlman3/realpath.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">realpath</span>(3)</span></a>, <a class="link" href="../htmlman7/path_resolution.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">path_resolution</span>(7)</span></a>,
      <a class="link" href="../htmlman7/symlink.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">symlink</span>(7)</span></a></p>
    </div>
    <div class="colophon">
      <a id="readlink-2_sect11" name="readlink-2_sect11" shape="rect"> </a>
      <h2>COLOPHON</h2>
      <p>This page is part of release 5.11 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      https://www.kernel.org/doc/man−pages/.</p>
      <div class="license">
        <table class="license" style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>
          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    Copyright (c) 1983, 1991 The Regents of the University of California.<br />

                  And Copyright (C) 2011 Guillem Jover &lt;guillem<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>hadrons.org&gt;<br />

                  And Copyright (C) 2006, 2014 Michael Kerrisk<br />

                  All rights reserved.<br />
                  <br />
                  %%%LICENSE_START(BSD_4_CLAUSE_UCB)<br />
                  Redistribution and use in source and binary forms, with or without<br />

                  modification, are permitted provided that the following conditions<br />

                  are met:<br />
                  1. Redistributions of source code must retain the above copyright<br />

                     notice, this list of conditions and the following disclaimer.<br />

                  2. Redistributions in binary form must reproduce the above copyright<br />

                     notice, this list of conditions and the following disclaimer in the<br />

                     documentation and/or other materials provided with the distribution.<br />

                  3. All advertising materials mentioning features or use of this software<br />

                     must display the following acknowledgement:<br />

                  This product includes software developed by the University of<br />

                  California, Berkeley and its contributors.<br />

                  4. Neither the name of the University nor the names of its contributors<br />

                     may be used to endorse or promote products derived from this software<br />

                     without specific prior written permission.<br />

                  <br />
                  THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND<br />

                  ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE<br />

                  IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE<br />

                  ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE<br />

                  FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL<br />

                  DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS<br />

                  OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)<br />

                  HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT<br />

                  LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY<br />

                  OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF<br />

                  SUCH DAMAGE.<br />
                  %%%LICENSE_END<br />
                  <br />
                      <script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>(#)readlink.2
                  6.8 (Berkeley) 3/10/91<br />
                  <br />
                  Modified Sat Jul 24 00:10:21 1993 by Rik Faith (faith<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cs.unc.edu)<br />

                  Modified Tue Jul  9 23:55:17 1996 by aeb<br />

                  Modified Fri Jan 24 00:26:00 1997 by aeb<br />

                  2011-09-20, Guillem Jover &lt;guillem<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>hadrons.org&gt;:<br />

                      Added text on dynamically allocating buffer + example program<br />
                  
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
