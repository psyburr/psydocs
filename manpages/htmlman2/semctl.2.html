<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>semctl(2) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="semctl(2) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve"> </script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>
<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>
          <th rowspan="1" colspan="1"><a href="../index2.html" shape="rect">Section 2</a></th>
          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>
  <div class="refentry">
    <a id="semctl.2" name="semctl.2" shape="rect"> </a>
    <div class="titlepage"> </div>
    <div class="refnamediv">
      <h2>Name</h2>
      <p>semctl — System V semaphore control operations</p>
    </div>
    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>
      <div class="informalexample">
        <pre class="programlisting" xml:space="preserve">
#include &lt;sys/ipc.h&gt;
#include &lt;sys/sem.h&gt;</pre>
      </div>
      <div class="funcsynopsis">
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">int
            <strong>semctl</strong>(</code></td>
            <td rowspan="1" colspan="1">int <var class="pdparam">semid</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">int <var class="pdparam">semnum</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1">int <var class="pdparam">cmd</var>,</td>
          </tr>
          <tr>
            <td rowspan="1" colspan="1"> </td>
            <td rowspan="1" colspan="1"><var class="pdparam">...</var><code>)</code>;</td>
          </tr>
        </table>
        <div class="funcprototype-spacer">
           
        </div>
      </div>
    </div>
    <div class="refsect1">
      <a id="semctl-2_sect1" name="semctl-2_sect1" shape="rect"> </a>
      <h2>DESCRIPTION</h2>
      <p><code class="function">semctl</code>() performs the
      control operation specified by <em class="parameter"><code>cmd</code></em> on the System V semaphore
      set identified by <em class="parameter"><code>semid</code></em>, or on the <em class="parameter"><code>semnum</code></em>-th semaphore of that
      set. (The semaphores in a set are numbered starting at
      0.)</p>
      <p>This function has three or four arguments, depending on
      <em class="parameter"><code>cmd</code></em>. When there are
      four, the fourth has the type <span class="emphasis"><em>union semun</em></span>. The <span class="emphasis"><em>calling program</em></span> must define this
      union as follows:</p>
      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="structdef">
            <table class="structdef" style="border-collapse: collapse;">
              <colgroup span="1">
                <col class="c1" span="1" />
                <col class="c2" span="1" />
                <col class="c3" span="1" />
                <col class="c4" span="1" />
                <col class="c5" span="1" />
              </colgroup>
              <tbody>
                <tr>
                  <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">
                  union</td>
                  <td class="structdefhdr" style="" colspan="4" align="left" rowspan="1"><span class="structname">semun</span> {</td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>val</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* Value for SETVAL */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">struct semid_ds</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                  *</td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>buf</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* Buffer for IPC_STAT, IPC_SET */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">unsigned short</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                  *</td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>array</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* Array for GETALL, SETALL */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">struct seminfo</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                  *</td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>__buf</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* Buffer for IPC_INFO<br />
                      (Linux\-specific) */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">};</td>
                </tr>
              </tbody>
            </table>
          </div>
        </blockquote>
      </div>
      <p>The <em class="replaceable"><code>semid_ds</code></em>
      data structure is defined in <code class="literal">&lt;</code><code class="filename">sys/sem.h</code><code class="literal">&gt;</code>
      as follows:</p>
      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="structdef">
            <table class="structdef" style="border-collapse: collapse;">
              <colgroup span="1">
                <col class="c1" span="1" />
                <col class="c2" span="1" />
                <col class="c3" span="1" />
                <col class="c4" span="1" />
                <col class="c5" span="1" />
              </colgroup>
              <tbody>
                <tr>
                  <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">
                  struct</td>
                  <td class="structdefhdr" style="" colspan="4" align="left" rowspan="1"><span class="structname">semid_ds</span> {</td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">struct ipc_perm</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>sem_perm</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* Ownership and permissions */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">time_t</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>sem_otime</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* Last semop time */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">time_t</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>sem_ctime</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* Creation time/time of last<br />

                      modification via semctl() */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">unsigned long</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>sem_nsems</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* No. of semaphores in set */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">};</td>
                </tr>
              </tbody>
            </table>
          </div>
        </blockquote>
      </div>
      <p>The fields of the <em class="replaceable"><code>semid_ds</code></em> structure are as
      follows:</p>
      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><em class="parameter"><code>sem_perm</code></em></span></dt>
          <dd>
            <p>This is an <em class="replaceable"><code>ipc_perm</code></em> structure (see
            below) that specifies the access permissions on the
            semaphore set.</p>
          </dd>
          <dt><span class="term"><em class="parameter"><code>sem_otime</code></em></span></dt>
          <dd>
            <p>Time of last <a class="link" href="../htmlman2/semop.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">semop</span>(2)</span></a> system
            call.</p>
          </dd>
          <dt><span class="term"><em class="parameter"><code>sem_ctime</code></em></span></dt>
          <dd>
            <p>Time of creation of semaphore set or time of last
            <code class="function">semctl</code>() <code class="constant">IPCSET</code>, <code class="constant">SETVAL</code>, or <code class="constant">SETALL</code> operation.</p>
          </dd>
          <dt><span class="term"><em class="parameter"><code>sem_nsems</code></em></span></dt>
          <dd>
            <p>Number of semaphores in the set. Each semaphore of
            the set is referenced by a nonnegative integer ranging
            from <code class="constant">0</code> to <em class="replaceable"><code>sem_nsems−1</code></em>.</p>
          </dd>
        </dl>
      </div>
      <p>The <em class="replaceable"><code>ipc_perm</code></em>
      structure is defined as follows (the highlighted fields are
      settable using <code class="constant">IPC_SET</code>):</p>
      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="structdef">
            <table class="structdef" style="border-collapse: collapse;">
              <colgroup span="1">
                <col class="c1" span="1" />
                <col class="c2" span="1" />
                <col class="c3" span="1" />
                <col class="c4" span="1" />
                <col class="c5" span="1" />
              </colgroup>
              <tbody>
                <tr>
                  <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">
                  struct</td>
                  <td class="structdefhdr" style="" colspan="4" align="left" rowspan="1"><span class="structname">ipc_perm</span> {</td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">key_t</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>__key</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* Key supplied to semget(2) */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">uid_t</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>uid</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* Effective UID of owner */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">gid_t</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>gid</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* Effective GID of owner */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">uid_t</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>cuid</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* Effective UID of creator */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">gid_t</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>cgid</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* Effective GID of creator */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">unsigned short</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>mode</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      /* Permissions */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">unsigned short</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>__seq</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      /* Sequence number */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">};</td>
                </tr>
              </tbody>
            </table>
          </div>
        </blockquote>
      </div>
      <p>The least significant 9 bits of the <em class="parameter"><code>mode</code></em> field of the <em class="replaceable"><code>ipc_perm</code></em> structure define the
      access permissions for the shared memory segment. The
      permission bits are as follows:</p>
      <div class="informaltable">
        <table class="informaltable" style="border-collapse: collapse;">
          <colgroup span="1">
            <col class="c0" span="1" />
            <col class="c1" span="1" />
          </colgroup>
          <tbody>
            <tr>
              <td style="" align="left" rowspan="1" colspan="1">0400</td>
              <td style="" align="left" rowspan="1" colspan="1">Read by user</td>
            </tr>
            <tr>
              <td style="" align="left" rowspan="1" colspan="1">0200</td>
              <td style="" align="left" rowspan="1" colspan="1">Write by user</td>
            </tr>
            <tr>
              <td style="" align="left" rowspan="1" colspan="1">0040</td>
              <td style="" align="left" rowspan="1" colspan="1">Read by group</td>
            </tr>
            <tr>
              <td style="" align="left" rowspan="1" colspan="1">0020</td>
              <td style="" align="left" rowspan="1" colspan="1">Write by group</td>
            </tr>
            <tr>
              <td style="" align="left" rowspan="1" colspan="1">0004</td>
              <td style="" align="left" rowspan="1" colspan="1">Read by others</td>
            </tr>
            <tr>
              <td style="" align="left" rowspan="1" colspan="1">0002</td>
              <td style="" align="left" rowspan="1" colspan="1">Write by others</td>
            </tr>
          </tbody>
        </table>
      </div>
      <p>In effect, "write" means "alter" for a semaphore set. Bits
      0100, 0010, and 0001 (the execute bits) are unused by the
      system.</p>
      <p>Valid values for <em class="parameter"><code>cmd</code></em> are:</p>
      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><code class="constant">IPC_STAT</code></span></dt>
          <dd>
            <p>Copy information from the kernel data structure
            associated with <em class="parameter"><code>semid</code></em> into the <em class="replaceable"><code>semid_ds</code></em> structure
            pointed to by <em class="replaceable"><code>arg.buf</code></em>. The argument
            <em class="parameter"><code>semnum</code></em> is
            ignored. The calling process must have read permission
            on the semaphore set.</p>
          </dd>
          <dt><span class="term"><code class="constant">IPC_SET</code></span></dt>
          <dd>
            <p>Write the values of some members of the <em class="replaceable"><code>semid_ds</code></em> structure
            pointed to by <em class="replaceable"><code>arg.buf</code></em> to the kernel
            data structure associated with this semaphore set,
            updating also its <em class="parameter"><code>sem_ctime</code></em> member.</p>
            <p>The following members of the structure are updated:
            <em class="replaceable"><code>sem_perm.uid</code></em>,
            <em class="replaceable"><code>sem_perm.gid</code></em>,
            and (the least significant 9 bits of) <em class="replaceable"><code>sem_perm.mode</code></em>.</p>
            <p>The effective UID of the calling process must match
            the owner (<em class="replaceable"><code>sem_perm.uid</code></em>) or
            creator (<em class="replaceable"><code>sem_perm.cuid</code></em>) of the
            semaphore set, or the caller must be privileged. The
            argument <em class="parameter"><code>semnum</code></em>
            is ignored.</p>
          </dd>
          <dt><span class="term"><code class="constant">IPC_RMID</code></span></dt>
          <dd>
            <p>Immediately remove the semaphore set, awakening all
            processes blocked in <a class="link" href="../htmlman2/semop.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">semop</span>(2)</span></a> calls on the
            set (with an error return and <code class="varname">errno</code> set to <span class="errorname">EIDRM</span>). The effective user ID of the
            calling process must match the creator or owner of the
            semaphore set, or the caller must be privileged. The
            argument <em class="parameter"><code>semnum</code></em>
            is ignored.</p>
          </dd>
          <dt><span class="term"><code class="constant">IPC_INFO</code>
          (Linux−specific)</span></dt>
          <dd>
            <p>Return information about system-wide semaphore
            limits and parameters in the structure pointed to by
            <em class="replaceable"><code>arg.__buf</code></em>.
            This structure is of type <em class="replaceable"><code>seminfo</code></em>, defined in
            <code class="literal">&lt;</code><code class="filename">sys/sem.h</code><code class="literal">&gt;</code> if the <code class="constant">_GNU_SOURCE</code> feature test macro is
            defined:</p>
            <div class="blockquote">
              <blockquote class="blockquote">
                <div class="structdef">
                  <table class="structdef" style="border-collapse: collapse;">
                    <colgroup span="1">
                      <col class="c1" span="1" />
                      <col class="c2" span="1" />
                      <col class="c3" span="1" />
                      <col class="c4" span="1" />
                      <col class="c5" span="1" />
                    </colgroup>
                    <tbody>
                      <tr>
                        <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">struct</td>
                        <td class="structdefhdr" style="" colspan="4" align="left" rowspan="1"><span class="structname">seminfo</span> {</td>
                      </tr>
                      <tr>
                        <td style="" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>
                        <td class="norightpad" style="" align="right" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>semmap</code></em>;</td>
                        <td style="" align="left" rowspan="1" colspan="1">
                          <div class="literallayout">
                            
                            /* Number of entries in semaphore<br />

                            map; unused within kernel */
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td style="" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>
                        <td class="norightpad" style="" align="right" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>semmni</code></em>;</td>
                        <td style="" align="left" rowspan="1" colspan="1">
                          <div class="literallayout">
                            
                            /* Maximum number of semaphore sets */
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td style="" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>
                        <td class="norightpad" style="" align="right" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>semmns</code></em>;</td>
                        <td style="" align="left" rowspan="1" colspan="1">
                          <div class="literallayout">
                            
                            /* Maximum number of semaphores in all<br />

                            semaphore sets */
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td style="" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>
                        <td class="norightpad" style="" align="right" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>semmnu</code></em>;</td>
                        <td style="" align="left" rowspan="1" colspan="1">
                          <div class="literallayout">
                            
                            /* System\-wide maximum number of undo<br />

                            structures; unused within kernel */
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td style="" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>
                        <td class="norightpad" style="" align="right" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>semmsl</code></em>;</td>
                        <td style="" align="left" rowspan="1" colspan="1">
                          <div class="literallayout">
                            
                            /* Maximum number of semaphores in a<br />

                            set */
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td style="" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>
                        <td class="norightpad" style="" align="right" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>semopm</code></em>;</td>
                        <td style="" align="left" rowspan="1" colspan="1">
                          <div class="literallayout">
                            
                            /* Maximum number of operations for<br />

                            semop(2) */
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td style="" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>
                        <td class="norightpad" style="" align="right" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>semume</code></em>;</td>
                        <td style="" align="left" rowspan="1" colspan="1">
                          <div class="literallayout">
                            
                            /* Maximum number of undo entries per<br />

                            process; unused within kernel */
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td style="" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>
                        <td class="norightpad" style="" align="right" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>semusz</code></em>;</td>
                        <td style="" align="left" rowspan="1" colspan="1">
                          <div class="literallayout">
                            
                            /* Size of struct sem_undo */
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td style="" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>
                        <td class="norightpad" style="" align="right" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>semvmx</code></em>;</td>
                        <td style="" align="left" rowspan="1" colspan="1">
                          <div class="literallayout">
                            
                            /* Maximum semaphore value */
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td style="" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><span class="type">int</span></td>
                        <td class="norightpad" style="" align="right" rowspan="1" colspan="1"> </td>
                        <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>semaem</code></em>;</td>
                        <td style="" align="left" rowspan="1" colspan="1">
                          <div class="literallayout">
                            
                            /* Max. value that can be recorded for<br />

                            semaphore adjustment (SEM_UNDO) */
                          </div>
                        </td>
                      </tr>
                      <tr>
                        <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">};</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </blockquote>
            </div>
            <p>The <em class="parameter"><code>semmsl</code></em>,
            <em class="parameter"><code>semmns</code></em>,
            <em class="parameter"><code>semopm</code></em>, and
            <em class="parameter"><code>semmni</code></em> settings
            can be changed via <code class="filename">/proc/sys/kernel/sem</code>; see <a class="link" href="../htmlman5/proc.5.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">proc</span>(5)</span></a> for
            details.</p>
          </dd>
          <dt><span class="term"><code class="constant">SEM_INFO</code> (Linux-specific)</span></dt>
          <dd>
            <p>Return a <em class="replaceable"><code>seminfo</code></em> structure
            containing the same information as for <code class="constant">IPC_INFO</code>, except that the following
            fields are returned with information about system
            resources consumed by semaphores: the <em class="parameter"><code>semusz</code></em> field returns the
            number of semaphore sets that currently exist on the
            system; and the <em class="parameter"><code>semaem</code></em> field returns the
            total number of semaphores in all semaphore sets on the
            system.</p>
          </dd>
          <dt><span class="term"><code class="constant">SEM_STAT</code> (Linux-specific)</span></dt>
          <dd>
            <p>Return a <em class="replaceable"><code>semid_ds</code></em> structure as
            for <code class="constant">IPC_STAT</code>. However,
            the <em class="parameter"><code>semid</code></em>
            argument is not a semaphore identifier, but instead an
            index into the kernel's internal array that maintains
            information about all semaphore sets on the system.</p>
          </dd>
          <dt><span class="term"><code class="constant">SEM_STAT_ANY</code> (Linux-specific, since
          Linux 4.17)</span></dt>
          <dd>
            <p>Return a <em class="replaceable"><code>semid_ds</code></em> structure as
            for <code class="constant">SEM_STAT</code>. However,
            <em class="replaceable"><code>sem_perm.mode</code></em>
            is not checked for read access for <em class="parameter"><code>semid</code></em> meaning that any
            user can employ this operation (just as any user may
            read <code class="filename">/proc/sysvipc/sem</code> to
            obtain the same information).</p>
          </dd>
          <dt><span class="term"><code class="constant">GETALL</code></span></dt>
          <dd>
            <p>Return <em class="replaceable"><code>semval</code></em> (i.e., the
            current value) for all semaphores of the set into
            <em class="replaceable"><code>arg.array</code></em>.
            The argument <em class="parameter"><code>semnum</code></em> is ignored. The
            calling process must have read permission on the
            semaphore set.</p>
          </dd>
          <dt><span class="term"><code class="constant">GETNCNT</code></span></dt>
          <dd>
            <p>Return the <em class="replaceable"><code>semncnt</code></em> value for the
            <em class="parameter"><code>semnum</code></em>−th
            semaphore of the set (i.e., the number of processes
            waiting for the semaphore's value to increase). The
            calling process must have read permission on the
            semaphore set.</p>
          </dd>
          <dt><span class="term"><code class="constant">GETPID</code></span></dt>
          <dd>
            <p>Return the <em class="replaceable"><code>sempid</code></em> value for the
            <em class="parameter"><code>semnum</code></em>−th
            semaphore of the set. This is the PID of the process
            that last performed an operation on that semaphore (but
            see NOTES). The calling process must have read
            permission on the semaphore set.</p>
          </dd>
          <dt><span class="term"><code class="constant">GETVAL</code></span></dt>
          <dd>
            <p>Return <em class="replaceable"><code>semval</code></em> (i.e., the
            semaphore value) for the <em class="parameter"><code>semnum</code></em>−th semaphore
            of the set. The calling process must have read
            permission on the semaphore set.</p>
          </dd>
          <dt><span class="term"><code class="constant">GETZCNT</code></span></dt>
          <dd>
            <p>Return the <em class="replaceable"><code>semzcnt</code></em> value for the
            <em class="parameter"><code>semnum</code></em>−th
            semaphore of the set (i.e., the number of processes
            waiting for the semaphore value to become 0). The
            calling process must have read permission on the
            semaphore set.</p>
          </dd>
          <dt><span class="term"><code class="constant">SETALL</code></span></dt>
          <dd>
            <p>Set the <em class="replaceable"><code>semval</code></em> values for all
            semaphores of the set using <em class="replaceable"><code>arg.array</code></em>, updating
            also the <em class="parameter"><code>sem_ctime</code></em> member of the
            <em class="replaceable"><code>semid_ds</code></em>
            structure associated with the set. Undo entries (see
            <a class="link" href="../htmlman2/semop.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">semop</span>(2)</span></a>) are cleared
            for altered semaphores in all processes. If the changes
            to semaphore values would permit blocked <a class="link" href="../htmlman2/semop.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">semop</span>(2)</span></a> calls in
            other processes to proceed, then those processes are
            woken up. The argument <em class="parameter"><code>semnum</code></em> is ignored. The
            calling process must have alter (write) permission on
            the semaphore set.</p>
          </dd>
          <dt><span class="term"><code class="constant">SETVAL</code></span></dt>
          <dd>
            <p>Set the semaphore value <code class="literal">(</code>semval<code class="literal">)</code>
            to <em class="replaceable"><code>arg.val</code></em>
            for the <em class="parameter"><code>semnum</code></em>−th semaphore
            of the set, updating also the <em class="parameter"><code>sem_ctime</code></em> member of the
            <em class="replaceable"><code>semid_ds</code></em>
            structure associated with the set. Undo entries are
            cleared for altered semaphores in all processes. If the
            changes to semaphore values would permit blocked
            <a class="link" href="../htmlman2/semop.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">semop</span>(2)</span></a> calls in
            other processes to proceed, then those processes are
            woken up. The calling process must have alter
            permission on the semaphore set.</p>
          </dd>
        </dl>
      </div>
    </div>
    <div class="refsect1">
      <a id="semctl-2_sect2" name="semctl-2_sect2" shape="rect"> </a>
      <h2>RETURN VALUE</h2>
      <p>On success, <code class="function">semctl</code>() returns
      a nonnegative value depending on <em class="parameter"><code>cmd</code></em> as follows:</p>
      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><code class="constant">GETNCNT</code></span></dt>
          <dd>
            <p>the value of <em class="replaceable"><code>semncnt</code></em>.</p>
          </dd>
          <dt><span class="term"><code class="constant">GETPID</code></span></dt>
          <dd>
            <p>the value of <em class="replaceable"><code>sempid</code></em>.</p>
          </dd>
          <dt><span class="term"><code class="constant">GETVAL</code></span></dt>
          <dd>
            <p>the value of <em class="replaceable"><code>semval</code></em>.</p>
          </dd>
          <dt><span class="term"><code class="constant">GETZCNT</code></span></dt>
          <dd>
            <p>the value of <em class="replaceable"><code>semzcnt</code></em>.</p>
          </dd>
          <dt><span class="term"><code class="constant">IPC_INFO</code></span></dt>
          <dd>
            <p>the index of the highest used entry in the kernel's
            internal array recording information about all
            semaphore sets. (This information can be used with
            repeated <code class="constant">SEM_STAT</code> or
            <code class="constant">SEM_STAT_ANY</code> operations
            to obtain information about all semaphore sets on the
            system.)</p>
          </dd>
          <dt><span class="term"><code class="constant">SEM_INFO</code></span></dt>
          <dd>
            <p>as for <code class="constant">IPC_INFO</code>.</p>
          </dd>
          <dt><span class="term"><code class="constant">SEM_STAT</code></span></dt>
          <dd>
            <p>the identifier of the semaphore set whose index was
            given in <em class="parameter"><code>semid</code></em>.</p>
          </dd>
          <dt><span class="term"><code class="constant">SEM_STAT_ANY</code></span></dt>
          <dd>
            <p>as for <code class="constant">SEM_STAT</code>.</p>
          </dd>
        </dl>
      </div>
      <p>All other <em class="parameter"><code>cmd</code></em>
      values return 0 on success.</p>
      <p>On failure, <code class="function">semctl</code>() returns
      −1 and sets <code class="varname">errno</code> to
      indicate the error.</p>
    </div>
    <div class="refsect1">
      <a id="semctl-2_sect3" name="semctl-2_sect3" shape="rect"> </a>
      <h2>ERRORS</h2>
      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><span class="errorname">EACCES</span></span></dt>
          <dd>
            <p>The argument <em class="parameter"><code>cmd</code></em> has one of the values
            <code class="constant">GETALL</code>, <code class="constant">GETPID</code>, <code class="constant">GETVAL</code>, <code class="constant">GETNCNT</code>, <code class="constant">GETZCNT</code>, <code class="constant">IPC_STAT</code>, <code class="constant">SEM_STAT</code>, <code class="constant">SEM_STAT_ANY</code>, <code class="constant">SETALL</code>, or <code class="constant">SETVAL</code> and the calling process does
            not have the required permissions on the semaphore set
            and does not have the <code class="constant">CAP_IPC_OWNER</code> capability in the user
            namespace that governs its IPC namespace.</p>
          </dd>
          <dt><span class="term"><span class="errorname">EFAULT</span></span></dt>
          <dd>
            <p>The address pointed to by <em class="replaceable"><code>arg.buf</code></em> or <em class="replaceable"><code>arg.array</code></em> isn't
            accessible.</p>
          </dd>
          <dt><span class="term"><span class="errorname">EIDRM</span></span></dt>
          <dd>
            <p>The semaphore set was removed.</p>
          </dd>
          <dt><span class="term"><span class="errorname">EINVAL</span></span></dt>
          <dd>
            <p>Invalid value for <em class="parameter"><code>cmd</code></em> or <em class="parameter"><code>semid</code></em>. Or: for a
            <code class="constant">SEM_STAT</code> operation, the
            index value specified in <em class="parameter"><code>semid</code></em> referred to an
            array slot that is currently unused.</p>
          </dd>
          <dt><span class="term"><span class="errorname">EPERM</span></span></dt>
          <dd>
            <p>The argument <em class="parameter"><code>cmd</code></em> has the value
            <code class="constant">IPC_SET</code> or <code class="constant">IPC_RMID</code> but the effective user ID of
            the calling process is not the creator (as found in
            <em class="replaceable"><code>sem_perm.cuid</code></em>) or the
            owner (as found in <em class="replaceable"><code>sem_perm.uid</code></em>) of the
            semaphore set, and the process does not have the
            <code class="constant">CAP_SYS_ADMIN</code>
            capability.</p>
          </dd>
          <dt><span class="term"><span class="errorname">ERANGE</span></span></dt>
          <dd>
            <p>The argument <em class="parameter"><code>cmd</code></em> has the value
            <code class="constant">SETALL</code> or <code class="constant">SETVAL</code> and the value to which
            <em class="replaceable"><code>semval</code></em> is to
            be set (for some semaphore of the set) is less than 0
            or greater than the implementation limit <code class="constant">SEMVMX</code>.</p>
          </dd>
        </dl>
      </div>
    </div>
    <div class="refsect1">
      <a id="semctl-2_sect4" name="semctl-2_sect4" shape="rect"> </a>
      <h2>CONFORMING TO</h2>
      <p>POSIX.1-2001, POSIX.1-2008, SVr4.</p>
      <p>POSIX.1 specifies the <em class="parameter"><code>sem_nsems</code></em> field of the
      <em class="replaceable"><code>semid_ds</code></em> structure
      as having the type <span class="type">unsigned short</span>,
      and the field is so defined on most other systems. It was
      also so defined on Linux 2.2 and earlier, but, since Linux
      2.4, the field has the type <span class="type">unsigned
      long</span>.</p>
    </div>
    <div class="refsect1">
      <a id="semctl-2_sect5" name="semctl-2_sect5" shape="rect"> </a>
      <h2>NOTES</h2>
      <p>The inclusion of <code class="literal">&lt;</code><code class="filename">sys/ipc.h</code><code class="literal">&gt;</code>
      isn't required on Linux or by any version of POSIX. However,
      some old implementations required the inclusion of this
      header file, and the SVID also documented its inclusion.
      Applications intended to be portable to such old systems may
      need to include this header file.</p>
      <p>The <code class="constant">IPC_INFO</code>, <code class="constant">SEM_STAT</code>, and <code class="constant">SEM_INFO</code> operations are used by the
      <a class="link" href="../htmlman1/ipcs.1.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">ipcs</span>(1)</span></a> program to provide
      information on allocated resources. In the future these may
      modified or moved to a <code class="filename">/proc</code>
      filesystem interface.</p>
      <p>Various fields in a <span class="emphasis"><em>struct
      semid_ds</em></span> were typed as <span class="type">short</span> under Linux 2.2 and have become
      <span class="type">long</span> under Linux 2.4. To take
      advantage of this, a recompilation under glibc-2.1.91 or
      later should suffice. (The kernel distinguishes old and new
      calls by an <code class="constant">IPC_64</code> flag in
      <em class="parameter"><code>cmd</code></em>.)</p>
      <p>In some earlier versions of glibc, the <em class="replaceable"><code>semun</code></em> union was defined in
      <code class="literal">&lt;</code><code class="filename">sys/sem.h</code><code class="literal">&gt;</code>
      but POSIX.1 requires that the caller define this union. On
      versions of glibc where this union is <em class="replaceable"><code>not</code></em> defined, the macro
      <code class="constant">_SEM_SEMUN_UNDEFINED</code> is defined
      in <code class="literal">&lt;</code><code class="filename">sys/sem.h</code><code class="literal">&gt;</code></p>
      <p>The following system limit on semaphore sets affects a
      <code class="function">semctl</code>() call:</p>
      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><code class="constant">SEMVMX</code></span></dt>
          <dd>
            <p>Maximum value for <em class="replaceable"><code>semval</code></em>: implementation
            dependent (32767).</p>
          </dd>
        </dl>
      </div>
      <p>For greater portability, it is best to always call
      <code class="function">semctl</code>() with four
      arguments.</p>
      <div class="refsect2">
        <a id="semctl-2_sect6" name="semctl-2_sect6" shape="rect"> </a>
        <h3>The sempid value</h3>
        <p>POSIX.1 defines <em class="replaceable"><code>sempid</code></em> as the "process ID
        of [the] last operation" on a semaphore, and explicitly
        notes that this value is set by a successful <a class="link" href="../htmlman2/semop.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">semop</span>(2)</span></a> call, with the
        implication that no other interface affects the <em class="replaceable"><code>sempid</code></em> value.</p>
        <p>While some implementations conform to the behavior
        specified in POSIX.1, others do not. (The fault here
        probably lies with POSIX.1 inasmuch as it likely failed to
        capture the full range of existing implementation
        behaviors.) Various other implementations also update
        <em class="replaceable"><code>sempid</code></em> for the
        other operations that update the value of a semaphore: the
        <code class="constant">SETVAL</code> and <code class="constant">SETALL</code> operations, as well as the
        semaphore adjustments performed on process termination as a
        consequence of the use of the <code class="constant">SEM_UNDO</code> flag (see <a class="link" href="../htmlman2/semop.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">semop</span>(2)</span></a>).</p>
        <p>Linux also updates <em class="replaceable"><code>sempid</code></em> for <code class="constant">SETVAL</code> operations and semaphore
        adjustments. However, somewhat inconsistently, up to and
        including Linux 4.5, the kernel did not update <em class="replaceable"><code>sempid</code></em> for <code class="constant">SETALL</code> operations. This was rectified in
        Linux 4.6.</p>
      </div>
    </div>
    <div class="refsect1">
      <a id="semctl-2_sect7" name="semctl-2_sect7" shape="rect"> </a>
      <h2>EXAMPLES</h2>
      <p>See <a class="link" href="../htmlman2/shmop.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">shmop</span>(2)</span></a>.</p>
    </div>
    <div class="refsect1">
      <a id="semctl-2_sect8" name="semctl-2_sect8" shape="rect"> </a>
      <h2>SEE ALSO</h2>
      <p><a class="link" href="../htmlman2/ipc.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">ipc</span>(2)</span></a>, <a class="link" href="../htmlman2/semget.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">semget</span>(2)</span></a>, <a class="link" href="../htmlman2/semop.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">semop</span>(2)</span></a>, <a class="link" href="../htmlman7/capabilities.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">capabilities</span>(7)</span></a>, <a class="link" href="../htmlman7/sem_overview.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">sem_overview</span>(7)</span></a>, <a class="link" href="../htmlman7/sysvipc.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">sysvipc</span>(7)</span></a></p>
    </div>
    <div class="colophon">
      <a id="semctl-2_sect9" name="semctl-2_sect9" shape="rect"> </a>
      <h2>COLOPHON</h2>
      <p>This page is part of release 5.11 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      https://www.kernel.org/doc/man−pages/.</p>
      <div class="license">
        <table class="license" style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>
          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    Copyright 1993 Giorgio Ciucci (giorgio<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>crcc.it)<br />

                  and Copyright 2004, 2005 Michael Kerrisk &lt;mtk.manpages<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>gmail.com&gt;<br />

                  <br />
                  %%%LICENSE_START(VERBATIM)<br />
                  Permission is granted to make and distribute verbatim copies of this<br />

                  manual provided the copyright notice and this permission notice are<br />

                  preserved on all copies.<br />
                  <br />
                  Permission is granted to copy and distribute modified versions of this<br />

                  manual under the conditions for verbatim copying, provided that the<br />

                  entire resulting derived work is distributed under the terms of a<br />

                  permission notice identical to this one.<br />

                  <br />
                  Since the Linux kernel and libraries are constantly changing, this<br />

                  manual page may be incorrect or out-of-date.  The author(s) assume no<br />

                  responsibility for errors or omissions, or for damages resulting from<br />

                  the use of the information contained herein.  The author(s) may not<br />

                  have taken the same level of care in the production of this manual,<br />

                  which is licensed free of charge, as they might when working<br />

                  professionally.<br />
                  <br />
                  Formatted or processed versions of this manual, if unaccompanied by<br />

                  the source, must acknowledge the copyright and authors of this work.<br />

                  %%%LICENSE_END<br />
                  <br />
                  Modified Tue Oct 22 17:53:56 1996 by Eric S. Raymond &lt;esr<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>thyrsus.com&gt;<br />

                  Modified Fri Jun 19 10:59:15 1998 by Andries Brouwer &lt;aeb<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cwi.nl&gt;<br />

                  Modified Sun Feb 18 01:59:29 2001 by Andries Brouwer &lt;aeb<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cwi.nl&gt;<br />

                  Modified 20 Dec 2001, Michael Kerrisk &lt;mtk.manpages<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>gmail.com&gt;<br />

                  Modified 21 Dec 2001, aeb<br />

                  Modified 27 May 2004, Michael Kerrisk &lt;mtk.manpages<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>gmail.com&gt;<br />

                      Added notes on CAP_IPC_OWNER requirement<br />

                  Modified 17 Jun 2004, Michael Kerrisk &lt;mtk.manpages<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>gmail.com&gt;<br />

                      Added notes on CAP_SYS_ADMIN requirement for IPC_SET and IPC_RMID<br />

                  Modified, 11 Nov 2004, Michael Kerrisk &lt;mtk.manpages<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>gmail.com&gt;<br />

                  Language and formatting clean-ups<br />

                  Rewrote semun text<br />
                  Added semid_ds and ipc_perm structure definitions<br />

                  2005-08-02, mtk: Added IPC_INFO, SEM_INFO, SEM_STAT descriptions.<br />

                  2018-03-20, dbueso: Added SEM_STAT_ANY description.<br />
                  
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
