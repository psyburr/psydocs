<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <title>readdir(3) — Linux manual pages</title>
  <link rel="stylesheet" type="text/css" href="../stylesheet/manpages.css" />
  
  <link rel="home" href="../index.html" title="readdir(3) — Linux manual pages" />
  <script type="text/javascript" src="../stylesheet/manpages.js" xml:space="preserve"> </script>
  <link rel="icon" href="../stylesheet/icon.gif" type="image/gif" />
</head>
<body onload="javascript:init()">
  <div class="navheader">
    <table width="100%">
      <tbody>
        <tr>
          <td style="width: 33%" rowspan="1" colspan="1"><a href="../index.html" shape="rect">Linux
          manual pages</a></td>
          <th rowspan="1" colspan="1"><a href="../index3.html" shape="rect">Section 3</a></th>
          <td style="width: 33%" rowspan="1" colspan="1"> </td>
        </tr>
      </tbody>
    </table>
    <hr />
  </div>
  <div class="refentry">
    <a id="readdir.3" name="readdir.3" shape="rect"> </a>
    <div class="titlepage"> </div>
    <div class="refnamediv">
      <h2>Name</h2>
      <p>readdir — read a directory</p>
    </div>
    <div class="refsynopsisdiv">
      <h2>Synopsis</h2>
      <div class="funcsynopsis">
        <pre class="funcsynopsisinfo" xml:space="preserve">#include &lt;dirent.h&gt;</pre>
        <table border="0" class="funcprototype-table" summary="Function synopsis" style="cellspacing: 0; cellpadding: 0;">
          <tr>
            <td rowspan="1" colspan="1"><code class="funcdef">struct dirent
            *<strong>readdir</strong>(</code></td>
            <td rowspan="1" colspan="1">DIR *<var class="pdparam">dirp</var><code>)</code>;</td>
          </tr>
        </table>
        <div class="funcprototype-spacer">
           
        </div>
      </div>
    </div>
    <div class="refsect1">
      <a id="readdir-3_sect1" name="readdir-3_sect1" shape="rect"> </a>
      <h2>DESCRIPTION</h2>
      <p>The <code class="function">readdir</code>() function
      returns a pointer to a <span class="structname">dirent</span>
      structure representing the next directory entry in the
      directory stream pointed to by <em class="parameter"><code>dirp</code></em>. It returns NULL on
      reaching the end of the directory stream or if an error
      occurred.</p>
      <p>In the glibc implementation, the <span class="structname">dirent</span> structure is defined as
      follows:</p>
      <div class="blockquote">
        <blockquote class="blockquote">
          <div class="structdef">
            <table class="structdef" style="border-collapse: collapse;">
              <colgroup span="1">
                <col class="c1" span="1" />
                <col class="c2" span="1" />
                <col class="c3" span="1" />
                <col class="c4" span="1" />
                <col class="c5" span="1" />
              </colgroup>
              <tbody>
                <tr>
                  <td class="structdefhdr" style="" align="left" rowspan="1" colspan="1">
                  struct</td>
                  <td class="structdefhdr" style="" colspan="4" align="left" rowspan="1"><span class="structname">dirent</span> {</td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">ino_t</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>d_ino</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      /* Inode number */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">off_t</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>d_off</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* Not an offset; see below */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">unsigned short</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>d_reclen</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* Length of this record */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">unsigned char</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>d_type</code></em>;</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* Type of file; not supported<br />

                      by all filesystem types */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td style="" rowspan="1" colspan="1"> </td>
                  <td style="" align="left" rowspan="1" colspan="1"><span class="type">char</span></td>
                  <td class="norightpad" style="" align="right" rowspan="1" colspan="1">
                   </td>
                  <td style="" align="left" rowspan="1" colspan="1"><em class="structfield"><code>d_name</code></em>[256];</td>
                  <td style="" align="left" rowspan="1" colspan="1">
                    <div class="literallayout">
                      
                      /* Null\-terminated filename */
                    </div>
                  </td>
                </tr>
                <tr>
                  <td class="structdefftr" style="" colspan="5" align="left" rowspan="1">};</td>
                </tr>
              </tbody>
            </table>
          </div>
        </blockquote>
      </div>
      <p>The only fields in the <span class="structname">dirent</span> structure that are mandated by
      POSIX.1 are <em class="parameter"><code>d_name</code></em>
      and <em class="parameter"><code>d_ino</code></em>. The other
      fields are unstandardized, and not present on all systems;
      see NOTES below for some further details.</p>
      <p>The fields of the <span class="structname">dirent</span>
      structure are as follows:</p>
      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><em class="parameter"><code>d_ino</code></em></span></dt>
          <dd>
            <p>This is the inode number of the file.</p>
          </dd>
          <dt><span class="term"><em class="parameter"><code>d_off</code></em></span></dt>
          <dd>
            <p>The value returned in <em class="parameter"><code>d_off</code></em> is the same as
            would be returned by calling <a class="link" href="../htmlman3/telldir.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">telldir</span>(3)</span></a> at the
            current position in the directory stream. Be aware that
            despite its type and name, the <em class="parameter"><code>d_off</code></em> field is seldom any
            kind of directory offset on modern filesystems.
            Applications should treat this field as an opaque
            value, making no assumptions about its contents; see
            also <a class="link" href="../htmlman3/telldir.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">telldir</span>(3)</span></a>.</p>
          </dd>
          <dt><span class="term"><em class="parameter"><code>d_reclen</code></em></span></dt>
          <dd>
            <p>This is the size (in bytes) of the returned record.
            This may not match the size of the structure definition
            shown above; see NOTES.</p>
          </dd>
          <dt><span class="term"><em class="parameter"><code>d_type</code></em></span></dt>
          <dd>
            <p>This field contains a value indicating the file
            type, making it possible to avoid the expense of
            calling <a class="link" href="../htmlman2/stat.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">lstat</span>(2)</span></a> if further
            actions depend on the type of the file.</p>
            <p>When a suitable feature test macro is defined
            (<code class="constant">_DEFAULT_SOURCE</code> on glibc
            versions since 2.19, or <code class="constant">_BSD_SOURCE</code> on glibc versions 2.19
            and earlier), glibc defines the following macro
            constants for the value returned in <em class="parameter"><code>d_type</code></em>:</p>
            <div class="blockquote">
              <blockquote class="blockquote">
                <div class="variablelist">
                  <dl class="variablelist">
                    <dt><span class="term"><code class="constant">DT_BLK</code></span></dt>
                    <dd>
                      <p>This is a block device.</p>
                    </dd>
                    <dt><span class="term"><code class="constant">DT_CHR</code></span></dt>
                    <dd>
                      <p>This is a character device.</p>
                    </dd>
                    <dt><span class="term"><code class="constant">DT_DIR</code></span></dt>
                    <dd>
                      <p>This is a directory.</p>
                    </dd>
                    <dt><span class="term"><code class="constant">DT_FIFO</code></span></dt>
                    <dd>
                      <p>This is a named pipe (FIFO).</p>
                    </dd>
                    <dt><span class="term"><code class="constant">DT_LNK</code></span></dt>
                    <dd>
                      <p>This is a symbolic link.</p>
                    </dd>
                    <dt><span class="term"><code class="constant">DT_REG</code></span></dt>
                    <dd>
                      <p>This is a regular file.</p>
                    </dd>
                    <dt><span class="term"><code class="constant">DT_SOCK</code></span></dt>
                    <dd>
                      <p>This is a UNIX domain socket.</p>
                    </dd>
                    <dt><span class="term"><code class="constant">DT_UNKNOWN</code></span></dt>
                    <dd>
                      <p>The file type could not be determined.</p>
                    </dd>
                  </dl>
                </div>
              </blockquote>
            </div>
            <p>Currently, only some filesystems (among them: Btrfs,
            ext2, ext3, and ext4) have full support for returning
            the file type in <em class="parameter"><code>d_type</code></em>. All applications
            must properly handle a return of <code class="constant">DT_UNKNOWN</code>.</p>
          </dd>
          <dt><span class="term"><em class="parameter"><code>d_name</code></em></span></dt>
          <dd>
            <p>This field contains the null terminated filename.
            <span class="emphasis"><em>See NOTES</em></span>.</p>
          </dd>
        </dl>
      </div>
      <p>The data returned by <code class="function">readdir</code>() may be overwritten by subsequent
      calls to <code class="function">readdir</code>() for the same
      directory stream.</p>
    </div>
    <div class="refsect1">
      <a id="readdir-3_sect2" name="readdir-3_sect2" shape="rect"> </a>
      <h2>RETURN VALUE</h2>
      <p>On success, <code class="function">readdir</code>()
      returns a pointer to a <span class="structname">dirent</span>
      structure. (This structure may be statically allocated; do
      not attempt to <a class="link" href="../htmlman3/malloc.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">free</span>(3)</span></a> it.)</p>
      <p>If the end of the directory stream is reached, NULL is
      returned and <code class="varname">errno</code> is not
      changed. If an error occurs, NULL is returned and
      <code class="varname">errno</code> is set to indicate the
      error. To distinguish end of stream from an error, set
      <code class="varname">errno</code> to zero before calling
      <code class="function">readdir</code>() and then check the
      value of <code class="varname">errno</code> if NULL is
      returned.</p>
    </div>
    <div class="refsect1">
      <a id="readdir-3_sect3" name="readdir-3_sect3" shape="rect"> </a>
      <h2>ERRORS</h2>
      <div class="variablelist">
        <dl class="variablelist">
          <dt><span class="term"><span class="errorname">EBADF</span></span></dt>
          <dd>
            <p>Invalid directory stream descriptor <em class="parameter"><code>dirp</code></em>.</p>
          </dd>
        </dl>
      </div>
    </div>
    <div class="refsect1">
      <a id="readdir-3_sect4" name="readdir-3_sect4" shape="rect"> </a>
      <h2>ATTRIBUTES</h2>
      <p>For an explanation of the terms used in this section, see
      <a class="link" href="../htmlman7/attributes.7.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">attributes</span>(7)</span></a>.</p>
      <div class="informaltable">
        <table class="informaltable" style="border-collapse: collapse;">
          <colgroup span="1">
            <col class="c0" span="1" />
            <col class="c1" span="1" />
            <col class="c2" span="1" />
          </colgroup>
          <tbody>
            <tr>
              <td style="" align="left" rowspan="1" colspan="1">Interface</td>
              <td style="" align="left" rowspan="1" colspan="1">Attribute</td>
              <td style="" align="left" rowspan="1" colspan="1">Value</td>
            </tr>
            <tr>
              <td style="" align="left" rowspan="1" colspan="1"><code class="literal">readdir</code>()</td>
              <td style="" align="left" rowspan="1" colspan="1">Thread safety</td>
              <td style="" align="left" rowspan="1" colspan="1">MT-Unsafe
              race:dirstream</td>
            </tr>
          </tbody>
        </table>
      </div>
      <p>In the current POSIX.1 specification (POSIX.1-2008),
      <code class="function">readdir</code>() is not required to be
      thread-safe. However, in modern implementations (including
      the glibc implementation), concurrent calls to <code class="function">readdir</code>() that specify different directory
      streams are thread-safe. In cases where multiple threads must
      read from the same directory stream, using <code class="function">readdir</code>() with external synchronization is
      still preferable to the use of the deprecated <a class="link" href="../htmlman3/readdir_r.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">readdir_r</span>(3)</span></a> function. It
      is expected that a future version of POSIX.1 will require
      that <code class="function">readdir</code>() be thread-safe
      when concurrently employed on different directory
      streams.</p>
    </div>
    <div class="refsect1">
      <a id="readdir-3_sect5" name="readdir-3_sect5" shape="rect"> </a>
      <h2>CONFORMING TO</h2>
      <p>POSIX.1-2001, POSIX.1-2008, SVr4, 4.3BSD.</p>
    </div>
    <div class="refsect1">
      <a id="readdir-3_sect6" name="readdir-3_sect6" shape="rect"> </a>
      <h2>NOTES</h2>
      <p>A directory stream is opened using <a class="link" href="../htmlman3/opendir.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">opendir</span>(3)</span></a>.</p>
      <p>The order in which filenames are read by successive calls
      to <code class="function">readdir</code>() depends on the
      filesystem implementation; it is unlikely that the names will
      be sorted in any fashion.</p>
      <p>Only the fields <em class="parameter"><code>d_name</code></em> and (as an XSI
      extension) <em class="parameter"><code>d_ino</code></em> are
      specified in POSIX.1. Other than Linux, the <em class="parameter"><code>d_type</code></em> field is available
      mainly only on BSD systems. The remaining fields are
      available on many, but not all systems. Under glibc, programs
      can check for the availability of the fields not defined in
      POSIX.1 by testing whether the macros <code class="constant">_DIRENT_HAVE_D_NAMLEN</code>, <code class="constant">_DIRENT_HAVE_D_RECLEN</code>, <code class="constant">_DIRENT_HAVE_D_OFF</code>, or <code class="constant">_DIRENT_HAVE_D_TYPE</code> are defined.</p>
      <div class="refsect2">
        <a id="readdir-3_sect7" name="readdir-3_sect7" shape="rect"> </a>
        <h3>The d_name field</h3>
        <p>The <span class="structname">dirent</span> structure
        definition shown above is taken from the glibc headers, and
        shows the <em class="parameter"><code>d_name</code></em>
        field with a fixed size.</p>
        <div class="warning" style="margin-left: 0.5in; margin-right: 0.5in;">
          <table border="0" summary="Warning">
            <tr>
              <td rowspan="2" align="center" valign="top" width="25" colspan="1"><img alt="[Warning]" src="../stylesheet/warning.png" /></td>
              <th align="left" rowspan="1" colspan="1">Warning</th>
            </tr>
            <tr>
              <td align="left" valign="top" rowspan="1" colspan="1">
                <p>applications should avoid any dependence on the
                size of the <em class="parameter"><code>d_name</code></em> field. POSIX
                defines it as <span class="emphasis"><em>char
                d_name[]</em></span>, a character array of
                unspecified size, with at most <code class="constant">NAME_MAX</code> characters preceding the
                terminating null byte ('\0').</p>
              </td>
            </tr>
          </table>
        </div>
        <p>POSIX.1 explicitly notes that this field should not be
        used as an lvalue. The standard also notes that the use of
        <em class="replaceable"><code>sizeof(d_name)</code></em> is
        incorrect; use <em class="replaceable"><code>strlen(d_name)</code></em> instead. (On
        some systems, this field is defined as <span class="emphasis"><em>char d_name[1]</em></span>!) By implication,
        the use <span class="emphasis"><em>sizeof(struct
        dirent)</em></span> to capture the size of the record
        including the size of <em class="parameter"><code>d_name</code></em> is also incorrect.</p>
        <p>Note that while the call</p>
        <p>fpathconf(fd, _PC_NAME_MAX)</p>
        <p>returns the value 255 for most filesystems, on some
        filesystems (e.g., CIFS, Windows SMB servers), the
        null-terminated filename that is (correctly) returned in
        <em class="parameter"><code>d_name</code></em> can actually
        exceed this size. In such cases, the <em class="parameter"><code>d_reclen</code></em> field will contain a
        value that exceeds the size of the glibc <span class="structname">dirent</span> structure shown above.</p>
      </div>
    </div>
    <div class="refsect1">
      <a id="readdir-3_sect8" name="readdir-3_sect8" shape="rect"> </a>
      <h2>SEE ALSO</h2>
      <p><a class="link" href="../htmlman2/getdents.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">getdents</span>(2)</span></a>, <a class="link" href="../htmlman2/read.2.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">read</span>(2)</span></a>, <a class="link" href="../htmlman3/closedir.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">closedir</span>(3)</span></a>, <a class="link" href="../htmlman3/dirfd.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">dirfd</span>(3)</span></a>, <a class="link" href="../htmlman3/ftw.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">ftw</span>(3)</span></a>, <a class="link" href="../htmlman3/offsetof.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">offsetof</span>(3)</span></a>, <a class="link" href="../htmlman3/opendir.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">opendir</span>(3)</span></a>, <a class="link" href="../htmlman3/readdir_r.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">readdir_r</span>(3)</span></a>, <a class="link" href="../htmlman3/rewinddir.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">rewinddir</span>(3)</span></a>, <a class="link" href="../htmlman3/scandir.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">scandir</span>(3)</span></a>, <a class="link" href="../htmlman3/seekdir.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">seekdir</span>(3)</span></a>, <a class="link" href="../htmlman3/telldir.3.html" target="_top" shape="rect"><span class="citerefentry"><span class="refentrytitle">telldir</span>(3)</span></a></p>
    </div>
    <div class="colophon">
      <a id="readdir-3_sect9" name="readdir-3_sect9" shape="rect"> </a>
      <h2>COLOPHON</h2>
      <p>This page is part of release 5.11 of the Linux <em class="replaceable"><code>man-pages</code></em> project. A
      description of the project, information about reporting bugs,
      and the latest version of this page, can be found at
      https://www.kernel.org/doc/man−pages/.</p>
      <div class="license">
        <table class="license" style="border-collapse: collapse;">
          <colgroup span="1">
            <col span="1" />
          </colgroup>
          <tbody>
            <tr>
              <td style="" rowspan="1" colspan="1">
                <div class="literallayout">
                  <br />
                    Copyright (C) 1993 David Metcalfe (david<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>prism.demon.co.uk)<br />

                  and Copyright (C) 2008, 2016 Michael Kerrisk &lt;mtk.manpages<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>gmail.com&gt;<br />

                  <br />
                  %%%LICENSE_START(VERBATIM)<br />
                  Permission is granted to make and distribute verbatim copies of this<br />

                  manual provided the copyright notice and this permission notice are<br />

                  preserved on all copies.<br />
                  <br />
                  Permission is granted to copy and distribute modified versions of this<br />

                  manual under the conditions for verbatim copying, provided that the<br />

                  entire resulting derived work is distributed under the terms of a<br />

                  permission notice identical to this one.<br />

                  <br />
                  Since the Linux kernel and libraries are constantly changing, this<br />

                  manual page may be incorrect or out-of-date.  The author(s) assume no<br />

                  responsibility for errors or omissions, or for damages resulting from<br />

                  the use of the information contained herein.  The author(s) may not<br />

                  have taken the same level of care in the production of this manual,<br />

                  which is licensed free of charge, as they might when working<br />

                  professionally.<br />
                  <br />
                  Formatted or processed versions of this manual, if unaccompanied by<br />

                  the source, must acknowledge the copyright and authors of this work.<br />

                  %%%LICENSE_END<br />
                  <br />
                  References consulted:<br />
                      Linux libc source code<br />

                      Lewine's _POSIX Programmer's Guide_ (O'Reilly &amp; Associates, 1991)<br />

                      386BSD man pages<br />

                  Modified Sat Jul 24 16:09:49 1993 by Rik Faith (faith<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cs.unc.edu)<br />

                  Modified 11 June 1995 by Andries Brouwer (aeb<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cwi.nl)<br />

                  Modified 22 July 1996 by Andries Brouwer (aeb<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>cwi.nl)<br />

                  2007-07-30 Ulrich Drepper &lt;drepper<script type="text/javascript">document.write('@');</script><noscript>(@)</noscript>redhat.com&gt;, mtk:<br />

                      Rework discussion of nonstandard structure fields.<br />
                  
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</body>
</html>
